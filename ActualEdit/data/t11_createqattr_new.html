function setListId(a){PDF_close(a)}function setFloat(a){a.className="spanLeft"}function getEditorIndex(){return EditorIndex++}function GetItemTitleWidth(a){var k,m,o,b=a._type,c=a._tag||0,d="check"==b,h="matrix"==b,i=d&&c;return a._isTouPiao,k=a._isCeShi,a._isShop,m=a._isCePing,!(a._tag||m||"check"!=a._type&&"radio"!=a._type&&"radio_down"!=a._type),o=340,k?o=410:"check"==b?o=298:"radio"==b&&m&&(o=280),i&&(o=430),h&&(o=170,("103"==c||"102"==c)&&(o=250)),o}function getVerifyHtml(a){var d,e,f,g,h,b="<select onchange='cur.setVerify(this);'>",c=["0,属性验证",",不验证","数字,整数","小数","日期","手机","指定选项","固话","电话,手机或固话","Email,邮件","密码","城市单选,省份城市","省市区","高校","地图","网址","身份证号","学号","QQ","汉字","姓名,中文姓名","英文"];for(d=0;d<c.length;d++)e=c[d],f=e.split(","),g=f[0],h=2==f.length?f[1]:f[0],("指定选项"!=e||0!=a)&&(b+="<option value='"+g+"'>"+h+"</option>");return b+="</select>"}function checkVerifyMinMax(a,b,c){var d=a.value,e=b.value;return d&&!isInt(d)?"您输入的数据不正确":e&&!isInt(d)?"您输入的数据不正确":d&&e&&d-e>0?"您输入的数据不正确":"数字"==c||"小数"==c?"":d&&d-3e3>0?"字数不能超过3000":e&&e-3e3>0?"字数不能超过3000":""}function changeHeight(a){var c,d,e,b=parseInt(a.style.height);b&&(a.value.length<70||(a.initHeight||(a.initHeight=b),c=18,d=100,e=a.scrollHeight,e=e>c?e:c,e=e>d?d:e,e-b>=10&&(a.style.height=e+"px"),(!a.value||a.value.length<5)&&(a.style.height=a.initHeight+"px")))}function createAttr(){function Ub(a){var c,b=a.dataNode;"page"==b._type&&(c=parseInt(b._topic),c>=Pb&&Qb>=c&&(b._mintime=cur.dataNode._mintime,b._maxtime=cur.dataNode._maxtime,a.setMinMaxTime&&a.setMinMaxTime()))}function Ke(){return cur.displayGroup(),!1}function Lf(){return cur.displayJump(),!1}var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb,mb,nb,ob,pb,qb,rb,sb,tb,ub,vb,wb,xb,yb,zb,Ab,Bb,Cb,Db,Eb,Fb,Gb,Hb,Ib,Jb,Kb,Lb,Mb,Nb,Ob,Pb,Qb,Rb,Sb,Tb,Vb,Wb,Xb,Yb,Zb,$b,_b,ac,bc,cc,dc,ec,fc,gc,hc,ic,jc,kc,lc,mc,nc,oc,qc,rc,sc,tc,uc,vc,wc,xc,yc,zc,Ac,Bc,Cc,Dc,Ec,Fc,Gc,Hc,Ic,Jc,Kc,Lc,Mc,Oc,Pc,Qc,Rc,Sc,Tc,Uc,Vc,Wc,Xc,Yc,Zc,$c,_c,bd,cd,dd,ed,fd,gd,hd,id,jd,kd,ld,md,nd,od,pd,rd,sd,td,ud,vd,wd,xd,yd,zd,Ad,Bd,Cd,Dd,Ed,Fd,Gd,Hd,Id,Jd,Kd,Ld,Md,Nd,Od,Pd,Qd,Rd,Sd,Td,Ud,Vd,Wd,Xd,Yd,Zd,$d,_d,ae,be,de,ee,fe,ge,he,ie,je,ke,le,me,ne,oe,pe,qe,re,se,te,ue,ve,we,xe,ye,ze,Ae,Be,Ce,De,Ee,Fe,Ge,He,Ie,Je,Le,Me,Ne,Oe,Pe,Qe,Re,Se,Te,Ue,Ve,We,Xe,Ye,Ze,$e,_e,af,bf,cf,df,ef,ff,gf,hf,jf,kf,lf,mf,nf,of,pf,qf,rf,sf,tf,uf,vf,wf,xf,yf,zf,Af,Cf,Df,Ef,Ff,Gf,Hf,If,Jf,Kf,Mf,Nf,Of,Pf,Qf,Rf,Sf,Tf,Uf,Vf,Wf,Xf,Yf;if((new Date).getTime(),c=document.createElement("div"),this.appendChild(c),d=document.createDocumentFragment(),this.tabAttr=c,e=this,f=this.dataNode,g=f._type,h=this.dataNode._tag||0,i="question"==g,j="slider"==g,k="sum"==g,l="page"==g,m="cut"==g,n="check"==g,o="radio"==g,p=o&&h,q="radio_down"==g,r="matrix"==g,s="matrix"==g&&h>300,t="fileupload"==g,u="gapfill"==g,v=n&&h,w=o||q||n||r,x=!m&&!l,y=f._verify||"0",z="0"!=y,A=f._isTouPiao,B=f._isCeShi,C=f._isQingJing,D=B&&f._ispanduan,E=f._isShop,F=f._isCePing,G=r&&102>h,H="302"==h&&f._minvalue&&0!=f._minvalue?!0:!1,I=this.get_div_title(),K=new Array,this.option_radio=K,L=document.createElement("div"),M=getIEVersion(),M&&"7"==M&&(L.style.overflow="hidden"),this.attrMain=L,L.className="div_title_attr_question",N=$ce("div","",L),N.className="div_title_attr_question_triangle",window.EditQWithoutPreview&&(N.style.display="none",L.style.marginTop="0",L.style.paddingTop="26px"),this.addCeShiDesc=function(a){var c,b=control_text("14");a.appendChild(b),b.value=f._ceshiDesc||"",b.onchange=b.onblur=function(){e.dataNode._ceshiDesc=this.value},b.onchange(),b.style.display="none",$ce("span","&nbsp;&nbsp;&nbsp;&nbsp;",a),c=$ce("a","设置答案解析",a),c.style.display="inline-block",c.onmouseover=function(){toolTipLayer.style.width="250px",toolTipLayer.innerHTML="您可以填写针对此题答案的一些解析说明，在用户参与完测试后会看到此解析";var a=this;this.hasOut=!1,setTimeout(function(){a.hasOut||sb_setmenunav(toolTipLayer,!0,a)},200)},c.onmouseout=function(){this.hasOut=!0,sb_setmenunav(toolTipLayer,!1,this)},c.href="javascript:",c.className="link-U666",c.onclick=function(){return openTitleEditor(b,function(a){"-1nc"!=a&&void 0!=a&&(b.value=trim(a),b.onchange())}),!1}},B&&!u&&(this.addCeShiSetting=function(a){var c,d,g,h,j,k,l,m,n,o,b=$ce("div","",a);for(b.style.marginTop="15px","question"==e.dataNode._type&&(b.style.marginBottom="10px"),c=$ce("span","<b>题目分数：</b>",b),d="<select onchange='cur.setTValue(this.value);'>",g="fileupload"==e.dataNode._type||"简答题无答案"==e.dataNode._answer,g||(d+="<option value='0.5'>0.5</option>"),h=1;50>=h;h++)d+="<option value='"+h+"'>"+h+"</option>",1!=h||g?2!=h||g||(d+="<option value='2.5'>2.5</option>"):d+="<option value='1.5'>1.5</option>";d+="</select>&nbsp;",c.innerHTML+=d,this.setTValue=function(a){e.dataNode._ceshiValue=a,j.style.display="",i?e.setCeshiQTip():e.spanCeShi.innerHTML="（分值："+e.dataNode._ceshiValue+"分）",Calculatedscore()},this.initValue=function(){if(this.dataNode._ceshiValue){var a=$$("select",c)[0];a.value=this.dataNode._ceshiValue}},b.appendChild(c),j=$ce("span","<a onclick='cur.copyScore(this);return false;' class='link-U00a6e6' href='javascript:'>复制分数</a>",b),j.onmouseover=function(){toolTipLayerMenu.style.width="206px",toolTipLayerMenu.innerHTML="复制此题分数到后面的题目";var a=this;this.hasOut=!1,setTimeout(function(){a.hasOut||sb_setmenunav(toolTipLayerMenu,!0,a)},200)},j.onmouseout=function(){this.hasOut=!0,sb_setmenunav(toolTipLayerMenu,!1,this)},this.copyScore=function(){PDF_launch("/wjx/design/applyscore.aspx?ct="+e.dataNode._topic,500,240)},i&&(k=$ce("span","&nbsp;&nbsp;&nbsp;&nbsp;答案：",b),l=control_text("14"),k.appendChild(l),m=$ce("a","+",k),m.href="javascript:",m.style.fontSize="24px",m.className="link-666",m.style.display="inline-block",l.value=f._answer,l.onfocus=function(){"请设置答案"==this.value&&(this.value="")},m.onclick=function(){return l.value&&"请设置答案"!=l.value?(l.value=l.value+"|",l.focus(),l.onchange(),void 0):(show_status_tip("请先设置一个答案！",4e3),void 0)},l.onchange=l.onblur=function(){""==this.value&&(this.value="请设置答案");var a=trim(this.value);/^[A-Za-z\s]+$/.test(a)&&(a=a.replace(/\s+/g," ")),this.value=a,e.dataNode._answer=a,e.setCeshiQTip()},m.onmouseover=function(){toolTipLayer.style.width="200px",toolTipLayer.innerHTML="提示：如果此题有多个答案，请以“<span style='color:red;'>|</span>”符号进行分隔。",sb_setmenunav(toolTipLayer,!0,this)},m.onmouseout=function(){sb_setmenunav(toolTipLayer,!1,this)},l.onchange(),n=control_check(),n.id="inc_"+e.dataNode.topic+"_"+RndNum(10),n.className="checkbox",o=$ce("span","&nbsp;&nbsp;&nbsp;&nbsp;",k),o.style.display="inline-block",o.appendChild(n),$ce("label","包含答案即可得分",o).setAttribute("for",n.id),o.onmouseover=function(){toolTipLayer.style.width="270px",toolTipLayer.innerHTML="用户提交的答案不需要跟设置的答案完全一样，只要包含设置的答案就可得分。",sb_setmenunav(toolTipLayer,!0,this)},o.onmouseout=function(){sb_setmenunav(toolTipLayer,!1,this)},n.onclick=function(){return vipUser?(e.dataNode._include=this.checked,void 0):(alertNew("提示：此功能只对企业版用户开放，请<a href='/register/upgradevip.aspx?upgradeReason=46' target='_blank'>升级</a>"),this.checked=!1,void 0)},n.checked=f._include,"简答题无答案"==l.value&&(k.style.display="none")),this.initValue(),this.addCeShiDesc(b)}),O=document.createElement("div"),P="标题"==f._title||"请在此输入问题标题"==f._title||"请根据您的实际情况选择最符合的项：1-->5表示非常不满意-->非常满意"==f._title||"请选择您认为正确的答案？"==f._title,Q=$ce("div","",O),C&&(Q.style.display="none"),R=f._title.indexOf("<")>-1,S=$ce("div","",O),S.style.position="relative",S.className="container",T=control_textarea("4","29"),this.txttitle=T,T.tabIndex=1,P&&(T.defValue=f._title),x&&(T.title="例如：您最喜欢的车型？"),l&&(T.title="您可以在此输入本页的页面标题信息（选填）"),m&&(T.title="请在此输入内容"),l&&!f._title&&(S.style.display="none"),U=$ce("span","",S),(x&&f._topic-1>0||m)&&(V="&nbsp;<a href='javascript:' onclick='openReferWindow(cur,this);return false;' onmouseout='sb_setmenunav(toolTipLayer,false);' class='link-U666' style='display:inline-block;' title='引用前面题目的答案'>引用</a>",U.innerHTML=V,U.style.position="absolute",U.style.right="88px",U.style.top="3px",U.style.display="none"),W=$ce("span","",S),W.style.position="absolute",W.style.left="46px",W.style.top="36px",W.style.color="#777",X=$ce("span","",S),X.style.position="absolute",X.style.right="58px",X.style.top="7px",X.className="fullScreen",X.onclick=function(){return openTitleEditor(T,function(a){if("-1nc"==a||void 0==a)return!1;var b=trim(a);T.value=b,KE.util.setFullHtml(T.id,b),T.onchange()}),!1},Y=$ce("a","高级编辑",S),Y.href="javascript:;",Y.title="",Y.onmouseover=function(){toolTipLayerMenu.style.width="200px",toolTipLayerMenu.innerHTML="提示：高级编辑可以设置字体、颜色，插入图片、音频、视频等",sb_setmenunav(toolTipLayerMenu,!0,this)},Y.onmouseout=function(){sb_setmenunav(toolTipLayerMenu,!1,this)},Y.style.position="absolute",Y.style.right="32px",Y.style.top="18px",Y.style.display="none",Y.className="link-set",Y.onclick=function(){return e.createEditBox(),!1},Z="tc"+f._type+getEditorIndex(),T.value=f._title,P&&(T.value=""),T.id=Z,T.style.overflow="auto",T.style.padding="5px 0 0 5px",T.style.border="1px solid #dddddd",T.style.width="99%",T.style.margin="36px 0 0 0",S.appendChild(T),x?R?T.style.height="82px":(T.style.height="33px",u&&(T.style.height="60px")):T.style.height="130px",T.onkeyup=T.onchange=function(){e.checkTitle()},T.onfocus=function(){("标题"==this.value||"请在此输入问题标题"==this.value||"请根据您的实际情况选择最符合的项：1-->5表示非常不满意-->非常满意"==this.value)&&(this.value=""),Y.style.display=""},T.onblur=function(){this.value||"page"==e.dataNode._type||(this.value=this.defValue||"",e.checkTitle()),changeHeight(this)},T.oninput=T.onpropertychange=function(){changeHeight(this)},e.gettextarea=function(){return T},$="",A?o?$="<option value='radio'>列表单选</option><option value='toupiaocheck'>投票多选</option>":n&&($=!isMergeAnswer||this.isMergeNewAdded?"<option value='toupiaoradio'>投票单选</option><option value='check'>多选</option>":"<option value='check'>多选</option>"):u?B?(f._isCloze?$="<option value='ceshigap'>考试多项填空</option>":$+="<option value='clozegap'>考试完型填空</option>",$+="<option value='gapfill'>普通多项填空</option>"):($="<option value='ceshigap'>考试多项填空</option>",$+="<option value='clozegap'>考试完型填空</option>"):B?o&&!D?$=!isMergeAnswer||this.isMergeNewAdded?"<option value='ceshicheck'>考试多选</option><option value='ceshiq3'>考试填空</option><option value='ceshiq1'>考试简答</option><option value='radio'>普通单选</option>":"<option value='ceshicheck'>考试多选</option><option value='radio'>普通单选</option>":n?$=!isMergeAnswer||this.isMergeNewAdded?"<option value='ceshiradio'>考试单选</option><option value='ceshiq3'>考试填空</option><option value='ceshiq1'>考试简答</option><option value='check'>普通多选</option>":"<option value='check'>普通多选</option>":i&&($="简答题无答案"!=f._answer?!isMergeAnswer||this.isMergeNewAdded?"<option value='ceshiq1'>考试简答</option><option value='ceshiradio'>考试单选</option><option value='ceshicheck'>考试多选</option><option value='question'>普通填空</option>":"<option value='ceshiq1'>考试简答</option><option value='question'>普通填空</option>":!isMergeAnswer||this.isMergeNewAdded?"<option value='ceshiq3'>考试填空</option><option value='ceshiradio'>考试单选</option><option value='ceshicheck'>考试多选</option><option value='question'>普通填空</option>":"<option value='ceshiq3'>考试填空</option><option value='question'>普通填空</option>"):F?o?$="<option value='radio'>列表单选</option><option value='cepingcheck'>评分多选</option>":n&&($=!isMergeAnswer||this.isMergeNewAdded?"<option value='cepingradio'>评分单选</option><option value='check'>列表多选</option>":"<option value='check'>列表多选</option>"):!isMergeAnswer||this.isMergeNewAdded?i?"多级下拉"!=e.dataNode._verify&&($="<option value='radio'>列表单选</option><option value='radio_down'>下拉框单选</option><option value='check'>多选</option><option value='likert'>量表题</option><option value='order'>排序</option><option value='ceshiq'>考试填空</option>"):r?s?(303!=h&&($+="<option value='matrix,303'>表格下拉框</option>"),301!=h&&($+="<option value='matrix,301'>表格数值题</option>"),302!=h&&($+="<option value='matrix,302'>表格文本框</option>")):101>=h?($+="<option value='matrix,103'>矩阵单选</option>",$+="<option value='matrix,102'>矩阵多选</option>",$+="<option value='matrix,201'>矩阵填空</option>",$+="<option value='matrix,202'>矩阵滑动条</option>"):($+="<option value='matrix,101'>矩阵量表</option>",103!=h&&($+="<option value='matrix,103'>矩阵单选</option>"),102!=h&&($+="<option value='matrix,102'>矩阵多选</option>"),201!=h&&($+="<option value='matrix,201'>矩阵填空</option>"),202!=h&&($+="<option value='matrix,202'>矩阵滑动条</option>")):w&&((!o||p)&&($+="<option value='radio'>列表单选</option>"),q||($+="<option value='radio_down'>下拉框单选</option>"),(!n||v)&&($+="<option value='check'>多选</option>"),p||($+="<option value='likert'>量表题</option>"),v||($+="<option value='order'>排序</option>"),o?($+="<option value='toupiaoradio'>投票单选</option>",$+="<option value='ceshiradio'>考试单选</option>",$+="<option value='cepingradio'>评分单选</option>"):n&&!v&&($+="<option value='toupiaocheck'>投票多选</option>",$+="<option value='ceshicheck'>考试多选</option>"),$+="<option value='question'>填空</option>"):(o||q)&&0==h?($="",o?$="<option value='radio_down'>下拉框单选</option>":q&&($="<option value='radio'>列表单选</option>"),$+="<option value='likert'>量表题</option><option value='check'>多选</option><option value='toupiaoradio'>投票单选</option><option value='cepingradio'>评分单选</option><option value='ceshiradio'>考试单选</option>"):n&&!v?($="<option value='toupiaocheck'>投票多选</option>",$+="<option value='ceshicheck'>考试多选</option>"):!r||103!=h&&101!=h||(101!=h&&($+="<option value='matrix,101'>矩阵量表</option>"),103!=h&&($+="<option value='matrix,103'>矩阵单选</option>")),_="",x&&(this.getQType=function(){var a=e.dataNode._type;if("question"==a)return e.dataNode._isCeShi?"简答题无答案"==e.dataNode._answer?"考试简答":"考试填空":"多级下拉"==e.dataNode._verify?"多级下拉":"填空";if("gapfill"==a)return e.dataNode._isCloze?"考试完型填空":e.dataNode._isCeShi?"考试多项填空":"普通多项填空";if("slider"==a)return"滑动条";if("radio"==a)return e.dataNode._isTouPiao?"投票单选":e.dataNode._isCeShi?D?"考试判断":"考试单选":e.dataNode._isCePing?"评分单选":h?"量表题":e.dataNode._isQingJing?"情景随机":"单选";if("radio_down"==a)return"下拉框单选";if("check"==a)return e.dataNode._isTouPiao?"投票多选":e.dataNode._isCeShi?"考试多选":e.dataNode._isCePing?"评分多选":h?"排序":"多选";if("fileupload"==a)return"上传文件";if("matrix"==a){if(201==h)return"矩阵填空";if(202==h)return"矩阵滑动条";if(301==h)return"表格数值题";if(302==h)return"表格文本题";if(303==h)return"表格下拉框";if(G)return"矩阵量表";if(103==h)return"矩阵单选";if(102==h)return"矩阵多选"}else if("sum"==a)return"比重题";return""},_=this.getQType()),$&&($="<select style='width:120px;' onchange='javascript:cur.selChangeType(this.value);'><option value='0'>"+_+"</option>"+$+"</select>"),(x||m)&&(ab=$ce("div","",O),ab.style.marginTop="10px",ab.className="container",u&&(bb=$ce("div","",ab),bb.style.marginBottom="15px",cb=document.createElement("a"),cb.innerHTML="插入填空符",cb.className="sumitbutton",cb.href="javascript:;",cb.onclick=function(){if(KE.g[Z]&&KE.g[Z].wyswygMode)KE.util.focus(Z),KE.util.selection(Z),KE.util.insertHtml(Z,GapFillStr),KE.util.focus(Z);else{var a=T.value.length;T.focus(),"undefined"!=typeof document.selection?document.selection.createRange().text=GapFillStr:T.value=T.value.substr(0,T.selectionStart)+GapFillStr+T.value.substring(T.selectionEnd,a),e.checkTitle()}return!1},cb.onmouseover=function(){toolTipLayerMenu.style.width="320px",toolTipLayerMenu.innerHTML="填空符用连续3个下划线表示，填空长度跟下划线的个数相关。点击按钮可在光标处插入填空符。";var a=this;this.hasOut=!1,setTimeout(function(){a.hasOut||sb_setmenunav(toolTipLayerMenu,!0,a)},200)},cb.onmouseout=function(){this.hasOut=!0,sb_setmenunav(toolTipLayerMenu,!1,this)},bb.appendChild(cb),db="填空属性",B&&(db="答案设置"),eb=$ce("span","&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a onclick='cur.setMRowAttr();return false;' href='javascript:' class='sumitbutton cancle'>"+db+"</a>",bb),this.setMRowAttr=function(){PDF_launch("/wjx/design/setrowattr.aspx?ct="+this.dataNode._topic,700,370,function(){cur.checkTitle(),B&&cur.checkSameScore()},"填空属性")},B&&(fb=$ce("span","&nbsp;&nbsp;&nbsp;&nbsp;<a onclick='cur.copyScore(this);return false;' class='link-U00a6e6' href='javascript:'>复制分数</a>",eb),fb.style.display="none",fb.onmouseover=function(){toolTipLayerMenu.style.width="176px",toolTipLayerMenu.innerHTML="复制此题分数到后面的题目";var a=this;this.hasOut=!1,setTimeout(function(){a.hasOut||sb_setmenunav(toolTipLayerMenu,!0,a)},200)},fb.onmouseout=function(){this.hasOut=!0,sb_setmenunav(toolTipLayerMenu,!1,this)},this.checkSameScore=function(){var d,e,a=getGapFillCount(this.dataNode._title),b=0,c=!0;for(d=0;a>d;d++)if(e=1,this.dataNode._rowVerify[d]&&(e=this.dataNode._rowVerify[d]._ceshiValue||1),b){if(b!=e){c=!1;break}}else b=e;fb.style.display=c?"":"none"},this.checkSameScore(),this.copyScore=function(){PDF_launch("/wjx/design/applyscore.aspx?ct="+e.dataNode._topic,500,240)},this.addCeShiDesc(eb)),gb=$ce("span","&nbsp;&nbsp;&nbsp;&nbsp;",bb),hb=control_check(),hb.id="tst_"+f._topic+"_"+RndNum(10),hb.className="checkbox",gb.appendChild(hb),hb.onclick=function(){e.dataNode._useTextBox=this.checked,e.checkTitle()},$ce("label","文本框样式",gb).setAttribute("for",hb.id))),x){if(ib=$ce("span","",ab),!$||C||E)_&&(ib.innerHTML="<select style='width:90px;' onclick='show_status_tip(\"提示："+_+"不能转换为其它题型\",6000);'><option value='0'>"+_+"</option></select>");else if(jb=_,ib.innerHTML=$,this.selChangeType=function(a){if("0"!=a){if("question"==a&&"question"!=this.dataNode._type)return layer.confirm("转换成填空题将丢失所有选项信息，是否继续？",{title:"提示"},function(b){changeQ(a),window.focus(),layer.close(b)}),void 0;changeQ(a),window.focus()}},"考试单选"==jb||"评分单选"==jb||"量表题"==jb||"考试填空"==jb||"考试简答"==jb){for(kb=!1,lb=0,mb=e.dataNode._topic,nb=!1,("考试填空"==jb||"考试简答"==jb)&&(nb=!0),ob=0;ob<questionHolder.length;ob++)if(pb=questionHolder[ob].dataNode,qb=pb._type,"cut"!=qb&&"page"!=qb&&(b=pb._topic,!(0>=b-mb))){if(nb&&"question"!=pb._type)break;if(!nb&&"radio"!=pb._type)break;lb++}lb>=2&&(kb=!0),kb&&(rb=$ce("span","&nbsp;&nbsp;<a href='javascript:;' class='link-U00a6e6' title='批量复制此题的题型到后面的题目'>批量复制</a>",ib),rb.onclick=function(){var a="/wjx/design/applyqtype.aspx",b=e.dataNode._topic;return a+="?ct="+b,PDF_launch(a,500,240),!1})}sb=$ce("span","",ab),C&&(sb.style.display="none"),sb.innerHTML="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",tb=control_check(),tb.title="用户在填写问卷时必须回答这道题",tb.className="checkbox",tb.id="req_"+f._topic+"_"+RndNum(10),sb.appendChild(tb),$ce("label","必答",sb).setAttribute("for",tb.id),ub=document.createElement("span"),ub.style.display="none",ub.innerHTML="&nbsp;&nbsp;&nbsp;&nbsp;将所有题目设为：<a href='javascript:setAllRequired(true);' class='link-U00a6e6'>必答</a>&nbsp;<a href='javascript:setAllRequired(false);' class='link-U00a6e6'>非必答</a>",sb.appendChild(ub),tb.onclick=function(){e.dataNode._requir=this.checked,e.setreqstatus(),ub.style.display=""},this.get_requir=function(){return tb},vb=document.createElement("span"),(C||E)&&(vb.style.display="none"),wb=$ce("span","&nbsp;",vb),xb=control_text("14"),xb.style.height="15px",wb.appendChild(xb),xb.style.display="none",yb=$ce("span","",wb),yb.style.marginLeft="30px",zb=$ce("a","填写提示",wb),zb.className="link-new",zb.title="填写提示可以作为副标题",zb.href="javascript:",zb.onclick=function(){return openTitleEditor(xb,function(a){return"-1nc"==a||void 0==a?!1:(xb.value=trim(a),xb.onchange(),void 0)}),!1},xb.onchange=xb.onblur=function(){this.value=replace_specialChar(this.value),e.get_div_ins().innerHTML=this.value,e.get_div_ins().style.display=this.value?"":"none",e.dataNode._ins=this.value,this.value?(zb.innerHTML="编辑提示",zb.className="link-set"):(zb.className="link-new",zb.innerHTML="填写提示"),e.checkTextJump&&e.checkTextJump(this.value)},ab.appendChild(vb),"301"==h&&($ce("span","&nbsp;",ab),Ab=control_check(),Ab.className="checkbox",Ab.id="slie_"+this.dataNode._topic+"_"+RndNum(10),Ab.style.marginLeft="30px",ab.appendChild(Ab),Bb=$ce("label","手机端不显示滑动条",ab),Bb.setAttribute("for",Ab.id),Bb.onmouseover=function(){toolTipLayerTop.style.width="400px",toolTipLayerTop.innerHTML="手机端表格数值题默认会有输入框和滑动条，勾选后手机端的滑动条会隐藏 ";var a=this;this.hasOut=!1,setTimeout(function(){a.hasOut||sb_setmenunav(toolTipLayerTop,!0,a)},200)},Bb.onmouseout=function(){this.hasOut=!0,sb_setmenunav(toolTipLayerTop,!1,this)},Ab.onclick=function(){e.dataNode._noslider=this.checked},this.dataNode._noslider&&(Ab.checked=!0))}if(B&&!u&&(Cb=document.createElement("div"),ab.appendChild(Cb),this.addCeShiSetting(Cb)),L.appendChild(O),d.appendChild(L),l&&(Db=document.createElement("span"),Db.innerHTML="此页是否是甄别页：",Db.title="可以在此页设置筛选规则，如果用户提交的答卷不符合要求，则会终止后面的答题",Db.style.margin="30px 0 0 50px",Db.style.display="inline-block",Eb=control_check(),Eb.title=Db.title,Eb.onclick=function(){e.dataNode._iszhenbie=this.checked,e.divZhenBie.style.display=this.checked?"":"none"},O.appendChild(Db),O.appendChild(Eb),Fb=$ce("i","",O),Fb.className="design-icon design-qmark",Fb.onmouseover=function(){toolTipLayer.style.width="300px",toolTipLayer.innerHTML="可以对此页的题目设置无效答卷筛选规则，用户点击下一页时，如果此页的答题不符合要求，系统会终止该用户继续答题。<a href='/help/help.aspx?helpid=76&h=1' class='titlelnk' target='_blank'>如何设置筛选规则？</a>",sb_setmenunav(toolTipLayer,!0,this)},Fb.onmouseout=function(){sb_setmenunav(toolTipLayer,!1,this)},Gb=!vipUser&&!window.isPromote,Gb&&(Db.style.display=Eb.style.display=Fb.style.display="none"),(5==newQType||2==newQType||3==newQType)&&(Eb.style.display=Fb.style.display=Db.style.display="none"),Hb=document.createElement("div"),Hb.style.margin="10px 0 0 50px",L.appendChild(Hb),Ib=document.createElement("div"),Ib.style.margin="10px 0 0 50px",$ce("span","<b>填写时间控制</b>&nbsp;",Ib),L.appendChild(Ib),Jb=control_text(3),$ce("span","此页允许停留时间为：<b>最短</b>",Ib).appendChild(Jb),Kb=control_text(3),Lb=$ce("span","秒&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>最长</b>",Ib),Lb.appendChild(Kb),$ce("span","秒（空表示不限制）",Ib),Jb.parDiv=e,Jb.onblur=Jb.onchange=function(){var e,a=this,b=a.value,c=this.parDiv,d=c.dataNode._maxtime;c.dataNode._istimer=!1,b?isPositive(b)&&(!d||0>=b-d)?(d&&0==b-d&&(c.dataNode._istimer=!0),c.dataNode._mintime=parseInt(b)):(show_status_tip("最短时间必须为正整数并且少于最长时间",4e3),a.value="",c.dataNode._mintime=""):c.dataNode._mintime="",cur.dataNode._mintime&&cur.dataNode._mintime==cur.dataNode._maxtime&&(1!=total_page||window.alertTime||(window.alertTime=1,alertNew("提示：您设置的最短填写时间等于最长填写时间，这个一般用于控制用户在确定的时间内观看图片或者视频"))),e=c.dataNode._mintime||c.dataNode._maxtime,Nb.style.display=(window.isPromote||vipUser)&&e?"":"none",c.showTimeLimit()},Jb.onclick=function(){return vipUser?void 0:(alertNew('提示：只有企业版用户才能设置每页最短填写时间，请<a href="/register/upgradevip.aspx?upgradeReason=48" target="_blank">升级</a>'),this.value="",this.blur(),void 0)},Kb.onclick=function(){return vipUser?void 0:(alertNew('提示：只有企业版用户才能设置每页最长填写时间，请<a href="/register/upgradevip.aspx?upgradeReason=48" target="_blank">升级</a>'),this.value="",this.blur(),void 0)},Kb.onblur=Kb.onchange=function(){var d,a=this,b=a.value,c=cur.dataNode._mintime;cur.dataNode._istimer=!1,b?isPositive(b)&&(!c||b-c>=0)?(c&&0==b-c&&(cur.dataNode._istimer=!0),cur.dataNode._maxtime=parseInt(b)):(show_status_tip("最长时间必须为正整数并且大于最短时间",4e3),a.value=""):cur.dataNode._maxtime="",d=cur.dataNode._mintime||cur.dataNode._maxtime,cur.dataNode._mintime&&cur.dataNode._mintime==cur.dataNode._maxtime&&(1!=total_page||window.alertTime||(window.alertTime=1,alertNew("提示：您设置的最短填写时间等于最长填写时间，这个一般用于控制用户在确定的时间内观看图片或者视频！"))),Nb.style.display=(window.isPromote||vipUser)&&d?"":"none",e.showTimeLimit()},e.setMinMaxTime=function(){Jb&&(Jb.value=this.dataNode._mintime),Kb&&(Kb.value=this.dataNode._maxtime)},Mb=$ce("i","",Ib),Mb.className="design-icon design-qmark",Mb.onmouseover=function(){toolTipLayer.style.width="250px",toolTipLayer.innerHTML="说明：从进入此页开始计时，在还未达到最短填写时间时不能进入下一页或提交答卷，当到达最长填写时间后还未做答完成将自动跳转到下一页或提交答卷。如果要控制用户观看图片或者视频的时间，可以设置最短填写时间等于最长填写时间，<a href='http://www.sojump.com/jq/3690298.aspx' target='_blank' class='titlelnk'>查看示例问卷</a>",sb_setmenunav(toolTipLayer,!0,this)},Mb.onmouseout=function(){sb_setmenunav(toolTipLayer,!1,this)},Nb=$ce("div","将上面的填写时间复制到&nbsp;",Ib),Nb.style.margin="6px 0 0 86px",Ob=1,Pb=1,Qb=total_page,$ce("span","<input type='radio'  name='rbltimesp' onclick='cur.setTimePageTime(1);'  checked='checked'  />所有页<input type='radio' name='rbltimesp'  onclick='cur.setTimePageTime(2);'/>指定页",Nb),Rb=$ce("span","：第<input type='text' value='1' onblur='cur.setTimePageStart(this);' style='width:20px;'/>页到<input type='text' value='"+Qb+"' onblur='cur.setTimePageEnd(this);' style='width:20px;'/>页",Nb),Rb.style.display="none",e.setTimePageTime=function(a){Ob=a,Rb.style.display=1==a?"none":""},e.setTimePageStart=function(a){var b=a.value;(!isPositive(b)||b-Qb>=0)&&(a.value=1,show_status_tip("必须为正数，并且小于最大页数",4e3)),Pb=a.value},e.setTimePageEnd=function(a){var b=a.value;!isPositive(b)||b-total_page>0?(a.value=total_page,show_status_tip("必须为正数，并且小于总页数",4e3)):0>=b-Pb&&(a.value=total_page,show_status_tip("必须大于最小页数",4e3)),Qb=a.value},Sb=$ce("span","&nbsp;",Nb),Tb=control_btn("复制"),Tb.className="finish cancle",Sb.appendChild(Tb),Tb.onclick=function(){1==Ob&&(Qb=total_page),Ub(firstPage);for(var a=0;a<questionHolder.length;a++)Ub(questionHolder[a]);show_status_tip("成功复制",4e3)}),x&&($ce("div","",L).style.clear="both",Vb=document.createElement("div"),Vb.className="container",Vb.style.position="relative",w||(Wb=document.createElement("div"),Wb.style.margin="15px 0 0",Vb.appendChild(Wb)),L.appendChild(Vb)),j&&($ce("span","最小值：",Wb),Xb=control_text("3"),Xb.title="用户可以选择的最小值",Xb.maxLength=4,Xb.style.height="20px",Wb.appendChild(Xb),$ce("span","&nbsp;&nbsp;&nbsp;&nbsp;最小值显示文本：",Wb),Yb=control_text("10"),Yb.style.height="20px",Wb.appendChild(Yb),Zb=document.createElement("br"),Wb.appendChild(Zb),$ce("div","",Wb).style.height="6px",$ce("span","最大值：",Wb),$b=control_text("3"),$b.style.height="20px",$b.title="用户可以选择的最大值",$b.maxLength=4,Wb.appendChild($b),$ce("span","&nbsp;&nbsp;&nbsp;&nbsp;最大值显示文本：",Wb),_b=control_text("10"),_b.style.height="20px",Wb.appendChild(_b),Xb.onchange=Xb.onblur=function(){var a=100;!isInt(this.value)||this.value-$b.value>0?(show_status_tip("最小值不合法",4e3),a=0-$b.value<0?0:toInt($b.value)-1):a=toInt(this.value),e.dataNode._minvalue=a,this.value=a,e.get_span_min_value().innerHTML="("+a+")"},$b.onchange=$b.onblur=function(){!isInt(this.value)||this.value-Xb.value<0?(show_status_tip("最大值不合法",4e3),val=100-Xb.value>0?100:toInt(Xb.value)+1):val=toInt(this.value),e.dataNode._maxvalue=val,this.value=val,e.get_span_max_value().innerHTML="("+val+")"},Yb.onchange=Yb.onblur=function(){this.value=replace_specialChar(this.value),e.get_span_min_value_text().innerHTML=e.dataNode._minvaluetext=this.value},_b.onchange=_b.onblur=function(){this.value=replace_specialChar(this.value),e.get_span_max_value_text().innerHTML=e.dataNode._maxvaluetext=this.value}),t){for($ce("span","限制上传文件大小：",Wb),ac=control_text("3"),bc=fileMaxSize/1024,ac.maxLength=5,ac.title="上传文件大小不能超过"+bc+"M，上传后的文件最多保存5年",Wb.appendChild(ac),$ce("span","M",Wb),e.dataNode._isvoice&&$ce("span","&nbsp;&nbsp;&nbsp;<b>提示：</b>必须在微信中才能录音，否则只能上传文件",Wb),ac.onblur=ac.onchange=function(){var a=ac.value;a?isPositive(a)&&0>=a-bc?e.dataNode._maxsize=1024*a:(e.dataNode._maxsize=fileMaxSize,show_status_tip("最大文件大小必须为正数，并且不能超过"+bc+"M",3e3),this.value=""):e.dataNode._maxsize=fileMaxSize,e.updateFileUpload()},cc=$ce("span","限制上传文件数量：",Wb),cc.style.cssText="margin-left: 20px;",dc=$ce("select","",Wb),ec=document.createDocumentFragment(),ob=1;10>=ob;ob++)fc=new Option(ob),fc.value=ob,fc.innerHTML=ob,ec.appendChild(fc);if(dc.onchange=function(){if(!vipUser)return this.options[0].selected=!0,alertNew("提示：此功能只对企业版用户开放，请<a href='/register/upgradevip.aspx?upgradeReason=45' target='_blank'>升级</a>"),void 0;var b=this.options[this.selectedIndex].value;e.dataNode._uploadlimit=parseInt(b)},dc.appendChild(ec),dc.style.cssText="font-size: 14px; background-color: #fff;width: 60px; height: 30px;line-height: 30px;border: 1px solid #A9A9A9;",gc=$ce("div","",Wb),gc.style.marginTop="15px",hc=control_check(),hc.className="checkbox",hc.id="chkext_"+e.dataNode._topic+"_"+RndNum(10),gc.appendChild(hc),$ce("label","限制上传文件类型",gc).setAttribute("for",hc.id),hc.onclick=function(){var a,b,d,c,f;if(nc.style.display=this.checked?"":"none",a=nc.getElementsByTagName("input"),b=!1,this.checked){for(c=0;d=a[c++];)if(1==d.checked){b=!0;break}if(!b){for(f=new Array,c=0;d=a[c++];)d.checked=!0,d.value&&f.push(d.value);e.dataNode._ext=f.join("|")}}else{for(c=0;d=a[c++];)d.checked=!1;e.dataNode._ext=""}},e.dataNode._isvoice&&(gc.style.display="none"),ic="<div style='margin-left:20px;'><b>图片文件：</b><input type='checkbox' value=''/>全选&nbsp;&nbsp;<input type='checkbox' value='.gif'/>.gif&nbsp;<input type='checkbox' value='.png'/>.png&nbsp;<input type='checkbox' value='.jpg'/>.jpg&nbsp;<input type='checkbox' value='.jpeg'/>.jpeg&nbsp;<input type='checkbox' value='.bmp'/>.bmp&nbsp;</div>",ic+="<div style='margin-left:20px;'><b>文档文件：</b><input type='checkbox' value=''/>全选&nbsp;&nbsp;<input type='checkbox' value='.doc'/>.doc&nbsp;<input type='checkbox' value='.docx'/>.docx&nbsp;<input type='checkbox' value='.pdf'/>.pdf&nbsp;<input type='checkbox' value='.xls'/>.xls&nbsp;<input type='checkbox' value='.xlsx'/>.xlsx&nbsp;<input type='checkbox' value='.ppt'/>.ppt&nbsp;<input type='checkbox' value='.pptx'/>.pptx&nbsp;<input type='checkbox' value='.txt'/>.txt&nbsp;</div>",ic+="<div style='margin-left:20px;'><b>压缩文件：</b><input type='checkbox' value=''/>全选&nbsp;&nbsp;<input type='checkbox' value='.rar'/>.rar&nbsp;<input type='checkbox' value='.zip'/>.zip&nbsp;<input type='checkbox' value='.gzip'/>.gzip</div>",ic+="<div style='margin-left:20px;'><b>视频文件：</b><input type='checkbox' value=''/>全选&nbsp;&nbsp;<input type='checkbox' value='.mp4'/>.mp4&nbsp;<input type='checkbox' value='.m3u8'/>.m3u8&nbsp;<input type='checkbox' value='.flv'/>.flv&nbsp;<input type='checkbox' value='.f4v'/>.f4v&nbsp;<input type='checkbox' value='.webm'/>.webm&nbsp;<input type='checkbox' value='.mov'/>.mov&nbsp;<input type='checkbox' value='.m4v'/>.m4v&nbsp;<input type='checkbox' value='.3gp'/>.3gp&nbsp;<input type='checkbox' value='.avi'/>.avi&nbsp;<input type='checkbox' value='.wmv'/>.wmv</div>",ic+="<div style='margin-left:20px;'><b>音频文件：</b><input type='checkbox' value=''/>全选&nbsp;&nbsp;<input type='checkbox' value='.mp3'/>.mp3&nbsp;<input type='checkbox' value='.wma'/>.wma&nbsp;<input type='checkbox' value='.wav'/>.wav&nbsp;<input type='checkbox' value='.amr'/>.amr</div>",jc=defaultFileExt.split("|"),kc=f._ext||defaultFileExt){for(lc=kc.split("|"),mc=[],ob=0;ob<lc.length;ob++)-1==jc.indexOf(lc[ob])&&mc.push(lc[ob]);for(mc.length>0&&(ic+="<div style='margin-left:20px;'><b>其它文件：</b><input type='checkbox' value=''/>全选&nbsp;&nbsp;"),ob=0;ob<mc.length;ob++)ob>0&&(ic+="&nbsp;"),ic+="<input type='checkbox' value='"+mc[ob]+"'/>"+mc[ob]}nc=$ce("div",ic,Wb),e.updateExt=function(){var d,b=$$("input",nc),c="";for(d=0;d<b.length;d++)b[d].checked&&b[d].value&&(c&&(c+="|"),c+=b[d].value);this.dataNode._ext=c,this.updateFileUpload()}}for(i&&"多级下拉"!=e.dataNode._verify?(oc=document.createElement("div"),control_check(),qc=document.createElement("span"),rc=getVerifyHtml(0),qc.innerHTML=rc,oc.appendChild(qc),this.setVerify=function(a){var c,d,f,g,b=!1;("省市区"==this.dataNode._verify||"省市区"==a.value||"高校"==this.dataNode._verify||"高校"==a.value)&&(b=!0),this.dataNode._verify=a.value,"数字"==this.dataNode._verify||"小数"==this.dataNode._verify?(yc.innerHTML=yc.innerHTML.replace("字数","值"),Ac.innerHTML=Ac.innerHTML.replace("字数","值"),xc="值"):(yc.innerHTML=yc.innerHTML.replace("值","字数"),Ac.innerHTML=Ac.innerHTML.replace("值","字数"),xc="字数"),c="密码"==this.dataNode._verify,d="地图"==this.dataNode._verify,Dc.style.display=c?"none":"",Ic.style.display=c||d||"城市单选"==this.dataNode._verify?"none":"","城市单选"==this.dataNode._verify&&(Mc.value="",Jc.checked&&Jc.click()),c&&(e.dataNode._needOnly=!1),c&&!e.dataNode._requir&&tb.click(),Dc.getElementsByTagName("label")[0].innerHTML=d?"不允许填写者修改&nbsp;":"不允许重复&nbsp;",f="日期"==this.dataNode._verify||c||"手机"==this.dataNode._verify||d,Pc&&(Pc.style.display=f?"none":""),("日期"==this.dataNode._verify||"手机"==this.dataNode._verify||"整数"==this.dataNode._verify||"小数"==this.dataNode._verify)&&(this.dataNode._width=200,this.dataNode._height=1,"日期"==this.dataNode._verify&&(this.dataNode._width=100)),g=a.value&&"0"!=a.value&&"汉字"!=a.value&&"英文"!=a.value,Rc.style.display=g?"none":"",g&&(this.dataNode._height=1,Vc.style.display="none"),this.changeDefaultAttr(b),this.showTextAreaDate(),this.showByVerify(),this.showSmsVerify()
},this.showByVerify=function(){var c,a=this.dataNode._verify,b="密码"==a;Fc&&(Fc.style.display="手机"==a?"":"none"),Hc&&(Hc.style.display=b?"":"none"),c="数字"==a||"小数"==a||"汉字"==a||"英文"==a||"学号"==a||""==a||"0"==a,uc.style.display=c?"":"none",c||(e.dataNode._minword="",e.dataNode._maxword="",wc.style.display="none",e.showMinMaxWord("",""))},this.initVerify=function(){var a=this.dataNode._verify||"0",b=$$("select",qc)[0];b.value=a,this.showByVerify()},sc="&nbsp;&nbsp;",B&&(sc=""),tc=control_check(),tc.id="mma_"+f._topic+RndNum(10),tc.className="checkbox",uc=$ce("span",sc,oc),uc.appendChild(tc),vc="限制范围",$ce("label",vc+"&nbsp;",uc).setAttribute("for",tc.id),tc.onclick=function(){wc.style.display=this.checked?"":"none",this.checked||(zc.value&&(zc.value="",zc.onchange()),Bc.value&&(Bc.value="",Bc.onchange()))},wc=$ce("span","&nbsp;&nbsp;",oc),xc="字数",("数字"==f._verify||"小数"==f._verify)&&(xc="值"),yc=$ce("span","最小"+xc+"：",wc),zc=control_text("4"),zc.title="不填表示无限制",wc.appendChild(zc),zc.onchange=zc.onblur=function(){var a=this.value,b=Bc.value;!isEmpty(a)&&(!isInt(a)||!isEmpty(b)&&this.value-b>0)?(show_status_tip("最小"+xc+"不合法",4e3),this.value=""):isEmpty(a)||"数字"==e.dataNode._verify||"小数"==e.dataNode._verify||a-3e3>0&&(show_status_tip("最小字数不能超过3000",4e3),this.value=""),e.dataNode._minword=this.value,e.showMinMaxWord(b,this.value),e.checkDefault()},Ac=$ce("span","最大"+xc+"：",wc),Ac.style.marginLeft="10px",Bc=control_text("4"),Bc.title="不填表示无限制",Bc.onchange=Bc.onblur=function(){var a=this.value,b=zc.value;!isEmpty(a)&&(!isInt(a)||!isEmpty(b)&&this.value-b<0)?(show_status_tip("最大字数不合法",4e3),this.value=""):isEmpty(a)||"数字"==e.dataNode._verify||"小数"==e.dataNode._verify||a-3e3>0&&(show_status_tip("最大字数不能超过3000",4e3),this.value=""),e.dataNode._maxword=this.value,e.showMinMaxWord(this.value,b),e.checkDefault()},wc.appendChild(Bc),Cc=control_check(),Cc.id="only_"+f._topic+RndNum(10),Cc.className="checkbox",Dc=$ce("span","&nbsp;&nbsp;",oc),Dc.appendChild(Cc),vc="不允许重复","地图"==f._verify&&(vc="不允许填写者修改"),$ce("label",vc+"&nbsp;",Dc).setAttribute("for",Cc.id),Cc.onclick=function(){if(!vipUser)return this.checked=!1,alertNew("提示：此功能只对企业版用户开放，请<a href='/register/upgradevip.aspx?upgradeReason=49' target='_blank'>升级</a>"),void 0;if(this.checked){var a=Cc;checkAnswerTextOnlyOne(1e4*e.dataNode._topic,function(){a.checked=e.dataNode._needOnly=!0,a.checked&&!e.dataNode._requir&&"地图"!=e.dataNode._verify&&(show_status_tip("由于设置了唯一性，推荐将该题设为必答题",4e3),tb.click())},function(){a.checked=e.dataNode._needOnly=!1})}else this.checked=e.dataNode._needOnly=!1},Dc.title="要求每个人填写的答案是唯一的",Ec=control_check(),Ec.id="sms_"+f._topic+"_"+RndNum(10),Ec.className="checkbox",Fc=$ce("span","&nbsp;&nbsp;",oc),Fc.appendChild(Ec),$ce("label","使用短信验证",Fc).setAttribute("for",Ec.id),Gc=$ce("span","&nbsp;&nbsp此功能需要购买短信：<a href='/corphome/account/prepaysms.aspx?amount=500' target='_blank' class='link-set'>立即购买</a>",Fc),Ec.onclick=function(){this.checked?(e.dataNode._olddefault=Mc.value,Mc.value="",Mc.onchange()):Mc.value=e.dataNode._olddefault||"",Mc.onchange(),e.dataNode._needsms=this.checked,Gc.style.display=this.checked?"":"none",this.checked&&!e.dataNode._requir&&(show_status_tip("由于设置了短信验证，推荐将该题设为必答题",4e3),tb.click()),Ic.style.display=this.checked?"none":"",e.showSmsVerify()},Gc.style.display=e.dataNode._needsms?"":"none",Hc=$ce("span","&nbsp;&nbsp;提示：密码会通过MD5加密存储，不会对任何人公开。",oc),Ic=$ce("span","&nbsp;&nbsp;",oc),(e.dataNode._needsms||B)&&(Ic.style.display="none"),Jc=control_check(),Jc.id="def_"+f._topic+"_"+RndNum(10),Jc.className="checkbox",Ic.appendChild(Jc),Kc="默认值",Lc=$ce("label",Kc,Ic),Lc.setAttribute("for",Jc.id),Mc=control_textarea("1","16"),Mc.style.overflow="auto",Mc.style.height="",Mc.style.marginLeft="4px",Mc.style.display="none",Mc.style.verticalAlign="middle",Mc.maxLength="20",Mc.title="最多输入20个字符",Jc.onclick=function(){Mc.style.display="none"==Mc.style.display?"":"none",this.checked?Mc.value=e.dataNode._olddefault||"":(e.dataNode._olddefault=Mc.value,Mc.value=""),Mc.onchange()},Ic.appendChild(Mc),("密码"==f._verify||"地图"==f._verify||"城市单选"==f._verify)&&(Ic.style.display="none","密码"==f._verify&&(Dc.style.display="none")),Mc.onchange=Mc.onblur=function(){e.checkDefault&&e.checkDefault()},this.changeDefaultAttr=function(a){"省市区"==this.dataNode._verify||"高校"==this.dataNode._verify?(Lc.innerHTML="指定省份",Mc.onmouseover=function(){openProvinceWindow(e,this)},Mc.onmouseout=function(){sb_setmenunav(toolTipLayer,!1)}):(Lc.innerHTML=Kc,Mc.onmouseover=Mc.onmouseout=null),a&&(Mc.value="",Mc.onchange())},this.changeDefaultAttr(),Wb.appendChild(oc),B&&(Dc.style.display=qc.style.display="none"),this.get_span_maxword(),Oc=this.get_textarea(),Pc=null,B?Pc=$ce("span","&nbsp;&nbsp;&nbsp;&nbsp;",oc):(Pc=$ce("div","",oc),Pc.style.marginTop="15px",Qc="日期"==f._verify||"密码"==f._verify||"手机"==f._verify||"地图"==f._verify,Pc.style.display=Qc?"none":""),Rc=$ce("span","",Pc),Sc="<select onchange='cur.setTHeight(this);'><option value='1'>设置高度</option><option value='1'>高度1行</option><option value='2'>高度2行</option><option value='3'>高度3行</option><option value='4'>高度4行</option><option value='5'>高度5行</option><option value='10'>高度10行</option><option value='自定义'>自定义高度</option></select>&nbsp;&nbsp;",Rc.innerHTML+=Sc,Tc=$ce("span","",Pc),Uc=control_text("3"),Uc.maxLength=3,Uc.onchange=Uc.onblur=function(){var a=this.value;isEmpty(a)||isInt(a)?e.dataNode._height=a?parseInt(a):"":(show_status_tip("您输入的高度不合法！"),this.value="",e.dataNode._height="1"),Vc.style.display="",e.showTextAreaHeight()},this.setTHeight=function(a){"自定义"!=a.value?(Uc.value=a.value,Tc.style.display="none",Uc.onchange()):Tc.style.display=""},this.initHeight=function(){if(this.dataNode._height){var a=$$("select",Rc)[0];a.value=this.dataNode._height,-1==a.selectedIndex&&(a.value="自定义",this.setTHeight(selWidth))}},Tc.style.display="none",Tc.appendChild(Uc),Vc=$ce("span","<a href='###' class='copy-tit' title='复制到后面的题目'></a>&nbsp;&nbsp;",Pc),Vc.style.display="none",Vc.onclick=function(){var a="/wjx/design/applyheight.aspx",b=e.dataNode._topic;return a+="?ct="+b,PDF_launch(a,500,250),!1},z=f._verify&&"0"!=f._verify&&"汉字"!=f._verify&&"英文"!=f._verify,Rc.style.display=z?"none":"",Wc=$ce("span","",Pc),Xc="<select onchange='cur.setTWidth(this);'><option value=''>设置宽度</option><option value='50'>宽度50</option><option value='100'>宽度100</option><option value='200'>宽度200</option><option value='300'>宽度300</option><option value='400'>宽度400</option><option value='500'>宽度500</option><option value='600'>宽度600</option><option value='自定义'>自定义宽度</option></select>&nbsp;",Wc.innerHTML+=Xc,Yc=control_text("5"),Yc.maxLength=3,Yc.onchange=Yc.onblur=function(){var a=this.value;isEmpty(a)||isInt(a)?(e.dataNode._width=a?parseInt(a):"","1"==a&&e.dataNode._requir&&tb.click()):(show_status_tip("您输入的宽度不合法！"),this.value="",e.dataNode._width=""),e.showTextAreaWidth()},this.setTWidth=function(a){"自定义"!=a.value?(Yc.value=a.value,Yc.style.display="none",Yc.onchange()):Yc.style.display=""},this.initWidth=function(){if(this.dataNode._width){var a=$$("select",Wc)[0];a.value=this.dataNode._width,(-1==a.selectedIndex||"1"==this.dataNode._width)&&(a.value="自定义",this.setTWidth(a))}},Pc.appendChild(Wc),Yc.style.display="none",Pc.appendChild(Yc),Zc=$ce("span","&nbsp;&nbsp;",Pc),$c=control_check(),$c.className="checkbox",$c.id="und_"+f._topic+"_"+RndNum(10),Zc.appendChild($c),$ce("label","下划线样式",Zc).setAttribute("for",$c.id),$c.onclick=function(){e.dataNode._underline=this.checked,e.showTextAreaUnder()}):i&&"多级下拉"==e.dataNode._verify&&(_c="/wjx/design/setmenulist.aspx?ct="+e.dataNode._topic,$ce("span","<a class='sumitbutton cancle' href='javascript:' onclick='PDF_launch(\""+_c+'",800,700,null,"录入多级下拉选项");return false;\'>点击设置多级下拉选项</a>',Wb)),w&&(bd=document.createElement("div"),bd.style.clear="both"),cd=!1,ob=0;ob<questionHolder.length;ob++)if(pb=questionHolder[ob].dataNode,"cut"!=pb._type&&"page"!=pb._type){if(b=pb._topic,b-this.dataNode._topic<0&&"check"==pb._type){cd=!0;break}if(b-this.dataNode._topic>=0)break}if((r||k)&&(dd=document.createElement("div"),dd.style.position="relative",dd.style.zIndex="1",r?(bd.appendChild(dd),dd.style.width="344px",s&&(dd.style.width="505px","303"==h&&(dd.style.width="434px"),"301"==h&&(dd.style.width="575px")),"202"==h&&(dd.style.width="400px"),5==newQType&&(202!=h&&300>h?dd.style.display="none":h>300&&(dd.style.width="220px",303!=h&&(dd.style.width="259px")))):Vb.appendChild(dd),ed=document.createElement("div"),dd.appendChild(ed),ed.className="matrixtitle",ed.style.width="344px",s?(ed.style.width="246px",(5==newQType||H)&&(ed.style.display="none"),303==h&&(ed.style.width="217px")):202==h&&5==newQType&&(ed.style.display="none"),k&&(dd.style.width="400px",fd=$ce("div","可分配的总比重值：",ed),fd.style.marginBottom="10px",gd=control_text("3"),gd.style.height="20px",gd.maxLength=3,gd.style.overflow="auto",gd.value=this.dataNode._total||"100",fd.appendChild(gd),gd.onchange=gd.onblur=function(){isInt(this.value)&&parseInt(this.value)>0?e.dataNode._total=parseInt(this.value):(e.dataNode._total=100,show_status_tip("可分配总比重值要大于0",4e3)),this.value=e.dataNode._total}),hd=r?"行标题":"比重评估项目",s&&(hd="行标题"),id=s?"22":"39",jd="7",isMergeAnswer&&!this.isMergeNewAdded&&(Qf=""),cd||(Qf=""),kd="<span class='fullScreen' style='display:inline-block;vertical-align:middle;margin-left:3px;' title='放大文本框进行编辑' onclick='cur.enlargeRowTitle();'></span>",ld=$ce("div","<span style='float:left;'><b>"+hd+kd+"</b></span>",ed),ld.className="matrixhead",ld.style.paddingLeft="4px",r&&!s&&(md=$ce("span","",ld),md.className="spanRight",md.style.paddingRight="20px",nd=control_check(),md.appendChild(nd),od=$ce("span","右行标题",md),nd.checked=f._rowtitle2?!0:!1),$ce("div","",ld).className="divclear",pd=control_textarea(jd,id),pd.style.overflow="auto",pd.tabIndex=1,pd.setAttribute("wrap","off"),pd.value=this.dataNode._rowtitle,pd.style.padding="2px",pd.style.height="172px",pd.style.width="330px",("301"==h||"302"==h||"201"==h||"202"==h)&&(pd.style.height="154px",("201"==h||"202"==h)&&(pd.style.width="338px"),("301"==h||"302"==h)&&(pd.style.width="220px")),"303"==h&&(pd.style.width="200px"),k?(pd.style.width="338px",pd.style.height="154px"):(pd.style.marginTop="7px","102"==h&&(pd.style.height="136px")),this.enlargeRowTitle=function(){enlargeEditor(pd,"行标题")},!isMergeAnswer||this.isMergeNewAdded?pd.title="相当于每个小题的标题":(pd.oldLen=pd.value.split("\n").length,pd.oldValue=pd.value,pd.title="特别提示：有答卷的情况下只能修改文字，不能增加或删除行标题，也不能移动行标题顺序",pd.onclick=function(){pd.alert||(alertNew(pd.title),pd.alert=!0)},pd.onkeypress=function(a){var a=a||window.event;return 13==a.keyCode?(alertNew("有答卷的情况下不能添加新行，只能修改文字内容！"),a.preventDefault&&a.preventDefault(),void 0!==a.returnValue&&(a.returnValue=!1),event.keyCode=0,!1):void 0}),ed.appendChild(pd),this.checkRowTitle=function(a){var b,c,d,f,g,h,i,j;if(this.popHint(""),b="",pd.style.border="1px solid #cdcdcd",pd.value=replace_specialChar(pd.value),""==trim(pd.value)&&(pd.value="外观\n功能"),H&&a)for(c=pd.value.split("\n"),d=a-c.length,pd.value="",f=1;a>=f;f++)pd.value+=f+"\n";for(c=pd.value.split("\n"),g=0,f=0;f<c.length;f++)for(""!=trim(c[f])&&(g>0&&(b+="\n"),b+=c[f],g++),h=f+1;h<c.length;h++)if(""!=trim(c[f])&&trim(c[f])==trim(c[h]))return this.popHint(hd+"的第"+(f+1)+"行与第"+(h+1)+"行重复，请修改！"),this.isRowTitleValid=!1,pd.style.border="1px solid red",!1;return i=b.split("\n").length,pd.oldLen&&i!=pd.oldLen&&(H?(alertNew("有答卷状态下，不能修改最大行数！"),this.dataNode._maxvalue=pd.oldLen,Gd.value=pd.oldLen,b=pd.oldValue):(j=this,layer.confirm("有答卷的情况下不能增加或删除行标题，只能修改文字内容！\r\n是否还原为初始状态的值？",{title:"提示"},function(a){b=pd.oldValue,j.isRowTitleValid=!0,pd.value=b,j.dataNode._rowtitle=b,layer.close(a)},function(){j.isRowTitleValid=!1}))),this.isRowTitleValid=!0,pd.value=b,this.dataNode._rowtitle=b,!0},pd.onfocus=function(){"外观\n功能"==this.value&&(this.value="")},pd.onblur=function(){this.value||(this.value="外观\n功能");var a=e.checkRowTitle();k?e.createSum():r&&a&&(e.updateItem(),e.refreshSelRow&&e.refreshSelRow())},this.setRowTitle=function(a){pd.value=a,pd.onblur()},r&&!s&&(rd=document.createElement("div"),rd.style.display=nd.checked?"":"none",rd.style.width="172px",rd.className="spanLeft matrixhead",dd.appendChild(rd),sd=control_check(),td=$ce("div","",rd),td.appendChild(sd),$ce("span","右行标题(可选)",td),sd.checked=nd.checked,nd.onclick=sd.onclick=function(){rd.style.display=this.checked?"":"none",pd.style.width=this.checked?"162px":"330px",ed.style.width=this.checked?"172px":"344px",tf.style.display=this.checked?"":"none",nd.style.display=this.checked?"none":"",od.style.display=this.checked?"none":"",nd.checked=sd.checked=this.checked,this.checked?ud.value||(ud.value=ud.prevValue||""):(ud.prevValue=ud.value,ud.value=""),ud.onblur()},ud=control_textarea("7","19"),rd.appendChild(ud),ud.style.overflow="auto",ud.value=this.dataNode._rowtitle2||"",ud.title="适用于“语义差异法”等场景",ud.style.padding="2px",ud.style.width="156px",ud.style.margin="7px 0 0 4px","201"!=h&&"202"!=h&&(ud.style.height="172px","102"==h&&(ud.style.height="136px")),this.checkRowTitle2=function(){return r&&(ud.value=replace_specialChar(ud.value),this.dataNode._rowtitle2=ud.value),!0},ud.onblur=function(){e.checkRowTitle2(),e.updateItem()}),s&&(vd=document.createElement("div"),setFloat(vd),"303"==h?vd.style.width="217px":(vd.style.width="229px","301"==h&&(vd.style.width="246px"),5==newQType&&(vd.style.width="296px"),H&&(vd.style.width="469px")),dd.appendChild(vd),$ce("div","<b>列标题</b>&nbsp;",vd).className="matrixhead",wd=control_textarea("7","22"),wd.style.overflow="auto",wd.value=this.dataNode._columntitle,wd.style.margin="0px",wd.style.height="172px",s&&"303"!=h&&(wd.style.height="154px","301"==h&&(wd.style.width="236px"),5==newQType&&(wd.style.width="290px"),H&&(wd.style.width="460px")),s&&"303"==h&&(wd.style.width="200px"),wd.style.padding="2px",wd.style.margin="7px 0 0 4px",5==newQType&&"303"!=h&&(wd.style.margin="0"),!isMergeAnswer||this.isMergeNewAdded?wd.title="列标题":(wd.disabled=!0,wd.title="提示：部分修改问卷模式下不能更改列标题！"),vd.appendChild(wd),wd.onblur=function(){var a=e.checkColumnTitle();a&&(e.updateItem(),e.refreshSelRow&&e.refreshSelRow())},this.checkColumnTitle=function(){var a,b,c;if(this.popHint(""),""==trim(wd.value))return this.popHint("列标题不能为空！"),wd.focus(),this.isColumnTitleValid=!1,!1;for(a=wd.value.split("\n"),b=0;b<a.length;b++)for(c=b+1;c<a.length;c++)if(""!=trim(a[b])&&trim(a[b])==trim(a[c]))return this.popHint("列标题的第"+(b+1)+"行与第"+(c+1)+"行重复，请修改！"),this.isColumnTitleValid=!1,!1;return this.isColumnTitleValid=!0,wd.value=replace_specialChar(wd.value),this.dataNode._columntitle=wd.value,!0}),this.syncRowHeight=function(){var a,b,c;this.dataNode._tag&&(a=!1,(this.dataNode._tag<=103||"303"==this.dataNode._tag)&&(a=!0),a&&(b=this.dataNode._select.length-1,c=37*b-13,pd.style.height=c+"px","303"==this.dataNode._tag?wd.style.height=c+"px":ud.style.height=c+"px"))},this.syncRowHeight(),$ce("div","",dd).className="divclear",this.addLabel=function(){PDF_launch("/wjx/design/setrowlabel.aspx?ct="+this.dataNode._topic,580,400,null,"分组设置")},xd=$ce("div","",dd),yd=$ce("span","<a href='javascript:;' onclick='cur.addLabel();return false;' class='link-U666'>分组设置</a>&nbsp;&nbsp;",xd),xd.style.margin="12px 0 8px",(5==newQType||H)&&(yd.style.display="none"),r&&(zd=control_check(),zd.className="checkbox",zd.id="rowrn_"+f._topic+"_"+RndNum(10),zd.onclick=function(){return vipUser?(e.dataNode._randomRow=this.checked,void 0):(alertNew('提示：只有企业版才能使用此功能，请<a href="/register/upgradevip.aspx?upgradeReason=53" target="_blank">升级</a>'),this.checked=!1,void 0)},zd.checked=e.dataNode._randomRow,Ad=document.createElement("label"),Ad.setAttribute("for",zd.id),Ad.innerHTML="行标题随机&nbsp;",Ad.title="标题随机显示",H&&(Ad.style.display="none",zd.style.display="none"),yd.appendChild(zd),yd.appendChild(Ad),Bd=document.createElement("span"),Bd.style.display="inline-block",""==yd.style.display&&(Bd.style.marginLeft="20px"),Cd=H?"默认显示行数：":"最小值：",Dd=H?"最大允许行数：":"最大值：",$ce("span",Cd,Bd),Ed=control_text("3"),Ed.title=H?"用户可以选择的默认显示行数":"用户可以选择的最小值",Ed.maxLength=3,Ed.value=this.dataNode._minvalue,Bd.appendChild(Ed),Ed.onchange=Ed.onblur=function(){var b,c,a=this.value;if(H)for(isEmpty(this.value)?(show_status_tip("默认显示行数不能为空",4e3),a=2):(!isInt(this.value)||this.value-Gd.value>=0||this.value<1)&&(this.value<1?show_status_tip("默认显示行数不能小于1行！",4e3):show_status_tip("最大允许行数必须大于默认显示行数！",4e3),a=2),this.value=e.dataNode._minvalue=a,b=e.getElementsByTagName("table")[0].children[1].children,c=0;c<b.length;c++)b[c].style.display=c>=a?"none":"";else isEmpty(this.value)&&"202"!=e.dataNode._tag||(!isInt(this.value)||this.value-Gd.value>0?(show_status_tip("最小值不合法",4e3),a=0-Gd.value<0?0:toInt(Gd.value)-1,parseInt(a)!=a&&(a=0)):a=toInt(this.value)),this.value=e.dataNode._minvalue=a,e.updateItem(),e.updateSpanCheck&&e.updateSpanCheck()},Fd=$ce("span",Dd,Bd),Fd.style.marginLeft="20px",Gd=control_text("3"),Gd.title=H?"用户可以选择的最大显示行数":"用户可以选择的最大值",Gd.maxLength=3,"301"==this.dataNode._tag?(Ed.maxLength=Gd.maxLength=12,Fd.style.marginLeft="10px",Ed.style.width="16px",Gd.style.width="25px"):"202"==this.dataNode._tag&&(Ed.style.width="16px",Gd.style.width="25px"),Gd.value=this.dataNode._maxvalue,Bd.appendChild(Gd),"301"==this.dataNode._tag&&(5!=newQType&&$ce("span","&nbsp;&nbsp;",Bd),Hd=control_check(),Bd.appendChild(Hd),Hd.id="cdt_"+this.dataNode._topic+"_"+RndNum(10),Hd.className="checkbox",5!=newQType&&$ce("label","允许小数",Bd).setAttribute("for",Hd.id),Hd.checked=1==this.dataNode._digitType,Hd.onclick=function(){e.dataNode._digitType=this.checked?1:0},5==newQType&&(Hd.style.display="none")),Bd.style.display="202"==this.dataNode._tag||"301"==this.dataNode._tag||H?"":"none",Gd.onchange=Gd.onblur=function(){var b,a=this.value;H?(isEmpty(this.value)?(show_status_tip("最大显示行数不能为空",4e3),a=5):(!isInt(this.value)||this.value-Ed.value<=0||this.value>100)&&(this.value>100?(show_status_tip("用户可以选择的最大显示行数不能超过100行",4e3),a=15):(show_status_tip("最大值不合法",4e3),a=10-Ed.value>5?5:toInt(Ed.value)+1,parseInt(a)!=a&&(a=5))),this.value=e.dataNode._maxvalue=a,b=e.checkRowTitle(a),k?e.createSum():r&&b&&(e.updateItem(),e.refreshSelRow&&e.refreshSelRow())):(isEmpty(this.value)&&"202"!=e.dataNode._tag||(!isInt(this.value)||this.value-Ed.value<0?(show_status_tip("最大值不合法",4e3),a=10-Ed.value>0?10:toInt(Ed.value)+1,parseInt(a)!=a&&(a=10)):a=toInt(this.value)),this.value=e.dataNode._maxvalue=a,e.updateItem(),e.updateSpanCheck&&e.updateSpanCheck())},xd.appendChild(Bd),isCepingQ||("201"==h||"302"==h)&&(Id="设置行属性","302"==h&&(Id="设置列属性"),eb=$ce("span","<a onclick='cur.setMRowAttr();return false;' href='javascript:' class='sumitbutton cancle'>"+Id+"</a>",xd),this.setMRowAttr=function(){PDF_launch("/wjx/design/setrowattr.aspx?ct="+this.dataNode._topic,700,370,function(){cur.updateItem()},Id)},eb.style.marginLeft="20px")),s&&(Jd="",H||(Jd="&nbsp;&nbsp;<a href='javascript:;' class='link-U666' onclick='cur.changeRowColumnTitle();return false;'>交换行列</a>"),Kd=$ce("span",Jd,yd),Kd.onmouseover=function(){toolTipLayerTop.style.width="180px",toolTipLayerTop.innerHTML="交换行标题与列标题的位置",sb_setmenunav(toolTipLayerTop,!0,this)},Kd.onmouseout=function(){sb_setmenunav(toolTipLayerTop,!1)},this.changeRowColumnTitle=function(){if(isMergeAnswer&&!this.isMergeNewAdded)return show_status_tip("在部分修改问卷模式下，不能“交换行列”",5e3),!1;var a=this;layer.confirm("确定交换行标题与列标题的位置吗？",function(b){var c=a.dataNode._rowtitle;a.dataNode._rowtitle=a.dataNode._columntitle,a.dataNode._columntitle=c,pd.value=a.dataNode._rowtitle,wd.value=cur.dataNode._columntitle,a.updateItem(),layer.close(b)})})),w){if($ce("div","",Vb).style.paddingTop="10px",Ld=document.createElement("div"),Ld.style.margin="12px 0 5px",(C||E)&&(Ld.style.display="none"),Md=$ce("div","",Ld),"radio"==g||"check"==g?v?bd.style.width="100%":h?bd.style.width="100%":B?bd.style.width="100%":C?bd.style.width="100%":E?bd.style.width="100%":F&&(bd.style.width="radio"==g?"100%":"100%"):"matrix"==g&&(("201"==h||"202"==h||"301"==h||"302"==h)&&(bd.style.width="400px"),("301"==h||"302"==h)&&(bd.style.width="500px")),this.setNotNewAdd=function(){e.newAddQ&&(Wf.style.display="",e.newAddQ=!1,Nd.style.display="")},this.addNewItem=function(){var b,a=K.length;K[a-1].get_item_add().onclick(),b=K[a-1].get_item_table().parentNode,b.scrollTop=b.scrollHeight},Nd=$ce("div","",bd),Nd.style.textAlign="center",Nd.className="selScrrol",G||(Od=$ce("div","",Nd),Od.className="choise_bg"),Pd=document.createElement("table"),Pd.className="tableoption",Pd.cellSpacing="0",Pd.cellPadding="0",Pd.width="98%",Qd=Pd.insertRow(-1),K[0]=Qd,Rd=!(f._tag||F||"check"!=f._type&&"radio"!=f._type&&"radio_down"!=f._type),Sd=Qd.insertCell(-1),Td=GetItemTitleWidth(this.dataNode),Sd.style.width=Td+"px",Ud=$ce("span","",Sd),E?Ud.innerHTML="商品名称":(Vd=$ce("a","选项文字<i class='design-icon design-ctext'>",Ud),Vd.title="交换选项文字",Vd.style.color="#222",Vd.style.marginLeft="7px",Vd.style.textDecoration="none",Vd.href="javascript:;",Vd.onclick=function(){var b,c,d,e;if(isMergeAnswer&&!cur.isMergeNewAdded)return show_status_tip("提示：在部分修改问卷模式下，不允许交换选项文字",4e3),!1;if(b=!1,(p||G||F||303==h)&&(b=!0),c=1,d=K.length-1,b)return layer.confirm("是否同时交换选项分数?",{title:"提示"},function(a){for(;d>c;){var b=K[d].get_item_title().value;K[d].get_item_title().value=K[c].get_item_title().value,K[c].get_item_title().value=b,b=K[d].get_item_value().value,K[d].get_item_value().value=K[c].get_item_value().value,K[c].get_item_value().value=b,K[d].get_item_novalue()&&(b=K[d].get_item_novalue().checked,K[d].get_item_novalue().checked=K[c].get_item_novalue().checked,K[c].get_item_novalue().checked=b),c++,d--}cur.updateItem(),layer.close(a)},function(a){for(;d>c;){var b=K[d].get_item_title().value;K[d].get_item_title().value=K[c].get_item_title().value,K[c].get_item_title().value=b,c++,d--}cur.updateItem(),layer.close(a)}),!1;for(;d>c;)e=K[d].get_item_title().value,K[d].get_item_title().value=K[c].get_item_title().value,K[c].get_item_title().value=e,c++,d--;return cur.updateItem(),!1}),(F||Rd&&"radio_down"!=f._type&&!C||v)&&(Wd=Qd.insertCell(-1),Xd="图片",imgwidth="30px",E&&(Xd="商品图片",imgwidth="60px"),Yd=$ce("span",Xd,Wd),Wd.style.width=imgwidth,Wd.align="center",E||A||(e.setDisplayTxt=function(a){this.dataNode._hideTxt=a.checked,this.updateItem()},e.showImgTxt=function(){var c,a=!1,b=this.dataNode._select;for(c=1;c<b.length;c++)b[c]._item_img&&(a=!0);Yd.style.borderBottom=a?"1px solid #8c8c8c":"",a&&(Yd.onmouseover=function(){var a,b;toolTipLayerMenu.style.width="120px",a="",cur.dataNode._hideTxt&&(a=' checked="checked" '),toolTipLayerMenu.innerHTML='<div style="height:24px;line-height:24px;"><input type="checkbox"'+a+'" tabindex="-1" onclick="cur.setDisplayTxt(this);" />隐藏选项文字</div>',b=this,this.hasOut=!1,setTimeout(function(){b.hasOut||sb_setmenunav(toolTipLayerMenu,!0,b)},200)},Yd.onmouseout=function(){this.hasOut=!0,sb_setmenunav(toolTipLayerMenu,!1,this)})},e.showImgTxt())),(F||Rd&&"radio_down"!=f._type&&!E)&&(Zd=Qd.insertCell(-1),$d="说明",_d="50px",C&&($d="情景说明",_d="60px"),ae=$ce("div",$d,Zd),Zd.style.width=_d,ae.style.overflow="hidden",ae.style.textAlign="center"),(Rd&&"radio_down"!=f._type||r&&("102"==h||"103"==h||"101"==h||101>h)||F||v)&&(be=Qd.insertCell(-1),be.style.letterSpacing="1px",$ce("span","允许填空",be),be.style.width="70px",be.align="center",(B||C||E)&&(be.style.display="none")),de=Qd.insertCell(-1),B||s||C||(de.style.width="110px"),E&&(de.style.width="60px"),C&&(de.style.width="110px"),ee=$ce("span","",de),fe=control_check(),fe.title="给选项设置分数，可用于Likert量表或者测试类型的问卷",ee.appendChild(fe),ge=$ce("span","",ee),ge.innerHTML="&nbsp;分数<span class='bordCss bordBottomCss' style='border-color:#333 transparent transparent;'></span>",ge.style.cursor="pointer",C?ge.innerHTML="数量限制":E&&(ge.innerHTML="商品价格"),p||G||F||303==h?(fe.style.display="none",ee.onmouseover=function(){openValWindow(e,this)},ee.onmouseout=function(){sb_setmenunav(toolTipLayer,!1)}):C||E?fe.style.display="none":de.style.display="none",fe.onclick=function(){var a;if(!e.dataNode._isCeShi){if(this.checked)for(a=1;a<K.length;a++)K[a].get_item_value().parentNode.style.display="";else for(a=1;a<K.length;a++)K[a].get_item_value().parentNode.style.display="none";e.dataNode._hasvalue=this.checked}},E&&(he=Qd.insertCell(-1),he.innerHTML="总库存",he.style.width="50px"),"check"!=g||B||v||F||E||(ie=Qd.insertCell(-1),ie.style.width="45px",ie.align="center",je=$ce("span","&nbsp;",ie),ke=$ce("span","互斥",je),ke.title="与其它选项互斥",je.appendChild(ke)),le=Qd.insertCell(-1),!Rd||C||E?le.style.display="none":(me=$ce("span","",le),le.style.width="30px",ne=$ce("span","",me),ne.innerHTML="默认",B&&(le.style.width="60px",ne.innerHTML="正确答案",le.align="center"),this.defaultCheckSet=function(){this.dataNode._isCeShi}),oe=Qd.insertCell(-1),oe.align="left",pe="上移下移",r&&(pe="移动"),$ce("span",pe,oe),n)for(qe=1;qe<f._select.length;qe++)K[qe]=new creat_item(e,qe,Pd,"check",!1,f._select[qe]);else for(qe=1;qe<f._select.length;qe++)K[qe]=new creat_item(e,qe,Pd,"radio",!1,f._select[qe]);for(this.checkItemTitle=function(){return this.popHint(""),this.checkEmptyItem()?this.checkRepeatItem()?(this.isItemTitleValid=!0,!0):!1:!1},this.checkEmptyItem=function(){var b,c,a=!0;for(b=1;b<K.length;b++)c=K[b].get_item_title(),""==trim(c.value)&&(c.initText?c.value=c.initText:(this.popHint("选项不能为空！"),a=!1,this.isItemTitleValid=!1));return a},this.checkRepeatItem=function(){var b,c,d,e,a=!0;for(b=1;b<K.length;b++)for(c=K[b].get_item_title(),c.style.border="1px solid #cdcdcd",d=b+1;d<K.length;d++)if(trim(K[b].get_item_title().value)==trim(K[d].get_item_title().value))return e=K[d].get_item_title(),c.rel=e,e.rel=c,K[b].get_item_title().style.border="1px solid red",K[d].get_item_title().style.border="1px solid red",this.popHint("第"+b+"个选项与第"+d+"个选项重复，请修改！"),a=!1,this.isItemTitleValid=!1,!1;return a},this.checkItemValue=function(){var b,c,a=!0;if(fe.checked)for(b=1;b<K.length;b++)c=trim(K[b].get_item_value().value),""==c?K[b].get_item_novalue()&&K[b].get_item_novalue().checked||(K[b].get_item_value().value=0):parseFloat(c)!=c&&(this.popHint("选项的分数不合法，请修改！"),a=!1);return this.isItemValueValid=a,a},this.checkCeShiSet=function(){var a,b;if(!this.dataNode._isCeShi)return!0;for(a=!1,b=1;b<f._select.length;b++)f._select[b]._item_radio&&(a=!0);return a||this.popHint("请设置此题的正确答案"),this.isCeShiValid=a,a},ob=0;ob<Qd.cells.length;ob++)Qd.cells[ob].style.padding="3px 5px";if(oe.style.paddingLeft="15px",Nd.appendChild(Pd),Vb.appendChild(bd),$ce("div","",Vb).className="divclear",re=$ce("span","",Md),Md.style.width="100%",B&&D&&(Md.style.display="none"),re.className="spanLeft",re.style.lineHeight="28px",re.style.height="28px",re.style.margin="0 0 0 4px",re.style.textAlign="left",se=GetItemTitleWidth(this.dataNode),r&&("303"==h?se+=20:"102"==h&&(se-=20)),re.style.width=se+"px",te="<a href='javascript:' onclick='cur.addNewItem();return false;' class='link-U00a6e6' style='text-decoration:none;'><span class='choiceimg design-icon design-singleadd' ></span><span style='color: #1ea0fa;'>添加选项</span></a>&nbsp;&nbsp;",ue="12px",r&&this.dataNode._tag&&this.dataNode._tag<=101&&(ue="0px"),ve="<a href='javascript:' onclick='PDF_launch(\"oftenoptions.aspx\",540,400,null,\"批量添加选项\");return false;' class='batchadd' title='批量添加选项' style='margin-left:"+ue+"'><span class='choiceimg design-icon design-badd'></span><span style='color: #1ea0fa;'>批量增加</span></a>&nbsp;",we="/wjx/design/batchupload.aspx?activity="+activityID,2==window.uploadQiuniu&&(we="/wjx/design/batchuploadali.aspx?activity="+activityID),xe="<a href='javascript:' onclick='PDF_launch(\""+we+"\",540,250,null,\"批量添加图片\");return false;' class='link-444' style='margin-left:12px;'><span class='choiceimg design-icon design-img' style='margin:0 5px 1px 0;'></span>批量添加图片</a>",ye=te+ve,A&&(ye+=xe),re.innerHTML=ye,p?re.innerHTML=te+ve:r&&this.dataNode._tag&&this.dataNode._tag<=101&&(re.innerHTML=ve),isMergeAnswer&&!this.isMergeNewAdded&&(re.innerHTML=te),ze=$ce("span","",Md),ze.className="spanLeft",(p||r)&&(!isMergeAnswer||this.isMergeNewAdded)){for(Ae=document.createElement("span"),Be="5px",r&&(Be="30px"),Ce="<select onchange='cur.set_likert_num(this);' style='float:left;margin-left:"+Be+";'>",De=f._select.length-1,ob=2;11>=ob;ob++)Ee="",ob==De&&(Ee=" selected='selected' "),Fe=ob+"级量表",11==ob&&(Fe="NPS量表"),Ce+="<option"+Ee+" value='"+ob+"'>"+Fe+"</option>";Ce+="</select>",Ae.innerHTML+=Ce,this.set_likert_num=function(a){var f,g,h,b=a.value,c=K.length-1,d="11"==b,e=1;for(d&&(e=0),f=0;b>f;f++)K[c+f].get_item_add().onclick(),K[c+f+1].get_item_title().value=f+e,K[c+f+1].get_item_value().value=f+e;for(isAutoDelete=!0,f=1;c+1>f;f++)K[1].get_item_del().onclick();isAutoDelete=!1,G||(g="非常不满意",h="非常满意",d&&(g="不可能",h="极有可能"),K[1].get_item_title().value=g,K[K.length-1].get_item_title().value=h),K[1].get_item_title().onchange(),d&&(this.dataNode._tag="6",this.createTableRadio(!0)),this.popHint(""),window.focus()},ze.appendChild(Ae),r&&this.dataNode._tag>101&&(Ae.style.display="none")}if((G||p)&&(Ge=document.createElement("span"),ze.appendChild(Ge),He="<ul class='likertImageTypeList' style='display:inline;margin:0;' ><li>&nbsp;&nbsp;<b>样式：</b></li>",He+=r?"<li class='design-icon design-offr' onclick='cur.set_likertMode(this);' mode='101' style='background:url(/images/radio.gif) no-repeat;height:16px;width:18px;'></li>":"<li style='font-size:16px;' mode='1' onclick='cur.set_likertMode(this);return false;'><a style='height:24px;line-height:24px;' href='javascript:'><b>123</b></a></li> <li class='design-icon design-offr' style='background:url(/images/radio.gif) no-repeat;height:16px;width:18px;' mode='101' onclick='cur.set_likertMode(this);'></li>",He+="<li class='off2' onclick='cur.set_likertMode(this);' mode='2' style='margin-top:-3px;'></li>",He+="<li  class='off3' onclick='cur.set_likertMode(this);' mode='3' style='margin-top:-3px;'></li>",He+="<li  class='off4' onclick='cur.set_likertMode(this);' mode=4' style='margin-top:-3px;'></li>",He+="<li class='design-icon design-off6' onclick='cur.set_likertMode(this);' mode='6' style='margin-top:-3px;'></li>",He+="<li style='clear:both;'></li>",He+="</ul>",Ge.innerHTML=He,this.set_likertStyle=function(a){var d,e,b=null,c=Ge.getElementsByTagName("li");for(d=0;d<c.length;d++)e=c[d].getAttribute("mode"),e==a&&(b=c[d]),6==e?c[d].className="design-icon design-off6":101==e?c[d].style.backgroundPosition="0 0px":c[d].className="off"+e;b&&(6==a?b.className="design-icon design-off6 design-on6":101==a?b.style.backgroundPosition="0 -16px":b.className="on"+a)},this.dataNode._tag&&"0"!=this.dataNode._tag&&this.set_likertStyle(this.dataNode._tag),this.set_likertMode=function(a){var c,d,e,f,g,h,b=a.getAttribute("mode");if(_modeType=parseInt(b),c=this.dataNode._tag<102,d=this.dataNode._tag,this.dataNode._tag=_modeType,this.createTableRadio(!0),this.set_likertStyle(this.dataNode._tag),"matrix"==this.dataNode._type){if(Ld.style.display=_modeType>200?"none":"",Nd.style.display=Ld.style.display,c&&_modeType>101?(fe.disabled=!1,fe.checked=!1,fe.onclick(),this.dataNode._hasvalue=!1):!c&&102>_modeType&&(fe.checked=!0,fe.onclick(),fe.disabled=!0,this.dataNode._hasvalue=!0),e=!1,101==d&&101>_modeType)for(f=this.option_radio,g=1;g<f.length;g++)h=f[g].get_item_tb(),h.checked&&(h.checked=!1,h.onclick(),h.checked=!1,e=!0);e&&show_status_tip("提示：图标样式的量表不支持填空属性，已经取消设置！",4e3),fe.disabled=_modeType>101?!1:!0,202==_modeType?(Bd.style.display="",this.dataNode._minvalue=this.dataNode._minvalue||0,this.dataNode._maxvalue=this.dataNode._maxvalue||10,this.dataNode._rowwidth=this.dataNode._rowwidth||100,rowwidth_text.value=rowwidth_text.value||100):Bd.style.display="none"}},isMergeAnswer&&!this.isMergeNewAdded&&this.dataNode._tag>101&&(Ge.style.display="none")),Rd&&"radio_down"!=f._type&&(Ie=$ce("span","&nbsp;&nbsp;&nbsp;&nbsp;",ze),(B||C||E)&&(Ie.style.display="none"),Je=$ce("a","分组设置",Ie),Je.href="javascript:;",Je.onclick=function(){if(!vipUser)return alertNew('提示：只有企业版用户才能插入分组，请<a href="/register/upgradevip.aspx?upgradeReason=52" target="_blank">升级</a>'),!1;if(e.dataNode._randomChoice)return alertNew("不能同时设置分组和选项随机！"),!1;var a="/wjx/design/setlabel.aspx?ct="+e.dataNode._topic;return PDF_launch(a,580,400,Ke,"分组设置"),!1
},e.displayGroup=function(){Je.innerHTML="分组设置",Je.className="link-new";for(var a=1;a<this.dataNode._select.length;a++)if(this.dataNode._select[a]._item_label)return Je.innerHTML="编辑分组",Je.className="link-set",void 0},e.displayGroup(),Je.onmouseover=function(){toolTipLayerMenu.style.width="250px",toolTipLayerMenu.innerHTML="在选项较多的情况下，通过对选项进行分组，可以更方便用户选择&nbsp;&nbsp;<a target='_blank' class='link-U00a6e6' href='/help/help.aspx?helpid=149&h=1'>查看帮助</a>";var a=this;this.hasOut=!1,setTimeout(function(){a.hasOut||sb_setmenunav(toolTipLayerMenu,!0,a)},200)},Je.onmouseout=function(){this.hasOut=!0,sb_setmenunav(toolTipLayerMenu,!1,this)}),n&&!B||r&&"102"==h){for(Le=null,Le=$ce("span","",ze),Me=document.createElement("span"),Ne="<select onchange='cur.limitChange(this);' onclick='cur.lowLimitClick(this);' style='width:86px;margin:0 15px;'>",Ne+="<option value=''>至少选几项</option>",ob=1;ob<f._select.length;ob++)Ne+="<option value='"+ob+"'>至少选"+ob+"项</option>";for(Ne+="</select>",Me.innerHTML=Ne,Oe=document.createElement("span"),Pe="<select onchange='cur.limitChange(this);' onclick='cur.upLimitClick(this);' style='width:86px;'>",Pe+="<option value=''>最多选几项</option>",ob=2;ob<f._select.length;ob++)Pe+="<option value='"+ob+"'>最多选"+ob+"项</option>";Pe+="</select>",Oe.innerHTML=Pe,Le.appendChild(Me),Le.appendChild(Oe),this.limitChange=function(){e.checkCheckLimit(),window.focus()},this.lowLimitClick=function(a){var b,c;if(f._select.length-1!=a.options.length-1)for(a.options.length=0,a.options.add(new Option("至少选几项","")),b=1;b<f._select.length;b++)c=new Option("至少选"+b+"项",b),a.options.add(c)},this.upLimitClick=function(a){var b,c;if(f._select.length-1!=a.options.length)for(a.options.length=0,a.options.add(new Option("最多选几项","")),b=2;b<f._select.length;b++)c=new Option("最多选"+b+"项",b),a.options.add(c)},Qe=f._lowLimit,Re=f._upLimit,v&&(f._lowLimit||(Qe=f._lowLimit=f._select.length-1),f._upLimit||(Re=f._upLimit=f._select.length-1),-1==f._lowLimit&&(Qe=""),-1==f._upLimit&&(Re="")),$$("select",Me)[0].value=Qe||"",$$("select",Oe)[0].value=Re||"",this.checkCheckLimit=function(){var a,b;return(n||r&&"102"==h)&&(a=$$("select",Me)[0].value,b=$$("select",Oe)[0].value,K.length-1,""!=a?(""!=b&&0>b-a&&(a=b,$$("select",Me)[0].value=b,show_status_tip("要求用户最多选中选项数量不合法！",4e3)),tb.checked||show_status_tip("由于设置了选项数量限制，建议将该题设为必答",4e3)):v&&(a=-1),""!=b?""!=a&&0>b-a&&(b=a,$$("select",Oe)[0].value=a,show_status_tip("要求用户最多选中选项数量不合法！",4e3)):v&&(b=-1),this.dataNode._lowLimit=a,this.dataNode._upLimit=b,this.updateSpanCheck()),!0}}if(Se=$ce("span","",ze),"check"==g&&B&&(Te="不得分",this.dataNode._partScore&&(Te="得部分分"),Ue=$ce("span","少选得分规则:<a onclick='cur.setScoreRule(this);return false;' class='link-U00a6e6' href='javascript:'>"+Te+"</a>",Se),this.setScoreRule=function(a){PDF_launch("/wjx/design/scoreRule.aspx?ct="+e.dataNode._topic+"&t="+(new Date).valueOf(),600,466,function(){a.innerHTML=cur.dataNode._partScore?"得部分分":"不得分"})},this.scoreRule=Ue,this.setScoreTxt=function(){var b,a=0;for(b=1;b<this.dataNode._select.length;b++)this.dataNode._select[b]._item_radio&&a++;Ue.style.display=a>=2?"":"none",2>a&&(this.dataNode._partScore=!1,Ue.getElementsByTagName("a")[0].innerHTML="不得分")},this.setScoreTxt(),Ue.style.marginLeft="15px"),Ve="<select onchange='cur.setRandom(this);' style='width:90px;margin-left:15px;'><option value='0'>选项不随机</option><option value='1'>选项随机</option></select>",$ce("span",Ve,Se),We=$$("select",Se)[0],B&&(Xe=$ce("span","<a class='copy-tit' onclick='setAllRandom();return false;' href='javascript:'></a>&nbsp;",Se),Xe.onmouseover=function(){toolTipLayerMenu.style.width="230px",toolTipLayerMenu.innerHTML="复制此题选项随机设置到后面的题目",sb_setmenunav(toolTipLayerMenu,!0,this)},Xe.onmouseout=function(){sb_setmenunav(toolTipLayerMenu,!1,this)},Xe.style.display="none",this.get_random=function(){return We}),this.setRandom=function(a){for(var b=1;b<e.dataNode._select.length;b++)if(e.dataNode._select[b]._item_label)return alertNew("不能同时设置分组和选项随机！"),a.value="0",!1;e.dataNode._randomChoice="1"==a.value,B&&(Xe.style.display="")},(p||r)&&(Se.style.display="none"),Ye=$ce("span","",ze),o&&0==h||n&&!v){if(Ze=null,$e=document.createElement("span"),_e="",af=1,!o||F||B||A||(_e="<option value='0'>下拉菜单</option>",af=2),bf="<select onchange='cur.checkNumPer(this);' style='width:90px; margin-left:15px'><option value='1'>竖向排列</option>"+_e,bf+=A?"<option value='2'>横向排列</option>":"<optgroup label='横向排列'><option value='2'>2</option><option value='3'>3</option><option value='4'>4</option><option value='5'>5</option><option value='6'>6</option><option value='7'>7</option><option value='8'>8</option><option value='9'>9</option><option value='10'>10</option><option value='11'>11</option><option value='12'>12</option><option value='15'>15</option><option value='20'>20</option><option value='30'>30</option></optgroup>",bf+="</select>",$e.innerHTML=bf,Ze=$$("select",$e)[0],!A)for(ob=af;ob<Ze.options.length;ob++)Ze.options[ob].text="每行"+Ze.options[ob].value+"列";Ye.appendChild($e),v&&Ze&&($e.style.display="none"),this.checkNumPer=function(a){var c,d,f,g,b=trim(a.value);if(0==b)return this.selChangeType("radio_down"),void 0;if(A&&"1"==b){for(c=!1,d=1;d<this.dataNode._select.length;d++)if(f=this.dataNode._select[d]._item_img){c=!0;break}c&&(b="-1")}this.dataNode._numperrow=parseInt(b),this.createTableRadio(!0),this.focus(),this.applyNumber||A||(g=$ce("span","<a href='javascript:;' class='copy-tit' title='批量复制此属性到后面的题目' style='font-size:14px;'></a>",Ye),g.onclick=function(){var a="/wjx/design/applynumrow.aspx",b=e.dataNode._topic;return a+="?ct="+b,PDF_launch(a,500,250),!1},this.applyNumber=!0)},$e.style.display="inline-block"}A&&(cf=$ce("div","",Ld),cf.style.marginTop="10px",df=$ce("span","&nbsp;",cf),df.className="spanLeft",df.style.lineHeight="28px",ef=control_check(),ff=$ce("span","",df),ff.style.margin="0 30px 0 0",ff.appendChild(ef),ff.appendChild(document.createTextNode("显示投票数")),gf=control_check(),hf=$ce("span","",df),hf.style.margin="0 30px 0 0",hf.appendChild(gf),hf.appendChild(document.createTextNode("显示百分比")),ef.checked=ef.defaultChecked=f._displayNum,gf.checked=gf.defaultChecked=f._displayPercent,gf.onclick=function(){e.dataNode._displayPercent=this.checked,e.createTableRadio(!0)},ef.onclick=function(){e.dataNode._displayNum=this.checked,e.createTableRadio(!0)},jf=$ce("span","选项宽度：",cf),e.setchoiceWidth=function(){var b,c,a=!1;for(b=1;b<e.dataNode._select.length;b++)if(c=e.dataNode._select[b]._item_img){a=!0;break}jf.style.display=a?"none":"",$e&&a&&"1"==this.dataNode._numperrow&&(this.dataNode._numperrow="2",$e.getElementsByTagName("select")[0].value="2")},e.setchoiceWidth(),jf.style.marginLeft="8px",jf.className="spanLeft",kf="<select onchange='cur.setTWidth(this);'><option value='20'>20%</option><option value='30'>30%</option><option value='40'>40%</option><option value='50'>50%</option><option value='60'>60%</option><option value='70'>70%</option><option value='自定义'>自定义</option></select>&nbsp;",jf.innerHTML+=kf,lf=$ce("span","",jf),mf=control_text("3"),mf.maxLength=2,mf.onchange=mf.onblur=function(){var a=this.value;isEmpty(a)||isInt(a)?e.dataNode._touPiaoWidth=a?parseInt(a):"":(show_status_tip("您输入的宽度不合法！"),this.value="",e.dataNode._touPiaoWidth=50),e.createTableRadio(!0)},this.setTWidth=function(a){"自定义"!=a.value?(mf.value=a.value,lf.style.display="none",mf.onchange()):lf.style.display=""},this.initWidth=function(){var a,b,c;if(this.dataNode._touPiaoWidth){for(mf.value=this.dataNode._touPiaoWidth,a=$$("select",jf)[0],a.value=this.dataNode._touPiaoWidth,b=!0,c=0;c<a.options.length;c++)if(a.options[c].value==this.dataNode._touPiaoWidth){b=!1;break}b&&(a.value="自定义",this.setTWidth(a))}},lf.appendChild(mf),lf.appendChild(document.createTextNode("%")),lf.style.display="none",cf.appendChild(jf),cf.style.overflow="hidden",$ce("span","&nbsp;&nbsp;&nbsp;&nbsp;<a href='/help/help.aspx?helpid=344&h=1' target='_blank' class='link-U666'style='line-height: 28px;'>如何添加视频或站外链接?</a>",cf).className="spanRight",this.initWidth()),$ce("div","",Md).className="divclear",r?Nd.appendChild(Ld):Vb.appendChild(Ld),this.initFreOptions=function(a){var e,f,b="",c=/^选项\d+$/,d=0;for(e=1;e<K.length;e++)f=trim(K[e].get_item_title().value),f&&(c.test(f)||(d>0&&(b+="\n"),b+=f,d++));b&&(a.value=b+"\n")},this.setFreOptions=function(a){var c,d,e,f,b=a.split("\n");if("每行一个选项，可以添加多个选项"!=a){for(c=new Array,d=0;d<b.length;d++)b[d]&&trim(b[d])&&c.push(b[d]);for(d=c.length;2>d;d++)c[d]="选项"+(d+1);for(e=0;e<c.length;e++)K[e+1]?K[e+1].get_item_title().value=trim(c[e]):(K[e+1]=n?new creat_item(this,e+1,Pd,"check",!1,null):new creat_item(this,e+1,Pd,"radio",!1,null),K[e+1].get_item_title().value=trim(c[e]),K[e+1].get_item_value().value=e+1);for(f=K.length-1,e=f;e>c.length;e--)Pd.deleteRow(e),K.length=K.length-1;this.updateItem(),this.setNotNewAdd(),setQTopPos(this)}},this.checkTextJump=function(a){var b,c;!o&&!q||e.dataNode._hasjump||hasInsPromoteJump||(b=/[一二三四五六七八九\d]+题/,c=b.exec(a),c&&a.indexOf("跳")>-1&&(hasInsPromoteJump=!0,layer.confirm("您是否需要设置此题的跳题逻辑?",{title:"提示"},function(a){Kf.onclick(),layer.close(a)})))},this.updateReferQ=function(){var a,b,c;if(this._referedArray)for(a=0;a<this._referedArray.length;a++)b=this._referedArray[a],c=b.dataNode,"matrix"==c._type?b.createTableRadio(!0):"sum"==c._type&&b.createSum()},this.updateItem=function(a){var c,d,e,f,g,h,i,j,k,l,m,b=!0;if("matrix"!=this.dataNode._type&&this.popHint(""),this.checkItemTitle()||(b=!1),this.checkItemValue()||(b=!1),"matrix"!=this.dataNode._type||this.checkRowTitle()||(b=!1),b){if(c=this.dataNode,d="matrix"==c._type&&("101"==c._tag||"2"==c._tag||"3"==c._tag||"6"==c._tag)&&c._reverseScoringRowtitle&&5!=newQType)for(e=trim(c._reverseScoringRowtitle).split("\n"),f=c._rowtitle.split("\n"),c._reverseScoringRowtitle="",g=0;g<f.length;g++)c._reverseScoringRowtitle+=e[g]&&-1!=e[g].indexOf("|1")?trim(f[g])+"|1\n":trim(f[g])+"\n";for(h=c._select,c._select=new Array,i=!c._tag&&("check"==c._type||"radio"==c._type||"radio_down"==c._type),j=1;j<K.length;j++)c._select[j]=new Object,k=K[j].get_item_title(),l=replace_specialChar(trim(k.value)),l!=k.value&&(k.value=l),c._select[j]._item_title=k.value.replace(/\</g,"&lt;"),c._select[j]._item_radio=!1,(i||c._isCeShi)&&(c._select[j]._item_radio=K[j].get_item_check().checked),c._select[j]._item_value=trim(K[j].get_item_value().value),c._select[j]._item_jump="",h&&h[j]&&(c._select[j]._item_jump=h[j]._item_jump||""),c._select[j]._item_relation="",h&&h[j]&&(c._select[j]._item_relation=h[j]._item_relation||""),K[j].get_item_huchi()&&(c._select[j]._item_huchi=K[j].get_item_huchi().checked),c._select[j]._item_tb=!1,c._select[j]._item_tbr=!1,c._select[j]._item_img="",c._select[j]._item_imgtext=!1,c._select[j]._item_desc="",c._select[j]._item_label="","matrix"==c._type&&h&&h[j]&&(c._select[j]._item_max=h[j]._item_max||""),K[j].get_item_tb()&&(c._select[j]._item_tb=K[j].get_item_tb().checked),K[j].get_item_tbr()&&(c._select[j]._item_tbr=K[j].get_item_tbr().checked),K[j].get_item_img()&&(c._select[j]._item_img=K[j].get_item_img().value=replace_specialChar(trim(K[j].get_item_img().value))),c._select[j]._item_img&&(c._select[j]._item_imgtext=!c._hideTxt),K[j].get_item_desc()&&(c._select[j]._item_desc=K[j].get_item_desc().value=replace_specialChar(trim(K[j].get_item_desc().value))),h&&h[j]&&(c._select[j]._item_label=replace_specialChar(h[j]._item_label||"")),("301"==c._tag||"303"==c._tag)&&(m=1e4*parseInt(c._topic)+parseInt(j),c._select[j]._categoryid=QuesidtoCategoryId[m]?QuesidtoCategoryId[m]:"-1");this.checkCeShiSet()&&("matrix"==this.dataNode._type&&this.syncRowHeight(),a||this.createTableRadio(!0))}}}(r||k)&&(nf=$ce("div","",Vb),nf.style.marginTop="8px",(H||5==newQType)&&(nf.style.display="none"),r&&(of=$ce("span","",nf),kf="<select onchange='cur.setMainWidth(this);'><option value=''>题目总宽度</option><option value='50'>宽度50%</option><option value='60'>宽度60%</option><option value='70'>宽度70%</option><option value='80'>宽度80%</option><option value='90'>宽度90%</option><option value='100'>宽度100%</option><option value='自定义'>宽度自定义</option></select>&nbsp;",of.innerHTML+=kf,pf=$ce("span","",of),qf=control_text("3"),qf.maxLength=2,qf.onchange=qf.onblur=function(){var a=this.value;isEmpty(a)||isInt(a)?e.dataNode._mainWidth=a?parseInt(a):"":(show_status_tip("您输入的宽度不合法！"),this.value="",e.dataNode._mainWidth=50),e.createTableRadio(!0)},this.setMainWidth=function(a){"自定义"!=a.value?(qf.value=a.value,pf.style.display="none",qf.onchange()):pf.style.display=""},this.initMainWidth=function(){var a,b,c;if(this.dataNode._mainWidth){for(qf.value=this.dataNode._mainWidth,a=$$("select",of)[0],a.value=this.dataNode._mainWidth,b=!0,c=0;c<a.options.length;c++)if(a.options[c].value==this.dataNode._mainWidth){b=!1;break}b&&(a.value="自定义",this.setMainWidth(a))}},pf.appendChild(qf),pf.appendChild(document.createTextNode("%")),pf.style.display="none","102"==h&&(of.style.display="none")),rf="行标题宽度",k&&(rf="行标题宽度"),sf=$ce("span","&nbsp;",nf),Xc="<select onchange='cur.setTWidth(this);'><option value=''>"+rf+"</option><option value='10%'>宽度10%</option><option value='15%'>宽度15%</option><option value='20%'>宽度20%</option><option value='30%'>宽度30%</option><option value='40%'>宽度40%</option><option value='50%'>宽度50%</option><option value='自定义'>宽度自定义</option></select>&nbsp;",sf.innerHTML+=Xc,Yc=control_text("3"),Yc.maxLength=3,Yc.onchange=Yc.onblur=function(){var a=this.value;isEmpty(a)||isInt(a)&&!(a-100>0)?(e.dataNode._rowwidth=a+"%","%"==e.dataNode._rowwidth&&(e.dataNode._rowwidth="")):(show_status_tip("您输入的宽度不合法！"),this.value="",e.dataNode._rowwidth=""),k?e.createSum():r&&e.updateItem(),window.focus()},this.setTWidth=function(a){"自定义"!=a.value?(Yc.value=a.value.replace("%",""),Yc.style.display="none",Yc.onchange()):Yc.style.display=""},this.initWidth=function(){if(this.dataNode._rowwidth&&this.dataNode._rowwidth.indexOf("%")>-1){var a=$$("select",sf)[0];a.value=this.dataNode._rowwidth,Yc.value=this.dataNode._rowwidth.replace("%",""),-1==a.selectedIndex&&(a.value="自定义",this.setTWidth(a))}},Yc.style.display="none",sf.appendChild(Yc),r&&(tf=$ce("span","&nbsp;",nf),tf.style.display="none",uf="<select onchange='cur.setTWidth2(this);'><option value=''>右行标题宽度</option><option value='10%'>宽度10%</option><option value='15%'>宽度15%</option><option value='20%'>宽度20%</option><option value='30%'>宽度30%</option><option value='40%'>宽度40%</option><option value='50%'>宽度50%</option><option value='自定义'>宽度自定义</option></select>&nbsp;",tf.innerHTML+=uf,vf=control_text("3"),vf.maxLength=3,vf.onchange=vf.onblur=function(){var a=this.value;isEmpty(a)||isInt(a)&&!(a-100>0)?(e.dataNode._rowwidth2=a+"%","%"==e.dataNode._rowwidth2&&(e.dataNode._rowwidth2="")):(show_status_tip("您输入的宽度不合法！"),this.value="",e.dataNode._rowwidth2=""),e.updateItem(),window.focus()},this.setTWidth2=function(a){"自定义"!=a.value?(vf.value=a.value.replace("%",""),vf.style.display="none",vf.onchange()):vf.style.display=""},this.initWidth2=function(){if(this.dataNode._rowwidth2&&this.dataNode._rowwidth2.indexOf("%")>-1){var a=$$("select",tf)[0];a.value=this.dataNode._rowwidth2,vf.value=this.dataNode._rowwidth2.replace("%",""),-1==a.selectedIndex&&(a.value="自定义",this.setTWidth2(a))}},vf.style.display="none",tf.appendChild(vf)),!r||102!=this.dataNode._tag&&103!=this.dataNode._tag||(wf=control_check(),wf.className="checkbox",wf.id="dz_"+this.dataNode._topic+"_"+RndNum(10),nf.appendChild(wf),xf=$ce("label","竖向选择",nf),xf.setAttribute("for",wf.id),xf.onmouseover=function(){toolTipLayerTop.style.width="330px",toolTipLayerTop.innerHTML="选项太多时可以得到更好的显示效果，只支持电脑端",sb_setmenunav(toolTipLayerTop,!0,this)},xf.onmouseout=function(){sb_setmenunav(toolTipLayerTop,!1,this)},wf.onclick=function(){return e._referDivQ?(show_status_tip("使用引用逻辑后，不能再使用竖向选择",5e3),void 0):(e.dataNode._daoZhi=this.checked,e.updateSpanMatrix(),e.updateItem(),void 0)},yf=$ce("a","交换选项与行",nf),yf.className="link-U666",yf.style.display="inline-block",yf.style.marginLeft="10px",yf.onmouseover=function(){toolTipLayerTop.style.width="260px",toolTipLayerTop.innerHTML="如果行与选项设置错误，可以进行交换",sb_setmenunav(toolTipLayerTop,!0,this)},yf.onmouseout=function(){sb_setmenunav(toolTipLayerTop,!1,this)},yf.href="javascript:;",yf.onclick=function(){return isMergeAnswer&&!e.isMergeNewAdded?(show_status_tip("在部分修改问卷模式下，不能“交换选项与行”",5e3),!1):(layer.confirm("确定交换行与选项吗?",{title:"提示"},function(a){var d,f,b="",c=e.dataNode._select;for(d=1;d<c.length;d++)d>1&&(b+="\n"),b+=c[d]._item_title;f=pd.value,f&&(pd.value=b,e.checkRowTitle(),e.setFreOptions(f)),layer.close(a)}),!1)}),r&&this.dataNode._tag&&"201"!=this.dataNode._tag&&"202"!=this.dataNode._tag&&($ce("span","&nbsp;&nbsp;",nf),zf=control_check(),zf.className="checkbox",zf.id="cce_"+this.dataNode._topic+"_"+RndNum(10),nf.appendChild(zf),Af=$ce("label","不隔行显示列标题",nf),Af.setAttribute("for",zf.id),Af.onmouseover=function(){toolTipLayerTop.style.width="400px",toolTipLayerTop.innerHTML="行标题数量超过15后会每10行显示列标题，勾选后将隐藏。<a href='/help/help.aspx?helpid=351&h=1' class='link-U00a6e6' target='_blank'>查看</a>";var a=this;this.hasOut=!1,setTimeout(function(){a.hasOut||sb_setmenunav(toolTipLayerTop,!0,a)},200)},Af.onmouseout=function(){this.hasOut=!0,sb_setmenunav(toolTipLayerTop,!1,this)},zf.onclick=function(){e.dataNode._nocolumn=this.checked},this.dataNode._nocolumn&&(zf.checked=!0))),r&&(Nd.style.width="320px",("102"==h||"103"==h)&&(Nd.style.width="460px"),h&&101>=h&&(Nd.style.width="460px"),"303"==h&&(Nd.style.width="370px"),Pd.cellSpacing="0",Pd.cellPadding="2",Pd.width="98%",setFloat(Nd),setFloat(dd),$ce("div","",bd).style.clear="both"),f._isShop&&$ce("div","<div style='margin:10px 0 10px 40px;font-size:14px'><b style='color:#ff9900;'>商品支付方式:</b>&nbsp;&nbsp;<a href='javascript:' onclick='PDF_launch(\"/wjx/design/setpayapp.aspx?activity="+activityID+"\",500,300);return false;' class='titlelnk' target='_blank'>设置微信支付</a></div>",L),Cf=$ce("div","",L),Cf.style.marginTop="15px",Cf.style.padding="0 40px",l||B||m||E||C||5==newQType||(Cf.className="h-setting",Df=$ce("span","逻辑设置：",Cf),Df.style.fontColor="#303030",Df.style.fontWeight="600",Df.style.marginRight="12px"),(x||m)&&5!=window.newQType&&(Ef=$ce("span","",Cf),Ef.style.position="relative",m?Ef.style.marginTop="6px":Ef.innerHTML="",C&&(Ef.innerHTML=""),Ff=document.createElement("span"),Gf=document.createElement("a"),Gf.innerHTML="题目关联",Gf.className="link-new",Gf.href="###",Ff.appendChild(Gf),e.initRelation=function(){this.dataNode._relation="",Gf.innerHTML="题目关联",e.RelationIns&&(e.RelationIns.style.display="none"),Hf&&(Hf.style.display="none")},e.displayRelation=function(){var b,c,a=this.dataNode._relation;return Gf.dtitle="",Gf.className="link-new",a?"0"==a?!1:(b=getRelationStr(a),b&&(c=b[0],c.length>18&&(c=c.substring(0,18)),e.RelationIns.onmouseover||(e.RelationIns.onmouseover=function(){toolTipLayerMenu.style.width="344px",toolTipLayerMenu.innerHTML=this.dtitle,sb_setmenunav(toolTipLayerMenu,!0,this)},e.RelationIns.onmouseout=function(){sb_setmenunav(toolTipLayerMenu,!1,this)}),e.RelationIns.innerHTML=b[0],e.RelationIns.dtitle=b[1],e.RelationIns.style.display="",Gf.dtitle=b[1],Gf.innerHTML="编辑题目关联",Gf.className="link-set",m||C||E||(Hf.style.display=""),Hf.onclick=function(){var c,a="/wjx/design/applyrelation.aspx",b=e.dataNode._topic;a+="?ct="+b,c=e.dataNode._relation,c&&(a+="&rt="+c),PDF_launch(a,500,320)}),void 0):(this.initRelation(),!1)},Gf.onclick=function(){e.openRelationWindow()},Gf.onmouseover=function(){toolTipLayerMenu.style.width="310px",toolTipLayerMenu.innerHTML="当前面题目<b>选中某些选项时</b>才出现此题&nbsp;&nbsp;<a target='_blank' class='link-U00a6e6' href='/help/help.aspx?helpid=216&h=1'>查看帮助</a>",this.dtitle&&(toolTipLayerMenu.innerHTML=this.dtitle);var a=this;this.hasOut=!1,setTimeout(function(){a.hasOut||sb_setmenunav(toolTipLayerMenu,!0,a)},200)},Gf.onmouseout=function(){this.hasOut=!0,sb_setmenunav(toolTipLayerMenu,!1,this)},Ef.appendChild(Ff),Hf=$ce("span","&nbsp;",Ef),If=$ce("a","",Hf),If.className="copy-tit",If.href="###",Hf.style.display="none",If.onmouseover=function(){toolTipLayer.style.width="206px",toolTipLayer.innerHTML="复制此题关联逻辑到后面的题目",sb_setmenunav(toolTipLayer,!0,this)},If.onmouseout=function(){sb_setmenunav(toolTipLayer,!1,this)},this.displayRelation()),x&&(Jf=$ce("span","",Cf),(C||E||B||5==newQType)&&(Jf.style.display="none"),Kf=$ce("a","跳题逻辑",Jf),Kf.href="###",Kf.onclick=function(){var a,b;return e._referDivQ?(alertNew("提示：题目不能同时使用选项引用和跳题"),void 0):(a="/wjx/design/setjump.aspx?ct="+e.dataNode._topic,b=420,"radio"!=e.dataNode._type&&"radio_down"!=e.dataNode._type&&(b=280),PDF_launch(a,580,b,Lf,"跳题逻辑"),!1)},e.displayJump=function(){return this.dataNode._hasjump?(Kf.innerHTML="编辑跳题逻辑",Kf.className="link-set",!1):(Kf.className="link-new",Kf.innerHTML="跳题逻辑",void 0)},e.displayJump(),Kf.onmouseover=function(){var a=this;this.hasOut=!1,setTimeout(function(){a.hasOut||(toolTipLayerMenu.style.width="250px",toolTipLayerMenu.innerHTML="通过配合设置其他题目的“按选项跳题”实现更复杂的跳题逻辑&nbsp;&nbsp;<a target='_blank' class='link-U00a6e6' href='/help/help.aspx?helpid=218&h=1'>查看示例</a>",sb_setmenunav(toolTipLayerMenu,!0,a))},200)},Kf.onmouseout=function(){this.hasOut=!0,sb_setmenunav(toolTipLayerMenu,!1,this)},0!=newQType&&1!=newQType&&4!=newQType||this.dataNode._isCePing||this.dataNode._hasvalue||this.dataNode._isQingJing||("check"==this.dataNode._type&&!this.dataNode._isShop||"radio"==this.dataNode._type&&!this.dataNode._likertMode)&&(Mf=$ce("span","",Cf),Nf=document.createElement("a"),Nf.innerHTML="选项关联",Nf.className="link-new",Nf.href="#",Mf.appendChild(Nf),e.displayItemRelation=function(){this.dataNode._hasitemrelation?(Nf.innerHTML="编辑选项关联",Nf.className="link-set"):(Nf.className="link-new",Nf.innerHTML="选项关联"),Nf.onclick=function(){e.openRelationByOption()}},this.displayItemRelation())),Of=!0,(q||B||"radio"==g&&h||F||A||C||H||E||isMergeAnswer&&!this.isMergeNewAdded||!cd)&&(Of=!1),(w||k||r)&&Of&&(Pf="选项引用",(k||r)&&(Pf="行标题引用"),Qf="<a href='javascript:' onclick='cur.show_divAddFromCheck();this.onmouseout();return false;' onmouseover='showRelTip(true,this);' onmouseout='showRelTip(false,this);' class='link-U666'>"+Pf+"</a>",5==newQType&&(Qf=""),$ce("span",Qf,Cf),Rf=$ce("span","",Cf),Sf=$ce("select","",Rf),this.selAddFromCheck=Sf,Sf.style.width="168px",Rf.style.display="none",Tf=document.createElement("span"),Tf.style.display="none",Rf.appendChild(Tf),this.show_divAddFromCheck=function(){return cur.dataNode._hasitemrelation?(alertNew("提示：选项关联和选项引用只能用一种"),this.value="0",void 0):cur.dataNode._hasjump?(alertNew("提示：题目不能同时使用选项引用和跳题"),this.value="0",void 0):(Rf.inited||(Sf.onchange=function(){return vipUser?(cur.addFromCheck(this),void 0):(alertNew('提示：只有企业版用户才能使用引用逻辑，请<a href="/register/upgradevip.aspx?upgradeReason=50" target="_blank">升级</a>'),this.value="0",void 0)},Rf.inited=!0),Rf.style.display=""==Rf.style.display?"none":"",isMergeAnswer&&!this.isMergeNewAdded&&(Rf.style.display="none"),5==newQType&&(Rf.style.display="none"),this.updateSelCheck(),this.hasDisplaySelCheck=""==Rf.style.display,void 0)},this.updateSelCheck=function(){var a,b,c,d,e,f,g,h,i,j;for(a=0;a<Sf.options.length;a++)Sf.options[a]=null;for(Sf.options[0]=new Option("请选择来源题目(多选或排序题)",0),b=1,a=0;a<questionHolder.length;a++)c=questionHolder[a].dataNode,d=this.dataNode._topic,"check"==c._type&&!c._isShop&&c._topic-d<0&&!questionHolder[a]._referDivQ&&(e="[多选题]",c._tag&&(e="[排序题]"),f=c._title,f=f.replace(/<(?!img|embed).*?>/gi,""),f=f.replace(/&nbsp;/gi," ").substring(0,16),g=f+"  "+e,WjxActivity._use_self_topic||(g=c._topic+"."+g),h=new Option(g,c._topic),h.referDivQ=questionHolder[a],Sf.options[b++]=h);if(this._referDivQ)for(i=Sf.options,a=0;a<i.length;a++)if(j=i[a],j.referDivQ==this._referDivQ){Sf.value=j.value;break}},this.addFromCheck=function(){var d,f,g,b=Sf.selectedIndex,c=b>0?"none":"";if(o||n?(b>0&&We.checked&&(We.checked=!1,We.onclick()),We.disabled=b>0?!0:!1,bd.style.display=c,Ld.style.display=c):("matrix"==this.dataNode._type&&this.dataNode._tag&&(this.dataNode._tag-300>0||"202"==this.dataNode._tag)?(ed.style.display=c,rd&&(ed.style.display=c),yd&&(yd.style.display=c,Bd.style.marginLeft=b>0?"0px":"20px"),"303"==this.dataNode._tag&&5!=newQType&&(vd.style.width=b>0?"505px":"217px",wd.style.width=b>0?"412px":"200px")):dd.style.display=c,nf&&(nf.style.display=c)),Tf.style.display=b>0?"":"none",this.clearReferQ(),Sf.value>0){if(this._referedArray){for(d="",f=0;f<this._referedArray.length;f++)f>0&&(d+=","),d+=this._referedArray[f].dataNode._topic;return show_status_tip("第"+d+"题的选项或行标题来源于此题的选中项，此题不能再引用其他题"),Sf.value="0",this.show_divAddFromCheck(),void 0}g=Sf.options[Sf.selectedIndex].referDivQ,this._referDivQ=g,g._referedArray||(g._referedArray=new Array),-1==g._referedArray.indexOf(this)&&g._referedArray.push(this),g._referedArray.sort(function(a,b){return a.dataNode._topic-b.dataNode._topic}),this.updateReferQ()}else this.show_divAddFromCheck();this.dataNode._daoZhi&&wf&&(wf.checked=!1,this.dataNode._daoZhi=!1,e.updateSpanMatrix(),show_status_tip("使用引用逻辑后，不能再使用竖向选择",5e3)),this.updateItem?this.updateItem():this.createSum&&this.createSum()},this.removeRefer=function(){Sf.value="0",this.addFromCheck()},this.clearReferQ=function(){this._referDivQ&&(this._referDivQ._referedArray.remove(this),this._referDivQ._referedArray.length||(this._referDivQ._referedArray=null),this._referDivQ=null)},this.clearReferedQ=function(){var a,b;if(this._referedArray)for(a=0;a<this._referedArray.Length;a++)b=this._referedArray[a],b._referDivQ=null,b.updateItem?b.updateItem():b.createSum&&b.createSum()},this.updateReferQ=function(){var b,c;this._referDivQ&&(this._referDivQ,b="选项",("matrix"==this.dataNode._type||"sum"==this.dataNode._type)&&(b="行标题"),c="&nbsp;<a href='javascript:' onclick='cur.removeRefer();return false;' class='link-U666'>取消</a>&nbsp;",isMergeAnswer&&!this.isMergeNewAdded&&(c=""),Tf.innerHTML=c)}),r&&this.dataNode._tag&&(this.dataNode._tag-101<=0||"103"==this.dataNode._tag)&&(Uf=$ce("span","<a  onclick='cur.setMChoiceAttr();return false;' href='javascript:' class='link-U666'>选项可选个数</a>",Cf),Vf=$$("a",Uf)[0],Vf.onmouseover=function(){toolTipLayerMenu.style.width="230px",toolTipLayerMenu.innerHTML="设置每个选项最多可以被选中的次数";var a=this;this.hasOut=!1,setTimeout(function(){a.hasOut||sb_setmenunav(toolTipLayerMenu,!0,a)},200)},Vf.onmouseout=function(){this.hasOut=!0,sb_setmenunav(toolTipLayerMenu,!1,this)},this.setMChoiceAttr=function(){PDF_launch("/wjx/design/setchoiceattr.aspx?ct="+this.dataNode._topic,500,340,function(){cur.updateItem()},"选项可选个数")}),Wf=document.createElement("div"),Wf.style.margin="14px 36px 20px",Xf=control_btn("完成编辑"),Xf.className="submitbutton",Xf.style.width="100%",Xf.onclick=function(){qonclick.call(e)},this.newAddQ,Yf=$ce("div","",Wf),Yf.style.color="red",Yf.style.fontSize="14px",Yf.style.display="inline-block",Yf.style.margin="0px 0 6px 10px",Wf.appendChild(Xf),L.appendChild(Wf),c.appendChild(d),this.hasCreatedAttr=!0,this.createEditBox=function(){if(!this.hasEditBox){this.hasEditBox=!0,Y&&(Y.style.display="none"),U&&(U.style.display=""),T.style.height="88px";var a=EditToolBarItemsPageCut;x?a=EditToolBarItems:T.style.height="162px",KE.init({id:Z,items:a,filterMode:filter,afterChange:function(a){KE.util.setData(a);var b=KE.util.getData(a);W.innerHTML=b?"":"请输入标题"},afterCreate:function(a){var b=KE.util.getData(a);W.innerHTML=b?"":"请输入标题"},DesignPage:1}),this.titleId=Z,KE.create(Z),T.value?KE.focus(Z,"end"):KE.util.focus(Z)}},this.popHint=function(a){Yf&&(Yf.innerHTML=a?"<b>提示：</b>"+a:"")},""==S.style.display&&this.createEditBox(),this.checkTitle=function(){var a,b,c;if(u){if(this.popHint(""),a=getGapFillCount(T.value),0==a)return this.popHint("填空题标题必须包含填空符，请点击“插入填空符”按钮进行插入。"),this.isTitleValid=!1,!1;if(isMergeAnswer&&!e.isMergeNewAdded&&a<this.dataNode._gapcount)return show_status_tip("合并答卷时，不能删除填空题标题中的空!",4e3),this.isTitleValid=!1,!1}return T.value||(T.value=T.defValue||""),b=T.value,!this.hasEditBox&&/\r\n|\n|\r/.test(b)&&(b=T.value=b.replace(/\r\n|\n|\r/g,"<br />"),Y.onclick()),u&&(b=replaceGapFill(b,this.dataNode).replace(/\<br\s*\/?\>/g,"<div style='margin-top:8px;'></div>")),I.innerHTML=b,this.dataNode._title=T.value,this.isTitleValid=!0,"cut"==this.dataNode._type&&(I.innerHTML=b||"请在此输入说明文字",this.div_video_title&&(this.div_video_title.innerHTML=""),this.dataNode._video&&(c="<iframe height=498 width=510 src='"+this.dataNode._video+"' frameborder=0 allowfullscreen></iframe>",this.div_video_title?this.div_video_title.innerHTML=c:this.div_video_title=$ce("div",c,I))),!this.hasEditBox&&this.dataNode._title.indexOf("<")>-1&&this.createEditBox(),l&&(I.parentNode.style.borderBottom=""==I.innerHTML?"none":"dashed 1px #efefef"),!0},this.checkDefault=function(){if(this.popHint(""),!Mc)return!0;var a=replace_specialChar(trim(Mc.value));return Mc.value=a,""!=zc.value&&""!=a&&a.length<zc.value?(this.popHint("您输入的默认值少于您设置的最小字数，请修改！"),this.isDefaultValid=!1,!1):""!=Bc.value&&a.length>Bc.value?(this.popHint("您输入的默认值超过了您设置的最大字数，请修改！"),this.isDefaultValid=!1,!1):(Oc.value="省市区"!=this.dataNode._verify&&"高校"!=this.dataNode._verify?a:a?"指定省份为："+a:"",this.dataNode._default=a,this.isDefaultValid=!0,!0)},this.checkValid=function(){var c,d,e,f,g,h,j,a=void 0==this.isAnyJumpValid||this.isAnyJumpValid,b=void 0==this.isTitleValid||this.isTitleValid;return i?(c=void 0==this.isDefaultValid||this.isDefaultValid,b&&c&&a):(d=void 0==this.isItemTitleValid||this.isItemTitleValid,e=void 0==this.isItemJumpValid||this.isItemJumpValid,f=void 0==this.isItemValueValid||this.isItemValueValid,g=void 0==this.isRowTitleValid||this.isRowTitleValid,h=void 0==this.isColumnTitleValid||this.isColumnTitleValid,j=void 0==this.isCeShiValid||this.isCeShiValid,d&&e&&f&&a&&b&&g&&h&&j)},this.validate=function(){var a,b;Yf.innerHTML="",this.checkTitle(),i?this.checkDefault():k?this.checkRowTitle():w&&(a=!0,b=!0,r&&(a=this.checkRowTitle()),s&&(b=this.checkColumnTitle()),a&&b&&this.checkItemTitle(),this.checkItemValue(),this.checkCheckLimit&&this.checkCheckLimit(),this.checkCeShiSet&&this.checkCeShiSet()),this.setErrorStyle()},this.setErrorStyle=function(){this.checkValid()?this.className=this.className.replace(/div_question_error/,""):this.className+=" div_question_error"},this.setDataNodeToDesign=function(){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,a=this.dataNode;switch(a._type){case"question":if(xb.value=a._ins,"多级下拉"==a._verify){tb.checked=a._requir;break}T.value=a._title,T.onblur(),Bc.value=a._maxword,tb.checked=a._requir,Mc.value=a._default,a._default&&(a._olddefault=a._default,Jc.click()),Cc.checked=a._needOnly,Ec.checked=a._needsms,Yc.value=a._width,a._underline&&($c.checked=!0),zc.value=a._minword,a._minword||a._maxword?(wc.style.display="",tc.checked=!0):wc.style.display="none",this.initVerify(),this.initWidth(),this.initHeight();break;case"sum":T.value=a._title,T.onblur(),tb.checked=a._requir,pd.value=a._rowtitle,gd.value=a._total,xb.value=a._ins,this._referDivQ&&this.show_divAddFromCheck&&(this.show_divAddFromCheck(),Sf.value=this._referDivQ.dataNode._topic,this.addFromCheck(Sf));break;case"cut":case"page":T.value=a._title,T.onblur(),"page"==a._type&&(Eb.checked=a._iszhenbie,Jb.value=a._mintime,Kb.value=a._maxtime,Kb.onblur());break;case"fileupload":for(T.value=a._title,T.onblur(),b=$$("input",nc),c=a._ext||defaultFileExt,c!=defaultFileExt?(hc.checked=!0,nc.style.display=""):nc.style.display="none",ac.value=a._maxsize/1024,dc.options[parseInt(a._uploadlimit)-1].selected=!0,d=c.split("|"),e=0;e<b.length;e++)b[e].onclick=function(){var a,b,c;if(!this.value)for(a=this.parentNode,b=$$("input",a),c=0;c<b.length;c++)b[c]!=this&&(b[c].checked=this.checked);cur.updateExt&&cur.updateExt(this)},d.indexOf(b[e].value)>-1&&(b[e].checked=!0);for(e=0;e<b.length;e++)if(!b[e].value){for(f=!0,g=b[e].parentNode,h=$$("input",g),i=0;i<h.length;i++)if(h[i]!=b[e]&&!h[i].checked){f=!1;break}f&&(b[e].checked=!0)}tb.checked=a._requir,xb.value=a._ins;break;case"gapfill":T.value=a._title,T.onblur(),tb.checked=a._requir,xb.value=a._ins,hb.checked=a._useTextBox;break;case"slider":T.value=a._title,T.onblur(),tb.checked=a._requir,Xb.value=a._minvalue||0,$b.value=a._maxvalue||100,Yb.value=a._minvaluetext||"",_b.value=a._maxvaluetext||"",xb.value=a._ins;
break;case"radio":case"radio_down":case"check":case"matrix":for(T.value=a._title,T.onblur(),xb&&(xb.value=a._ins),Ze&&(Ze.value=a._numperrow,A&&"-1"==a._numperrow&&(Ze.value="1")),We.value=a._randomChoice?"1":"0",a._hasvalue&&(fe.checked=!0,fe.onclick()),a._tag&&(fe.disabled=!0),"matrix"==a._type&&(this.initMainWidth(),pd.value=a._rowtitle,this.initWidth(),a._rowtitle2&&sd&&(sd.checked=!0,sd.onclick(),sd.checked=!0),a._rowwidth2&&this.initWidth2(),a._daoZhi&&wf&&(wf.checked=!0),Ld.style.display=a._tag>200&&"303"!=a._tag?"none":"",Nd.style.display=Ld.style.display,fe.disabled=a._tag<=101||303==a._tag?!0:!1),j=!1,k=!a._tag&&("check"==a._type||"radio"==a._type||"radio_down"==a._type),l=1;l<a._select.length;l++)K[l].get_item_title().value=a._select[l]._item_title.replace(/&lt;/,"<"),(k||a._isCeShi)&&(m=a._select[l]._item_radio,K[l].get_item_check().checked=m,m&&(j=!0),a._select[l]._item_huchi&&(K[l].get_item_huchi().checked=!0)),j&&this.defaultCheckSet&&this.defaultCheckSet(),n=a._select[l]._item_value,!a._isShop||"0"!=n&&n||(n="10"),K[l].get_item_value().value=n,n==NoValueData&&(K[l].get_item_value().value="",K[l].get_item_novalue()&&(K[l].get_item_novalue().checked=!0)),o=a._select[l]._item_jump,a._isShop&&(K[l].get_item_jump().value=o),K[l].get_item_tb()&&(K[l].get_item_tb().checked=a._select[l]._item_tb),K[l].get_item_tbr()&&(K[l].get_item_tbr().checked=a._select[l]._item_tbr),K[l].get_item_img()&&(K[l].get_item_img().value=a._select[l]._item_img),K[l].get_item_imgtext()&&(K[l].get_item_imgtext().checked=a._select[l]._item_imgtext),K[l].get_item_desc()&&(K[l].get_item_desc().value=a._select[l]._item_desc);tb&&(tb.checked=a._requir),this._referDivQ&&this.show_divAddFromCheck&&(this.show_divAddFromCheck(),Sf.value=this._referDivQ.dataNode._topic,this.addFromCheck(Sf))}a._ins&&(a._oldins=a._ins,xb.onchange());try{T.focus()}catch(p){}}}function setImage(a){PDF_close(a)}function creat_item(a,b,c,d,e,f){function F(a){var b,c,d,e,f;void 0!=a&&(b=cur.option_radio[g].get_item_img(),y&&a.indexOf(".sojump.com")>-1&&(a.indexOf("pubali")>-1?(c="?x-oss-process",d=a.indexOf(c),d>-1&&(a=a.substring(0,d)),a=a+c+"=image/quality,q_90/resize,m_fill,h_126,w_190"):(c="?imageMogr2",d=a.indexOf(c),d>-1&&(a=a.substring(0,d)),a=a+c+"/thumbnail/190x126!")),itemImage=b.value=a,C.className=a?"choiceimg design-icon design-imgedit":"choiceimg design-icon design-img",a?(e=a.indexOf(".paperol.cn"),e>-1&&(C.className="choiceimg design-icon",C.style.width="25px",C.style.height="25px",e=a.indexOf("?x-oss-process="),f=B.value,e>-1&&(f=a.substring(0,e)),f+="?x-oss-process=image/resize,m_fill,h_25,w_25",C.style.backgroundImage="url('"+f+"')")):(C.style.width="20px",C.style.height="18px",C.style.backgroundImage="url('/images/Design/icoall.png?v=1')"),cur.updateItem(),cur.showImgTxt&&cur.showImgTxt(),cur.setchoiceWidth&&cur.setchoiceWidth())}function hb(a,b){var c=a.get_item_title().value;a.get_item_title().value=b.get_item_title().value,b.get_item_title().value=c}function ib(a,b){var c=a.get_item_check().checked;a.get_item_check().checked=b.get_item_check().checked,b.get_item_check().checked=c}function jb(a,b){var c=a.get_item_value().value;a.get_item_value().value=b.get_item_value().value,b.get_item_value().value=c,a.get_item_novalue()&&(c=a.get_item_novalue().checked,a.get_item_novalue().checked=b.get_item_novalue().checked,b.get_item_novalue().checked=c),a.get_item_tb()&&(c=a.get_item_tb().checked,a.get_item_tb().checked=b.get_item_tb().checked,b.get_item_tb().checked=c),a.get_item_tbr()&&(c=a.get_item_tbr().checked,a.get_item_tbr().checked=b.get_item_tbr().checked,b.get_item_tbr().checked=c),a.get_item_img()&&(c=a.get_item_img().value,a.get_item_img().value=b.get_item_img().value,b.get_item_img().value=c),a.get_item_jump()&&(c=a.get_item_jump().value,a.get_item_jump().value=b.get_item_jump().value,b.get_item_jump().value=c,a.get_item_jump().onblur(),b.get_item_jump().onblur()),a.get_item_imgtext()&&(c=a.get_item_imgtext().checked,a.get_item_imgtext().checked=b.get_item_imgtext().checked,b.get_item_imgtext().checked=c),a.get_item_desc()&&(c=a.get_item_desc().value,a.get_item_desc().value=b.get_item_desc().value,b.get_item_desc().value=c)}var l,m,n,o,p,q,r,s,t,u,v,w,x,y,A,B,C,D,E,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,ab,bb,cb,db,eb,fb,gb,g=b,h=c,i=c.insertRow(g),j=i.insertCell(-1),k=control_text("15");if(k.tabIndex=1,k.title="回车添加新选项，上下键编辑前后选项",e&&select_item_num++,k.value=f?f._item_title:"选项"+select_item_num,c.rows.length-1==g&&cur&&(cur.dataNode._isQingJing||cur.dataNode._isShop)){for(l="情景"+g,cur.dataNode._isShop&&(l="商品"+g),m=!1,n=1;n<cur.dataNode._select.length;n++)if(cur.dataNode._select[n]._item_title==l){m=!0;break}m||(k.value=l)}return k.className+=" choicetxt",k.onchange=k.onblur=function(){this.value||(this.value=this.initText||""),cur&&cur.updateItem&&(cur.updateItem(),cur.checkTextJump(this.value),cur.updateReferQ())},k.onfocus=function(){this.initText||(this.initText=this.value);var a=/^选项\d+$/;a.test(this.value)&&(this.value="")},k.onkeydown=function(a){var b=a||window.event;return 13==b.keyCode?o.onclick():40==b.keyCode?g<cur.option_radio.length-1&&(cur.option_radio[g+1].get_item_title().focus(),cur.option_radio[g+1].get_item_title().select()):38==b.keyCode&&g>1&&(cur.option_radio[g-1].get_item_title().focus(),cur.option_radio[g-1].get_item_title().select()),!0},j.appendChild(k),o=document.createElement("span"),o.title="在此选项下面插入一个新的选项",o.className="choiceimg design-icon design-add",o.style.cursor="pointer",o.style.marginLeft="3px",j.appendChild(o),p=document.createElement("span"),p.title="删除当前选项（最少保留2个选项）",p.className="choiceimg design-icon design-minus",j.appendChild(p),q=cur||a,r=GetItemTitleWidth(q.dataNode),s=r-75,q&&"radio"==q.dataNode._type&&q.dataNode._tag&&(s-=10),k.style.width=s+"px",j.style.width=r+"px",t=q.dataNode._isCePing,u="check"==q.dataNode._type&&(q.dataNode._tag||0),v=!(q.dataNode._tag||"check"!=q.dataNode._type&&"radio"!=q.dataNode._type||t),w=q.dataNode._isCeShi,x=q.dataNode._isQingJing,y=q.dataNode._isShop,q.dataNode._isTouPiao,(v||t||u)&&!x&&(A=i.insertCell(-1),A.align="center",y&&(A.align="center"),B=document.createElement("input"),B.type="hidden",B.value=f?f._item_img:"",A.appendChild(B),C=document.createElement("span"),C.title="添加图片",C.className="choiceimg design-icon design-img",A.appendChild(C),B.value&&(C.title="编辑图片",D=B.value.indexOf(".paperol.cn"),D>-1?(C.className="choiceimg design-icon",C.style.width="25px",C.style.height="25px",D=B.value.indexOf("?x-oss-process="),E=B.value,D>-1&&(E=B.value.substring(0,D)),E+="?x-oss-process=image/resize,m_fill,h_25,w_25",C.style.backgroundImage="url('"+E+"')"):C.className="choiceimg design-icon design-imgedit"),C.onclick=function(){itemImage=cur.option_radio[g].get_item_img().value,PDF_launch("uploadimg.aspx?design=1&activity="+activityID,650,470,F,cur.option_radio[g].get_item_title().value)},G=$ce("span","",A),H=control_check(),G.style.display="inline-block",H.title="是否显示选项文字",H.className="checkbox",G.appendChild(H),G.style.display=B.value?"":"none",G.style.display="none",H.onclick=function(){cur.updateItem()}),!v&&!t||y||(I=i.insertCell(-1),I.align="center",J=document.createElement("span"),J.title="选项说明，支持HTML，图片，视频等",J.className="choiceimg design-icon design-desc",I.appendChild(J),K=document.createElement("input"),K.type="hidden",K.value=f?f._item_desc||"":"",I.appendChild(K),K.value&&(J.className="choiceimg design-icon design-descedit"),J.onclick=function(){PDF_launch("/wjx/design/setitemdesc.aspx?ct="+cur.dataNode._topic+"&ii="+g,680,410,null,"选项说明")}),(u||v||"matrix"==q.dataNode._type&&("102"==q.dataNode._tag||"103"==q.dataNode._tag||"101"==q.dataNode._tag||q.dataNode._tag<101)||t)&&(L=i.insertCell(-1),L.align="center",M=$ce("span","",L),M.style.verticalAlign="bottom",M.style.fontSize="12px",N=control_check(),N.style.verticalAlign="bottom",N.title="允许填空",N.className="checkbox",M.appendChild(N),N.checked=f?f._item_tb:!1,O=$ce("span","<span style='font-size:16px;'>|</span>",M),P=$ce("span","",O),Q="cbr"+a.dataNode._topic+"_"+g,R=control_check(),R.title="文本框必填",R.id=Q,R.className="checkbox",P.appendChild(R),$ce("label","必填",P).setAttribute("for",Q),R.checked=f?f._item_tbr:!1,O.style.display=N.checked?"":"none",N.onclick=function(){if(this.checked){if("matrix"==q.dataNode._type&&q.dataNode._tag<101)return alertNew("提示：图标样式的量表题不支持可填空属性，您可以选择量表样式为：单选框样式"),this.checked=!1,void 0}else cur.option_radio[g].get_item_tbr().checked=!1;cur.option_radio[g].get_item_tbr().parentNode.parentNode.style.display=this.checked?"":"none",cur.updateItem()},R.onclick=function(){cur.updateItem()},(w||x||y)&&(L.style.display="none")),S=i.insertCell(-1),S.align="left",T=$ce("span","",S),U=control_text("4"),U.maxLength=5,U.style.width="30px",U.title="在此可以设置每个选项的分数（请输入整数）",x?U.title="请设置每个情景需要的数量,0表示不限制":y&&(U.title="设置商品价格"),U.value=f?f._item_value:g,w&&"check"==q.dataNode._type&&(U.value="0"),T.appendChild(U),q.dataNode._hasvalue&&(t||q.dataNode._tag)?(S.style.display="","check"!=q.dataNode._type&&"303"!=q.dataNode._tag&&(V=control_check(),V.style.margin="0 0 0 3px",V.title="不记分",V.className="checkbox",V.onclick=function(){U.value="",cur.updateItem()},U.style.width="16px",S.appendChild(V),W=$ce("span","不记分",S),W.style.fontSize="11px",W.style.margin="0 0 0 3px")):x||y||(S.style.display="none"),U.onchange=U.onblur=function(){var a=this.value;y?this.value&&parseFloat(this.value)==this.value||(this.value=10):x&&(!isInt(this.value)||parseInt(this.value)<1)&&(this.value=10,x&&(this.value="0"!=a?50:"0")),t||y||"radio"==cur.dataNode._type&&cur.dataNode._tag?cur.updateItem():cur.updateItem(!0)},U.onkeydown=function(a){var b=a||window.event;13==b.keyCode?o.onclick():40==b.keyCode?g<cur.option_radio.length-1&&cur.option_radio[g+1].get_item_value().select():38==b.keyCode&&g>1&&cur.option_radio[g-1].get_item_value().select()},y&&(X=i.insertCell(-1),Y=$ce("span","",X),X.align="left",Z=control_text(4),Z.style.width="34px",Z.maxLength=4,Z.style.height="22px",Z.title="为空表示不限制库存，0表示已售完",Y.appendChild(Z),Z.onblur=function(){return y&&!vipUser?(alertNew('提示：库存功能仅对企业版开放，请<a href="/register/upgradevip.aspx?upgradeReason=51" target="_blank">升级</a>'),this.value="",void 0):(y&&(!isInt(this.value)||parseInt(this.value)-0<0)&&(this.value=""),this.value==this.prevValue?(this.hasChanged=!1,void 0):(this.hasChanged=!0,this.prevValue=this.value,cur.dataNode._select[g]._item_jump=this.value,y&&cur.updateItem(),void 0))}),$=null,!v||"check"!=d||w||y||(_=i.insertCell(-1),ab=$ce("span","&nbsp;",_),_.align="center",$=control_check(),$.title="与其它选项互斥",$.className="checkbox",ab.appendChild($),$.onclick=function(){cur.updateItem()}),bb=i.insertCell(-1),cb=$ce("span","&nbsp;",bb),db=null,db=control_check(),db.className="checkbox",w?bb.align="center":db.title="若选中，用户在填问卷时此选项会默认被选中",bb.style.display=!v&&"radio_down"!=q.dataNode._type||x||y?"none":"",cb.appendChild(db),!v&&"radio_down"!=q.dataNode._type||"radio"!=d||(db.onclick=function(){if(this.checked&&cur.dataNode._hasjump)return this.checked=!1,show_status_tip("提示：设置了跳题不能再设置默认值！",5e3),void 0;if(this.checked)for(var a=1;a<cur.option_radio.length;a++)cur.option_radio[a].get_item_check()==this?this.checked=!0:cur.option_radio[a].get_item_check().checked=!1;cur.updateItem()}),v&&"check"==d&&(db.onclick=function(){return this.checked&&cur.dataNode._hasitemrelation?(this.checked=!1,show_status_tip("提示：设置了选项关联不能再设置默认值！",5e3),void 0):(cur.updateItem(),w&&cur.setScoreTxt(),void 0)}),eb=i.insertCell(-1),eb.align="left",eb.style.paddingLeft="15px",fb=document.createElement("span"),fb.title="将当前选项上移一个位置",fb.className="choiceimg design-icon design-cup",gb=document.createElement("span"),gb.title="将当前选项下移一个位置",gb.className="choiceimg design-icon design-cdown",eb.appendChild(fb),eb.appendChild(gb),fb.style.cursor="pointer",gb.style.cursor="pointer",o.onclick=function(){if(isMergeAnswer&&!cur.isMergeNewAdded&&g<cur.option_radio.length-1)return alertNew("很抱歉，部分修改问卷模式下，不能在中间插入选项，只能在最后面添加选项！"),void 0;if(!isMergeAnswer||cur.isMergeNewAdded||confirm("此题不能删除选项，是否确认增加选项？")){for(var a=cur.option_radio.length-1;a>g;a--)cur.option_radio[a].set_item_num(a+1),cur.option_radio[a+1]=cur.option_radio[a];"radio"==d&&(cur.option_radio[g+1]=new creat_item(cur,g+1,c,"radio",!0)),"check"==d&&(cur.option_radio[g+1]=new creat_item(cur,g+1,c,"check",!0)),cur.updateItem(),cur.option_radio[g+1].get_item_title().select(),cur.updateReferQ()}},p.onclick=function(){if(isMergeAnswer&&!cur.isMergeNewAdded)return alertNew("很抱歉，在部分修改问卷模式下，为了保持数据一致性不允许删除题目选项！"),void 0;if(cur.option_radio.length>2){c.deleteRow(g);for(var a=g+1;a<cur.option_radio.length;a++)cur.option_radio[a].set_item_num(a-1),cur.option_radio[a-1]=cur.option_radio[a];cur.option_radio.length--,cur.updateItem(),cur.updateReferQ()}else show_status_tip("请至少保留1个选项",4e3)},fb.onclick=function(){return isMergeAnswer&&!cur.isMergeNewAdded?(alertNew("很抱歉，在部分修改问卷模式下，为了保持数据一致性不允许移动题目选项！"),void 0):(g-1>0&&(hb(cur.option_radio[g],cur.option_radio[g-1]),("check"==d||"radio"==d)&&ib(cur.option_radio[g],cur.option_radio[g-1]),jb(cur.option_radio[g],cur.option_radio[g-1]),cur.updateItem(),cur.updateReferQ()),void 0)},gb.onclick=function(){return isMergeAnswer&&!cur.isMergeNewAdded?(alertNew("很抱歉，在部分修改问卷模式下，为了保持数据一致性不允许移动题目选项！"),void 0):(g+1<cur.option_radio.length&&(hb(cur.option_radio[g],cur.option_radio[g+1]),("check"==d||"radio"==d)&&ib(cur.option_radio[g],cur.option_radio[g+1]),jb(cur.option_radio[g],cur.option_radio[g+1]),cur.updateItem(),cur.updateReferQ()),void 0)},this.get_item_add=function(){return o},this.get_item_del=function(){return p},this.get_item_table=function(){return h},this.get_item_tr=function(){return i},this.set_item_num=function(a){g=a},this.get_item_addimg=function(){return C},this.get_item_num=function(){return g},this.get_item_title=function(){return k},this.get_item_check=function(){return db},this.get_item_huchi=function(){return $},this.get_item_tb=function(){return N},this.get_item_jump=function(){return Z},this.get_item_tbr=function(){return R},this.get_item_img=function(){return B},this.get_item_desc=function(){return K},this.get_item_add_desc=function(){return J},this.get_item_imgtext=function(){return H},this.get_item_value=function(){return U},this.get_item_novalue=function(){return V},!0}function setAllRequired(a){var b,c;for(b=0;b<questionHolder.length;b++)c=questionHolder[b].dataNode._type,"cut"!=c&&"page"!=c&&questionHolder[b].dataNode._requir!=a&&(questionHolder[b].get_requir&&(questionHolder[b].get_requir().checked=a),questionHolder[b].dataNode._requir=a,questionHolder[b].setreqstatus());show_status_tip("设置成功！",4e3)}function setAllRandom(){var c,d,a=cur.dataNode._randomChoice,b=cur.dataNode._topic;for(c=0;c<questionHolder.length;c++)d=questionHolder[c].dataNode._topic,0>=d-b||questionHolder[c].dataNode._isCeShi&&"question"!=questionHolder[c].dataNode._type&&(questionHolder[c].dataNode._ispanduan||(questionHolder[c].get_random&&(questionHolder[c].get_random().value=a?"1":"0"),questionHolder[c].dataNode._randomChoice=a));show_status_tip("设置成功！",4e3)}function initAttrHandler(){var a,b;for(firstPage.createAttr=createAttr,a=0;a<questionHolder.length;a++)b=questionHolder[a],setAttrHander(b)}function setAttrHander(a){a.createAttr=createAttr}var pre_satisfaction="很不满意\n不满意\n一般\n满意\n很满意",pre_agree="很不同意\n不同意\n一般\n同意\n很同意",pre_import="很不重要\n不重要\n一般\n重要\n很重要",pre_accord="很不符合\n不符合\n一般\n符合\n很符合",pre_wanting="很不愿意\n不愿意\n一般\n愿意\n很愿意",pre_bool_1="是\n否",pre_bool_2="对\n错",pre_bool_3="满意\n不满意",pre_bool_4="同意\n不同意",pre_bool_5="正确\n错误",pre_bool_6="支持\n反对",pre_bool_7="Ture\nFalse",pre_bool_8="Yes\nNo",currentRelation="",itemImage="",isAutoDelete=!1;initAttrHandler();