!function(undefined){var KE,_needStyle;window.KindEditor===undefined&&(KE={},KE.version="3.5.5",KE.scriptPath=function(){var b,c,d,a=document.getElementsByTagName("script");for(b=0,c=a.length;c>b;b++)if(d=a[b].src,d&&d.match(/kindeditor[\w\-\.]*\.js/))return d.substring(0,d.lastIndexOf("/")+1);return""}(),KE.browser=function(){var a=navigator.userAgent.toLowerCase();return{VERSION:a.match(/(msie|firefox|webkit|opera)[\/:\s](\d+)/)?RegExp.$2:"0",IE:a.indexOf("msie")>-1&&-1==a.indexOf("opera"),GECKO:a.indexOf("gecko")>-1&&-1==a.indexOf("khtml"),WEBKIT:a.indexOf("applewebkit")>-1,OPERA:a.indexOf("opera")>-1}}(),KE.setting={wyswygMode:!0,loadStyleMode:!0,resizeMode:1,filterMode:!0,autoSetDataMode:!1,shadowMode:!0,useContextmenu:!0,pasteHtml:!1,urlType:"",skinType:"default",syncType:"form",newlineTag:"br",dialogAlignType:"page",cssPath:"",skinsPath:KE.scriptPath+"skins/",pluginsPath:KE.scriptPath+"plugins/",minWidth:200,minHeight:100,minChangeSize:5,toolbarLineHeight:24,statusbarHeight:11,items:["fontname","fontsize","textcolor","bgcolor","bold","italic","underline","strikethrough","subscript","superscript","title","justifyleft","justifycenter","justifyright","insertorderedlist","insertunorderedlist","indent","outdent","-","link","unlink","emoticons","image","flash","media","hr","undo","redo","cut","copy","paste","plainpaste","selectall","removeformat","source"],colorTable:[["#FFFFFF","#E5E4E4","#D9D8D8","#C0BDBD","#A7A4A4","#8E8A8B","#827E7F","#767173","#5C585A","#000000"],["#FEFCDF","#FEF4C4","#FEED9B","#FEE573","#FFED43","#F6CC0B","#E0B800","#C9A601","#AD8E00","#8C7301"],["#FFDED3","#FFC4B0","#FF9D7D","#FF7A4E","#FF6600","#E95D00","#D15502","#BA4B01","#A44201","#8D3901"],["#FFD2D0","#FFBAB7","#FE9A95","#FF7A73","#FF483F","#FE2419","#F10B00","#D40A00","#940000","#6D201B"],["#FFDAED","#FFB7DC","#FFA1D1","#FF84C3","#FF57AC","#FD1289","#EC0078","#D6006D","#BB005F","#9B014F"],["#FCD6FE","#FBBCFF","#F9A1FE","#F784FE","#F564FE","#F546FF","#F328FF","#D801E5","#C001CB","#8F0197"],["#E2F0FE","#C7E2FE","#ADD5FE","#92C7FE","#6EB5FF","#48A2FF","#2690FE","#0162F4","#013ADD","#0021B0"],["#D3FDFF","#ACFAFD","#7CFAFF","#4AF7FE","#1DE6FE","#01DEFF","#00CDEC","#01B6DE","#00A0C2","#0084A0"],["#EDFFCF","#DFFEAA","#D1FD88","#BEFA5A","#A8F32A","#8FD80A","#79C101","#3FA701","#307F00","#156200"],["#D4C89F","#DAAD88","#C49578","#C2877E","#AC8295","#C0A5C4","#969AC2","#92B7D7","#80ADAF","#9CA53B"]],noEndTags:["br","hr","img","area","col","embed","input","param"],inlineTags:["b","del","em","font","i","span","strike","strong","sub","sup","u"],endlineTags:["br","hr","table","tbody","td","tr","th","div","p","ol","ul","li","blockquote","h1","h2","h3","h4","h5","h6","script","style","marquee"],htmlTags:{font:["color","size","face",".background-color"],span:["style"],div:["class","align","style"],table:["class","border","cellspacing","cellpadding","width","height","align","style"],"td,th":["class","align","valign","width","height","colspan","rowspan","bgcolor","style"],a:["class","href","target","name","style","data-url"],embed:["src","width","height","type","loop","autostart","flashvars","quality","style","align","allowscriptaccess","/"],img:["src","width","height","border","alt","title","align","style","/"],hr:["class","/"],br:["/"],label:["style"],audio:["src","controls","controlsList"],video:["src","controls","width","height","controlsList"],iframe:["src","width","height","video","allowfullscreen","frameborder"],"p,ol,ul,li,blockquote,h1,h2,h3,h4,h5,h6":["align","style"],"tbody,tr,strong,b,sub,sup,em,i,u,strike":[]},mediaTypes:{rm:"audio/x-pn-realaudio-plugin",flash:"application/x-shockwave-flash",media:"video/x-ms-asf-plugin"},UploadPathType:1,DesignPage:0,afterTab:function(a){KE.util.setSelection(a),KE.util.insertHtml(a,"&nbsp;&nbsp;&nbsp;&nbsp;")}},KE.g={},KE.plugin={},KE.$=function(a,b){var b=b||document;return b.getElementById(a)},KE.$$=function(a,b){var b=b||document;return b.createElement(a)},KE.event={add:function(a,b,c,d){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+b,c),d!==undefined&&KE.g[d].eventStack.push({el:a,type:b,fn:c})},remove:function(a,b,c,d){var e,f,g,h;if(a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent&&a.detachEvent("on"+b,c),d!==undefined)for(e=KE.g[d].eventStack,f=0,g=e.length;g>f;f++)h=e[f],h&&a===h.el&&b===h.type&&c===h.fn&&delete e[f]},stopPropagation:function(a){a.stopPropagation&&a.stopPropagation(),a.cancelBubble!==undefined&&(a.cancelBubble=!0)},preventDefault:function(a){a.preventDefault&&a.preventDefault(),a.returnValue!==undefined&&(a.returnValue=!1)},stop:function(a){this.stopPropagation(a),this.preventDefault(a)},bind:function(a,b,c,d){this.add(a,b,function(a){return c(a),KE.event.stop(a),!1},d)},input:function(a,b,c){function d(a){window.setTimeout(function(){b(a)},1)}this.add(a,"keyup",function(a){return a.ctrlKey||a.altKey||!(a.keyCode<16||a.keyCode>18)||116==a.keyCode?void 0:(b(a),KE.event.stop(a),!1)},c);var e="#document"==a.nodeName?a.body:a;this.add(e,"paste",d,c),this.add(e,"cut",d,c)},ctrl:function(a,b,c,d){b=b.toString().match(/^\d{2,}$/)?b:b.toUpperCase().charCodeAt(0),this.add(a,"keydown",function(a){return!a.ctrlKey||a.keyCode!=b||a.shiftKey||a.altKey?void 0:(c(a),KE.event.stop(a),!1)},d)},ready:function(a,b,c,d){var e,f,g;b=b||window,c=c||document,e=!1,f=function(){e||(e=!0,a())},c.addEventListener?this.add(c,"DOMContentLoaded",f,d):c.attachEvent&&(this.add(c,"readystatechange",function(){"complete"==c.readyState&&f()},d),c.documentElement.doScroll&&"undefined"==typeof b.frameElement&&(g=function(){if(!e){try{c.documentElement.doScroll("left")}catch(a){return window.setTimeout(g,0),void 0}f()}},g())),this.add(b,"load",f,d)}},KE.each=function(a,b){for(var c in a)a.hasOwnProperty(c)&&b(c,a[c])},KE.eachNode=function(a,b){var c=function(a){var d,e;if(1!=KE.util.getNodeType(a))return!0;for(d=a.firstChild;d;){if(e=d.nextSibling,!b(d))return!1;if(!c(d))return!1;d=e}return!0};c(a)},KE.selection=function(a){this.sel=null,this.range=null,this.keRange=null,this.isControl=!1;var b=a.parentWindow||a.defaultView;this.init=function(){var d,f,g,h,i,j,k,l,m,n,o,c=null;a.selection?c=a.selection:b&&(c=b.getSelection());try{d=c.rangeCount>0?c.getRangeAt(0):c.createRange()}catch(e){}if(d||(d=KE.util.createRange(a)),this.sel=c,this.range=d,KE.browser.IE)d.item?(this.isControl=!0,j=d.item(0),f=h=j,g=i=0):(this.isControl=!1,k=function(b){var e,f,g,i,j,k,l,m,n,o,p,q,c=d.duplicate();if(c.collapse(b),e=c.parentElement(),f=e.childNodes,0==f.length)return{node:e,pos:0};for(i=0,j=!1,k=d.duplicate(),KE.util.moveToElementText(k,e),l=0,m=f.length;m>l;l++){if(n=f[l],o=k.compareEndPoints("StartToStart",c),o>0)j=!0;else if(0==o)return 1==n.nodeType?(p=new KE.range(a),p.selectTextNode(n),{node:p.startNode,pos:0}):{node:n,pos:0};1==n.nodeType?(q=d.duplicate(),KE.util.moveToElementText(q,n),k.setEndPoint("StartToEnd",q),j?i+=q.text.replace(/\r\n|\n|\r/g,"").length:i=0):3==n.nodeType&&"string"==typeof n.nodeValue&&(k.moveStart("character",n.nodeValue.length),i+=n.nodeValue.length),j||(g=n)}return j||1!=g.nodeType?(k=d.duplicate(),KE.util.moveToElementText(k,e),k.setEndPoint("StartToEnd",c),i-=k.text.replace(/\r\n|\n|\r/g,"").length,{node:g,pos:i}):(g=e.lastChild,{node:g,pos:1==g.nodeType?1:g.nodeValue.length})},l=k(!0),m=k(!1),f=l.node,g=l.pos,h=m.node,i=m.pos);else{if(f=d.startContainer,g=d.startOffset,h=d.endContainer,i=d.endOffset,1==f.nodeType&&"undefined"!=typeof f.childNodes[g]&&(f=f.childNodes[g],g=0),1==h.nodeType&&(i=0==i?1:i,"undefined"!=typeof h.childNodes[i-1]&&(h=h.childNodes[i-1],i=1==h.nodeType?0:h.nodeValue.length)),this.isControl=1==f.nodeType&&f===h&&d.startOffset+1==d.endOffset,1==f.nodeType&&3==h.nodeType&&0==i&&h.previousSibling)for(n=h.previousSibling;n;){if(n===f){h=f;break}if(1!=n.childNodes.length)break;n=n.childNodes[0]}d.collapsed&&(o=new KE.range(a),o.setTextStart(f,g),h=o.startNode,i=o.startPos)}o=new KE.range(a),o.setTextStart(f,g),o.setTextEnd(h,i),this.keRange=o},this.init(),this.addRange=function(b){var c,d,e,f,g,h,i;KE.browser.GECKO&&KE.browser.VERSION<3||(this.keRange=b,KE.browser.IE?(c=function(c){var f,d=KE.util.createRange(a),e=c?b.startNode:b.endNode;return 1==e.nodeType?(KE.util.moveToElementText(d,e),d.collapse(c)):3==e.nodeType&&(d=KE.util.getNodeStartRange(a,e),f=c?b.startPos:b.endPos,d.moveStart("character",f)),d},this.range.item||(d=b.startNode,d==b.endNode&&1==KE.util.getNodeType(d)&&0==KE.util.getNodeTextLength(d)?(e=a.createTextNode(" "),d.appendChild(e),KE.util.moveToElementText(this.range,d),this.range.collapse(!1),this.range.select(),d.removeChild(e)):(3==d.nodeType&&b.collapsed()?(this.range=c(!0),this.range.collapse(!0)):(this.range.setEndPoint("StartToStart",c(!0)),this.range.setEndPoint("EndToStart",c(!1))),this.range.select()))):(f=function(a){for(var b=0;a;)a=a.previousSibling,b++;return--b},g=new KE.range(a),g.setTextStart(b.startNode,b.startPos),g.setTextEnd(b.endNode,b.endPos),h=g.startNode,i=g.endNode,88==KE.util.getNodeType(h)?this.range.setStart(h.parentNode,f(g.startNode)):this.range.setStart(h,g.startPos),88==KE.util.getNodeType(i)?this.range.setEnd(i.parentNode,f(g.endNode)+1):this.range.setEnd(i,g.endPos),this.sel.removeAllRanges(),this.sel.addRange(this.range)))},this.focus=function(){KE.browser.IE&&null!=this.range&&this.range.select()}},KE.range=function(a){this.startNode=null,this.startPos=null,this.endNode=null,this.endPos=null,this.getParentElement=function(){var d,b=function(a,b){for(;a&&(!a.tagName||"body"!=a.tagName.toLowerCase());)if(a=a.parentNode,b(a))return},c=[];return b(this.startNode,function(a){c.push(a)}),b(this.endNode,function(a){return KE.util.inArray(a,c)?(d=a,!0):void 0}),d?d:a.body},this.getNodeList=function(){var b=this,c=this.getParentElement(),d=[],e=!1;return c==b.startNode&&(e=!0),e&&d.push(c),KE.eachNode(c,function(c){var f,g;return c==b.startNode&&(e=!0),f=new KE.range(a),f.selectTextNode(c),g=f.comparePoints("START_TO_END",b),g>0?!1:0!=g||f.startNode===f.endNode&&f.startPos===f.endPos?(e&&d.push(c),!0):!1}),d},this.comparePoints=function(b,c){var d=function(c,d,e,f){var g,h,i,j;return KE.browser.IE?(h=function(b,c,d){var e=KE.util.createRange(a),f=KE.util.getNodeType(b);return 1==f?(KE.util.moveToElementText(e,b),e.collapse(d)):3==f&&(e=KE.util.getNodeStartRange(a,b),e.moveStart("character",c),e.collapse(!0)),e},i="START_TO_START"==b||"START_TO_END"==b?h(c,d,!0):h(c,d,!1),j="START_TO_START"==b||"END_TO_START"==b?h(e,f,!0):h(e,f,!1),i.compareEndPoints("StartToStart",j)):(i=KE.util.createRange(a),i.selectNode(c),"START_TO_START"==b||"START_TO_END"==b?i.collapse(!0):i.collapse(!1),j=KE.util.createRange(a),j.selectNode(e),"START_TO_START"==b||"END_TO_START"==b?j.collapse(!0):j.collapse(!1),g=i.compareBoundaryPoints(Range.START_TO_START,j)>0?1:0==i.compareBoundaryPoints(Range.START_TO_START,j)?d>f?1:d==f?0:-1:-1,g)};return"START_TO_START"==b?d(this.startNode,this.startPos,c.startNode,c.startPos):"START_TO_END"==b?d(this.startNode,this.startPos,c.endNode,c.endPos):"END_TO_START"==b?d(this.endNode,this.endPos,c.startNode,c.startPos):"END_TO_END"==b?d(this.endNode,this.endPos,c.endNode,c.endPos):void 0},this.collapsed=function(){return this.startNode===this.endNode&&this.startPos===this.endPos},this.collapse=function(a){a?this.setEnd(this.startNode,this.startPos):this.setStart(this.endNode,this.endPos)},this.setTextStart=function(a,b){var c=a;KE.eachNode(a,function(a){return 3==KE.util.getNodeType(a)&&a.nodeValue.length>0||88==KE.util.getNodeType(a)?(c=a,b=0,!1):!0}),this.setStart(c,b)},this.setStart=function(a,b){this.startNode=a,this.startPos=b,null===this.endNode&&(this.endNode=a,this.endPos=b)},this.setTextEnd=function(a,b){var c=a;KE.eachNode(a,function(a){return(3==KE.util.getNodeType(a)&&a.nodeValue.length>0||88==KE.util.getNodeType(a))&&(c=a,b=3==KE.util.getNodeType(a)?a.nodeValue.length:0),!0}),this.setEnd(c,b)},this.setEnd=function(a,b){this.endNode=a,this.endPos=b,null===this.startNode&&(this.startNode=a,this.startPos=b)},this.selectNode=function(a){this.setStart(a,0),this.setEnd(a,1==a.nodeType?0:a.nodeValue.length)},this.selectTextNode=function(a){this.setTextStart(a,0),this.setTextEnd(a,1==a.nodeType?0:a.nodeValue.length)},this.extractContents=function(b){function i(a,c,d){var i,e=a.nodeValue.length,f=a.cloneNode(!0),g=f.splitText(c);return g.splitText(d-c),b&&(i=a,c>0&&(i=a.splitText(c)),e>d&&i.splitText(d-c),h.push(i)),g}function m(h,n){var o,p,q,r,s,t,u,v;if(1!=KE.util.getNodeType(h))return!0;for(o=h.firstChild;o;){if(o==d&&(k=!0),o==f&&(l=!0),p=o.nextSibling,q=o.nodeType,1==q){if(r=new KE.range(a),r.selectNode(o),s=r.comparePoints("END_TO_END",c),k&&(0>s||0==s&&j[o.nodeName.toLowerCase()]!==undefined))t=o.cloneNode(!0),n.appendChild(t),b&&o.parentNode.removeChild(o);else if(u=o.cloneNode(!1),j[u.nodeName.toLowerCase()]===undefined&&(n.appendChild(u),!m(o,u)))return!1}else if(3==q&&k){if(o==d&&o==f)return v=i(o,e,g),n.appendChild(v),!1;if(o==d)v=i(o,e,o.nodeValue.length),n.appendChild(v);else{if(o==f)return v=i(o,0,g),n.appendChild(v),!1;v=i(o,0,o.nodeValue.length),n.appendChild(v)}}if(o=p,l)return!1}return""===n.innerHTML.replace(/<.*?>/g,"")&&n.parentNode&&n.parentNode.removeChild(n),!0}var c,d,e,f,g,h,j,k,l,n,o;return b=b===undefined?!0:b,c=this,d=this.startNode,e=this.startPos,f=this.endNode,g=this.endPos,h=[],j=KE.util.arrayToHash(KE.setting.noEndTags),k=!1,l=!1,n=this.getParentElement(),o=n.cloneNode(!1),m(n,o),KE.each(h,function(a,b){(3!=b.nodeType||b.nodeValue.length>0)&&b.parentNode.removeChild(b)}),o},this.cloneContents=function(){return this.extractContents(!1)},this.getText=function(){var a=this.cloneContents().innerHTML;return a.replace(/<.*?>/g,"")}},KE.cmd=function(a){this.doc=KE.g[a].iframeDoc,this.keSel=KE.g[a].keSel,this.keRange=KE.g[a].keRange,this.mergeAttributes=function(a,b){for(var c=0,d=b.length;d>c;c++)KE.each(b[c],function(b,c){if("."==b.charAt(0)){var d=KE.util.getJsKey(b.substr(1));a.style[d]=c}else KE.browser.IE&&KE.browser.VERSION<8&&"class"==b&&(b="className"),a.setAttribute(b,c)});return a},this.wrapTextNode=function(a,b,c,d,e){var i,j,k,f=a.nodeValue.length,g=0==b&&c==f,h=new KE.range(this.doc);return h.selectTextNode(a.parentNode),g&&a.parentNode.tagName==d.tagName&&h.comparePoints("END_TO_END",this.keRange)<=0&&h.comparePoints("START_TO_START",this.keRange)>=0?(this.mergeAttributes(a.parentNode,e),a):(i=d.cloneNode(!0),g?(j=a.cloneNode(!0),i.appendChild(j),a.parentNode.replaceChild(i,a),j):(k=a,c>b?(b>0&&(k=a.splitText(b)),f>c&&k.splitText(c-b),j=k.cloneNode(!0),i.appendChild(j),k.parentNode.replaceChild(i,k),j):(f>b?(k=a.splitText(b),k.parentNode.insertBefore(i,k)):k.nextSibling?k.parentNode.insertBefore(i,k.nextSibling):k.parentNode.appendChild(i),i)))},this.wrap=function(b,c){var d,e,f,g,h,i,j,k,l;c=c||[],d=this,this.keSel.focus(),e=KE.$$(b,this.doc),this.mergeAttributes(e,c),f=this.keRange,g=f.startNode,h=f.startPos,i=f.endNode,j=f.endPos,k=f.getParentElement(),KE.util.inMarquee(k)||(l=!1,KE.eachNode(k,function(b){var k;if(b==g&&(l=!0),1==b.nodeType){if(b==g&&b==i)return KE.util.inArray(b.tagName.toLowerCase(),KE.g[a].noEndTags)?h>0?b.parentNode.appendChild(e):b.parentNode.insertBefore(e,b):b.appendChild(e),f.selectNode(e),!1;if(b==g)f.setStart(b,0);else if(b==i)return f.setEnd(b,0),!1}else if(3==b.nodeType&&l){if(b==g&&b==i)return k=d.wrapTextNode(b,h,j,e,c),f.selectNode(k),!1;if(b==g)k=d.wrapTextNode(b,h,b.nodeValue.length,e,c),f.setStart(k,0);else{if(b==i)return k=d.wrapTextNode(b,0,j,e,c),f.setEnd(k,1==k.nodeType?0:k.nodeValue.length),!1;d.wrapTextNode(b,0,b.nodeValue.length,e,c)}}return!0}),this.keSel.addRange(f))},this.getTopParent=function(a,b){for(var c=null;b&&(b=b.parentNode,KE.util.inArray(b.tagName.toLowerCase(),a));)c=b;return c},this.splitNodeParent=function(a,b,c){var e,d=new KE.range(this.doc);return d.selectNode(a.firstChild),d.setEnd(b,c),e=d.extractContents(),a.parentNode.insertBefore(e,a),{left:e,right:a}},this.remove=function(a){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,c=this.keRange,d=c.startNode,e=c.startPos,f=c.endNode,g=c.endPos;if(this.keSel.focus(),!KE.util.inMarquee(c.getParentElement())&&(h=""===c.getText().replace(/\s+/g,""),!h||KE.browser.IE)){if(i=[],KE.each(a,function(a){"*"!=a&&i.push(a)}),j=this.getTopParent(i,d),k=this.getTopParent(i,f),j&&(l=this.splitNodeParent(j,d,e),c.setStart(l.right,0),d==f&&KE.util.getNodeTextLength(l.right)>0&&(c.selectNode(l.right),m=new KE.range(this.doc),m.selectTextNode(l.left),e>0&&(g-=m.endNode.nodeValue.length),m.selectTextNode(l.right),f=m.startNode)),h){if(n=c.startNode,1!=n.nodeType)return;if("br"==n.nodeName.toLowerCase())return;c.selectNode(n)}else k&&(o=this.splitNodeParent(k,f,g),c.setEnd(o.left,0),j==k&&c.setStart(o.left,0));for(p=function(a,b){if("."==b.charAt(0)){var c=KE.util.getJsKey(b.substr(1));a.style[c]=""}else KE.browser.IE&&KE.browser.VERSION<8&&"class"==b&&(b="className"),a.removeAttribute(b)},q=c.getNodeList(),c.setTextStart(c.startNode,c.startPos),c.setTextEnd(c.endNode,c.endPos),r=0,s=q.length;s>r;r++)if(n=q[r],1==n.nodeType){if(t=n.tagName.toLowerCase(),a[t])for(u=a[t],v=0,w=u.length;w>v;v++){if("*"==u[v]){KE.util.removeParent(n);break}if(p(n,u[v]),x=[],n.outerHTML?(attrHash=KE.util.getAttrList(n.outerHTML),KE.each(attrHash,function(a,b){x.push({name:a,value:b})})):x=n.attributes,0==x.length){KE.util.removeParent(n);break}if("style"==x[0].name&&""===x[0].value){KE.util.removeParent(n);break}}if(a["*"])for(u=a["*"],v=0,w=u.length;w>v;v++)p(n,u[v])}try{this.keSel.addRange(c)}catch(y){}}}},KE.format={getUrl:function(a,b,c,d){var e,f,g,h;if(!b)return a;if(b=b.toLowerCase(),!KE.util.inArray(b,["absolute","relative","domain"]))return a;if(c=c||location.protocol+"//"+location.host,d===undefined&&(e=location.pathname.match(/^(\/.*)\//),d=e?e[1]:""),f=a.match(/^(\w+:\/\/[^\/]*)/)){if(f[1]!==c)return a}else if(a.match(/^\w+:/))return a;return g=function(a){var c,d,e,b=a.split("/");for(paths=[],c=0,d=b.length;d>c;c++)e=b[c],".."==e?paths.length>0&&paths.pop():""!==e&&"."!=e&&paths.push(e);return"/"+paths.join("/")},a.match(/^\//)?a=c+g(a.substr(1)):a.match(/^\w+:\/\//)||(a=c+g(d+"/"+a)),"relative"==b?(h=function(b,c){var e,f,g,i;if(a.substr(0,b.length)===b){for(e=[],f=0;c>f;f++)e.push("..");return g=".",e.length>0&&(g+="/"+e.join("/")),"/"==d&&(g+="/"),g+a.substr(b.length)}return(i=b.match(/^(.*)\//))?h(i[1],++c):void 0},a=h(c+d,0).substr(2)):"absolute"==b&&a.substr(0,c.length)===c&&(a=a.substr(c.length)),a},getHtml:function(a,b,c){var e,f,g,h,j,k,l,m,d=b?!0:!1;return a=a.replace(/(<pre[^>]*>)([\s\S]*?)(<\/pre>)/gi,function(a,b,c,d){return b+c.replace(/<br[^>]*>/gi,"\n")+d}),e={},f=["xx-small","x-small","small","medium","large","x-large","xx-large"],d&&KE.each(b,function(a,b){var d,f,c=a.split(",");for(d=0,f=c.length;f>d;d++)e[c[d]]=KE.util.arrayToHash(b)}),g=!1,h=KE.util.arrayToHash(KE.setting.noEndTags),KE.util.arrayToHash(KE.setting.inlineTags),j=KE.util.arrayToHash(KE.setting.endlineTags),k=/((?:\r\n|\n|\r)*)<(\/)?([\w\-:]+)((?:\s+|(?:\s+[\w\-:]+)|(?:\s+[\w\-:]+=[^\s"'<>]+)|(?:\s+[\w\-:]+="[^"]*")|(?:\s+[\w\-:]+='[^']*'))*)(\/)?>((?:\r\n|\n|\r)*)/g,a=a.replace(k,function(a,b,i,k,l,m,n){var u,v,o=b||"",p=i||"",q=k.toLowerCase(),r=l||"",s=m?" "+m:"",t=n||"";return"script"===q&&""!==p&&(g=!1),g?a:("script"===q&&""===p&&(g=!0),d&&"undefined"==typeof e[q]?"":(""===s&&"undefined"!=typeof h[q]&&(s=" /"),q in j?(p||s)&&(t="\n"):t&&(t=" "),"script"!==q&&"style"!==q&&(o=""),"audio"==q&&r&&-1==r.indexOf("src")?"":("font"===q&&(u={},v="",r=r.replace(/\s*([\w\-:]+)=([^\s"'<>]+|"[^"]*"|'[^']*')/g,function(a,b,c){var d=b.toLowerCase(),e=c||"";return e=e.replace(/^["']|["']$/g,""),"color"===d?(u["color"]=e," "):"size"===d?(u["font-size"]=f[parseInt(e)-1]||""," "):"face"===d?(u["font-family"]=e," "):"style"===d?(v=e," "):a}),v&&!/;$/.test(v)&&(v+=";"),KE.each(u,function(a,b){""!==b&&(/\s/.test(b)&&(b="'"+b+"'"),v+=a+":"+b+";")}),v&&(r+=' style="'+v+'"'),q="span"),""!==r?(r=r.replace(/\s*([\w\-:]+)=([^\s"'<>]+|"[^"]*"|'[^']*')/g,function(a,b,f){var g=b.toLowerCase(),h=f||"";if(d&&("."===g.charAt(0)||"style"!==g&&"undefined"==typeof e[q][g]))return" ";if(""===h)h='""';else{if("style"===g){if(h=h.substr(1,h.length-2),h=h.replace(/\s*([^\s]+?)\s*:(.*?)(;|$)/g,function(a,b,c){var g,f=b.toLowerCase();return d&&"undefined"==typeof e[q]["style"]&&"undefined"==typeof e[q]["."+f]?"":(g=KE.util.trim(c),g=KE.util.rgbToHex(g),f+":"+g+";")}),h=KE.util.trim(h),""===h)return"";h='"'+h+'"'}KE.util.inArray(g,["src","href"])&&('"'===h.charAt(0)&&(h=h.substr(1,h.length-2)),h=KE.format.getUrl(h,c)),'"'!==h.charAt(0)&&(h='"'+h+'"')}return" "+g+"="+h+" "}),r=r.replace(/\s+(checked|selected|disabled|readonly)(\s+|$)/gi,function(a,b){var c=b.toLowerCase();return!d||"."!==c.charAt(0)&&"undefined"!=typeof e[q][c]?" "+c+'="'+c+'"'+" ":" "}),r=KE.util.trim(r),r=r.replace(/\s+/g," "),r&&(r=" "+r),o+"<"+p+q+r+s+">"+t):o+"<"+p+q+s+">"+t)))}),KE.browser.IE||(a=a.replace(/<p><br\s+\/>\n<\/p>/gi,"<p>&nbsp;</p>"),a=a.replace(/<br\s+\/>\n<\/p>/gi,"</p>")),a=a.replace(/\u200B/g,""),l=KE.setting.inlineTags.join("|"),m=function(a){var b=a.replace(new RegExp("<("+l+")[^>]*><\\/("+l+")>","ig"),function(a,b,c){return b==c?"":a});return a!==b&&(b=m(b)),b},KE.util.trim(m(a))}},KE.attr=function(a,b,c){KE.browser.IE&&KE.browser.VERSION<8&&"class"==b.toLowerCase()&&(b="className"),c=""+c,a.setAttribute(b,c),""===c&&a.removeAttribute(b)},KE.addClass=function(a,b){if("object"==typeof a){var c=a.className;c?(" "+c+" ").indexOf(" "+b+" ")<0&&(a.className=c+" "+b):a.className=b}else"string"==typeof a&&(a=/\s+class\s*=/.test(a)?a.replace(/(\s+class=["']?)([^"']*)(["']?[\s>])/,function(a,c,d,e){return(" "+d+" ").indexOf(" "+b+" ")<0?""===d?c+b+e:c+d+" "+b+e:a}):a.substr(0,a.length-1)+' class="'+b+'">');return a},KE.removeClass=function(a,b){var d,c=a.className||"";return c=" "+c+" ",b=" "+b+" ",c.indexOf(b)>=0&&(c=KE.util.trim(c.replace(new RegExp(b,"ig"),"")),""===c?(d=a.getAttribute("class")?"class":"className",a.removeAttribute(d)):a.className=c),a},KE.getComputedStyle=function(a,b){var g,c=a.ownerDocument,d=c.parentWindow||c.defaultView,e=KE.util.getJsKey(b),f="";return d.getComputedStyle?(g=d.getComputedStyle(a,null),f=g[e]||g.getPropertyValue(b)||a.style[e]):a.currentStyle&&(f=a.currentStyle[e]||a.style[e]),f},KE.getCommonAncestor=function(a,b){function i(a){for(;a;){if(1==a.nodeType&&a.tagName.toLowerCase()===b)return a;a=a.parentNode}return null}var g,h,j,k,c=a.range,d=a.keRange,e=d.startNode,f=d.endNode;return KE.util.inArray(b,["table","td","tr"])&&(KE.browser.IE?c.item?c.item(0).nodeName.toLowerCase()===b&&(e=f=c.item(0)):(g=c.duplicate(),g.collapse(!0),h=c.duplicate(),h.collapse(!1),e=g.parentElement(),f=h.parentElement()):(g=c.cloneRange(),g.collapse(!0),h=c.cloneRange(),h.collapse(!1),e=g.startContainer,f=h.startContainer)),j=i(e),k=i(f),j&&k&&j===k?j:null},KE.queryCommandValue=function(a,b){function c(){var c=a.queryCommandValue(b);return"string"!=typeof c&&(c=""),c}var d,e,f;return b=b.toLowerCase(),d="","fontname"===b?(d=c(),d=d.replace(/['"]/g,"")):"formatblock"===b?(d=c(),""===d&&(e=new KE.selection(a),f=KE.getCommonAncestor(e,"h1"),f||(f=KE.getCommonAncestor(e,"h2")),f||(f=KE.getCommonAncestor(e,"h3")),f||(f=KE.getCommonAncestor(e,"h4")),f||(f=KE.getCommonAncestor(e,"p")),f&&(d=f.nodeName)),"Normal"===d&&(d="p")):"fontsize"===b?(e=new KE.selection(a),f=KE.getCommonAncestor(e,"span"),f&&(d=KE.getComputedStyle(f,"font-size"))):"textcolor"===b?(e=new KE.selection(a),f=KE.getCommonAncestor(e,"span"),f&&(d=KE.getComputedStyle(f,"color")),d=KE.util.rgbToHex(d),""===d&&(d="default")):"bgcolor"===b&&(e=new KE.selection(a),f=KE.getCommonAncestor(e,"span"),f&&(d=KE.getComputedStyle(f,"background-color")),d=KE.util.rgbToHex(d),""===d&&(d="default")),d.toLowerCase()},KE.util={getDocumentElement:function(a){return a=a||document,"CSS1Compat"!=a.compatMode?a.body:a.documentElement},getDocumentHeight:function(a){var b=this.getDocumentElement(a);return Math.max(b.scrollHeight,b.clientHeight)},getDocumentWidth:function(a){var b=this.getDocumentElement(a);return Math.max(b.scrollWidth,b.clientWidth)},createTable:function(a){var b=KE.$$("table",a);return b.cellPadding=0,b.cellSpacing=0,b.border=0,{table:b,cell:b.insertRow(0).insertCell(0)}},loadStyle:function(a){var b=KE.$$("link");b.setAttribute("type","text/css"),b.setAttribute("rel","stylesheet"),b.setAttribute("href",a),document.getElementsByTagName("head")[0].appendChild(b)},getAttrList:function(a){for(var c,d,e,b=/\s+(?:([\w\-:]+)|(?:([\w\-:]+)=([\w\-:]+))|(?:([\w\-:]+)="([^"]*)")|(?:([\w\-:]+)='([^']*)'))(?=(?:\s|\/|>)+)/g,f={};c=b.exec(a);)d=c[1]||c[2]||c[4]||c[6],e=c[1]||(c[2]?c[3]:c[4]?c[5]:c[7]),f[d]=e;return f},inArray:function(a,b){for(var c=0;c<b.length;c++)if(a==b[c])return!0;return!1},trim:function(a){return a.replace(/^\s+|\s+$/g,"")},getJsKey:function(a){var c,d,b=a.split("-");for(a="",c=0,d=b.length;d>c;c++)a+=c>0?b[c].charAt(0).toUpperCase()+b[c].substr(1):b[c];return a},arrayToHash:function(a){var c,d,b={};for(c=0,d=a.length;d>c;c++)b[a[c]]=1;return b},escape:function(a){return a=a.replace(/&/g,"&amp;"),a=a.replace(/</g,"&lt;"),a=a.replace(/>/g,"&gt;"),a=a.replace(/"/g,"&quot;")},unescape:function(a){return a=a.replace(/&lt;/g,"<"),a=a.replace(/&gt;/g,">"),a=a.replace(/&quot;/g,'"'),a=a.replace(/&amp;/g,"&")},getScrollPos:function(){var a,b,c;return KE.browser.IE||KE.browser.OPERA?(c=this.getDocumentElement(),a=c.scrollLeft,b=c.scrollTop):(a=window.scrollX,b=window.scrollY),{x:a,y:b}},getElementPos:function(a){var d,e,f,b=0,c=0;if(a.getBoundingClientRect)d=a.getBoundingClientRect(),e=this.getScrollPos(),b=d.left+e.x,c=d.top+e.y;else for(b=a.offsetLeft,c=a.offsetTop,f=a.offsetParent;f;)b+=f.offsetLeft,c+=f.offsetTop,f=f.offsetParent;return{x:b,y:c}},getCoords:function(a){return a=a||window.event,{x:a.clientX,y:a.clientY}},setOpacity:function(a,b){"undefined"==typeof a.style.opacity?a.style.filter=100==b?"":"alpha(opacity="+b+")":a.style.opacity=100==b?"":b/100},getIframeDoc:function(a){return a.contentDocument||a.contentWindow.document},rgbToHex:function(a){function b(a){return a=parseInt(a).toString(16),a.length>1?a:"0"+a}return a.replace(/rgb\s*?\(\s*?(\d+)\s*?,\s*?(\d+)\s*?,\s*?(\d+)\s*?\)/gi,function(a,c,d,e){return"#"+b(c)+b(d)+b(e)})},parseJson:function(text){var match,cx;if((match=/\{[\s\S]*\}|\[[\s\S]*\]/.exec(text))&&(text=match[0]),cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return eval("("+text+")");throw"JSON parse error"},getParam:function(a,b){return a.match(new RegExp("[?&]"+b+"=([^?&]+)","i"))?unescape(RegExp.$1):""},createRange:function(a){return a.body.createTextRange?a.body.createTextRange():a.createRange()},getNodeType:function(a){return 1==a.nodeType&&KE.util.inArray(a.tagName.toLowerCase(),KE.setting.noEndTags)?88:a.nodeType},inMarquee:function(a){for(var c,b=a;b;){if(c=b.nodeName.toLowerCase(),"marquee"==c||"select"==c)return!0;b=b.parentNode}return!1},moveToElementText:function(a,b){this.inMarquee(b)||a.moveToElementText(b)},getNodeTextLength:function(a){var c,b=KE.util.getNodeType(a);return 1==b?(c=a.innerHTML,c.replace(/<.*?>/gi,"").length):3==b?a.nodeValue.length:void 0},getNodeStartRange:function(a,b){var e,f,g,c=KE.util.createRange(a),d=b.nodeType;if(1==d)return KE.util.moveToElementText(c,b),c;if(3==d){for(e=0,f=b.previousSibling;f;){if(1==f.nodeType)return g=KE.util.createRange(a),KE.util.moveToElementText(g,f),c.setEndPoint("StartToEnd",g),c.moveStart("character",e),c;3==f.nodeType&&(e+=f.nodeValue.length),f=f.previousSibling}return KE.util.moveToElementText(c,b.parentNode),c.moveStart("character",e),c}},removeParent:function(a){var b,c;if(a.hasChildNodes)for(b=a.firstChild;b;)c=b.nextSibling,a.parentNode.insertBefore(b,a),b=c;a.parentNode.removeChild(a)},pluginLang:function(a,b){KE.each(KE.lang.plugins[a],function(a,c){var d=KE.$("lang."+a,b);d&&(d.parentNode.insertBefore(b.createTextNode(c),d),d.parentNode.removeChild(d))})},drag:function(a,b,c,d){var e=KE.g[a];b.onmousedown=function(a){function q(a){var b,c,e,f;p&&(b=KE.util.getCoords(a),c=KE.util.getScrollPos(),e=parseInt(b.y-k-n+c.y),f=parseInt(b.x-l-o+c.x),d(g,h,i,j,e,f))}function s(a){var b,c,f;p&&(b=KE.util.getCoords(a,e.iframeDoc),c=parseInt(r.y+b.y-k-n),f=parseInt(r.x+b.x-l-o),d(g,h,i,j,c,f))}function u(a){return p=!1,b.releaseCapture&&b.releaseCapture(),KE.event.remove(document,"mousemove",q),KE.event.remove(document,"mouseup",u),KE.event.remove(e.iframeDoc,"mousemove",s),KE.event.remove(e.iframeDoc,"mouseup",u),KE.event.remove(document,"selectstart",t),KE.event.stop(a),!1}var f,g,h,i,j,k,l,m,n,o,p,r,t,b=this;return a=a||window.event,f=KE.util.getCoords(a),g=parseInt(c.style.top),h=parseInt(c.style.left),i=c.style.width,j=c.style.height,i.match(/%$/)&&(i=c.offsetWidth+"px"),j.match(/%$/)&&(j=c.offsetHeight+"px"),i=parseInt(i),j=parseInt(j),k=f.y,l=f.x,m=KE.util.getScrollPos(),n=m.y,o=m.x,p=!0,r=KE.util.getElementPos(e.iframe),t=function(){return!1},KE.event.add(document,"mousemove",q),KE.event.add(document,"mouseup",u),KE.event.add(e.iframeDoc,"mousemove",s),KE.event.add(e.iframeDoc,"mouseup",u),KE.event.add(document,"selectstart",t),b.setCapture&&b.setCapture(),KE.event.stop(a),!1}},resize:function(a,b,c,d,e){var f,h;e="undefined"==typeof e?!0:e,f=KE.g[a],f.container&&(d&&(parseInt(b)<=f.minWidth||parseInt(c)<=f.minHeight)||(e&&(f.container.style.width=b),KE.browser.IE&&f.toolbarTable&&f.toolbarTable.offsetHeight,f.container.style.height=c,h=parseInt(c)-f.toolbarHeight-f.statusbarHeight,h>=0&&(f.iframe.style.height=h+"px",f.newTextarea.style.height=((KE.browser.IE&&KE.browser.VERSION<8||"CSS1Compat"!=document.compatMode)&&h>=2?h-2:h)+"px")))},hideLoadingPage:function(a){var b=KE.g[a].dialogStack,c=b[b.length-1];c.loading.style.display="none",c.iframe.style.display=""},showLoadingPage:function(a){var b=KE.g[a].dialogStack,c=b[b.length-1];c.loading.style.display="",c.iframe.style.display="none"},setDefaultPlugin:function(){var d,e,f,b=["selectall","justifyleft","justifycenter","justifyright","justifyfull","insertorderedlist","insertunorderedlist","indent","outdent","subscript","superscript","bold","italic","underline","strikethrough"],c={bold:"B",italic:"I",underline:"U"};for(d=0;d<b.length;d++)e=b[d],f={},e in c&&(f.init=function(a){return function(b){KE.event.ctrl(KE.g[b].iframeDoc,c[a],function(){KE.plugin[a].click(b),KE.util.focus(b)},b)}}(e)),f.click=function(a){return function(b){KE.util.execCommand(b,a,null)}}(e),KE.plugin[e]=f},getFullHtml:function(a){var c,d,e,b="<html>";for(b+="<head>",b+='<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />',b+="<title>KindEditor</title>",b+='<link href="'+KE.g[a].skinsPath+"common/editor.css?ver="+escape(KE.version)+'" rel="stylesheet" type="text/css" />',c=KE.g[a].cssPath,"string"==typeof c&&(c=[c]),d=0,e=c.length;e>d;d++)""!==c[d]&&(b+='<link href="'+c[d]+'" rel="stylesheet" type="text/css" />');return b+="</head>",b+='<body class="ke-content"></body>',b+="</html>"},getMediaType:function(a){return a.match(/\.(rm|rmvb)(\?|$)/i)?"rm":a.match(/\.(swf|flv)(\?|$)/i)?"flash":"media"},getMediaImage:function(a,b,c){var f,g,h,i,d=c.width,e=c.height;return b=b||this.getMediaType(c.src),f=this.getMediaEmbed(c),g="",d>0&&(g+="width:"+d+"px;"),e>0&&(g+="height:"+e+"px;"),h="ke-"+b,i='<img class="'+h+'" src="'+KE.g[a].skinsPath+'common/blank.gif" ',""!==g&&(i+='style="'+g+'" '),i+='kesrctag="'+escape(f)+'" alt="" />'},getMediaEmbed:function(a){var b="<embed ";return KE.each(a,function(a,c){b+=a+'="'+c+'" '}),b+="/>"},execGetHtmlHooks:function(a,b){var d,e,c=KE.g[a].getHtmlHooks;for(d=0,e=c.length;e>d;d++)b=c[d](b);return b},execSetHtmlHooks:function(a,b){var d,e,c=KE.g[a].setHtmlHooks;for(d=0,e=c.length;e>d;d++)b=c[d](b);
return b},execOnchangeHandler:function(a){var c,d,b=KE.g[a].onchangeHandlerStack;for(c=0,d=b.length;d>c;c++)b[c]()},toData:function(a,b){var e,f,g,h,c=KE.g[a],d=this.execGetHtmlHooks(a,b);for(d=d.replace(/^\s*<br[^>]*>\s*$/gi,""),d=d.replace(/^\s*<p>\s*&nbsp;\s*<\/p>\s*$/gi,""),("&nbsp;"==d||"<br />"==d)&&(d=""),d=c.filterMode?KE.format.getHtml(d,c.htmlTags,c.urlType):KE.format.getHtml(d,null,c.urlType),e=d.length,f="<br />",g=f.length,h=e-f.length;e>=g&&d.lastIndexOf(f,h)==h;)d=d.substring(0,h),e=d.length,h=e-g;return d},getData:function(a,b){var c=KE.g[a];return b=b===undefined?c.wyswygMode:b,b||this.innerHtml(c.iframeDoc.body,KE.util.execSetHtmlHooks(a,c.newTextarea.value)),this.toData(a,c.iframeDoc.body.innerHTML)},getSrcData:function(a){var b=KE.g[a];return b.wyswygMode||this.innerHtml(b.iframeDoc.body,KE.util.execSetHtmlHooks(a,b.newTextarea.value)),b.iframeDoc.body.innerHTML},getPureData:function(a){return this.extractText(this.getData(a))},extractText:function(a){return a=a.replace(/<(?!img|embed).*?>/gi,""),a=a.replace(/&nbsp;/gi," ")},isEmpty:function(a){return""===this.getPureData(a).replace(/\r\n|\n|\r/,"").replace(/^\s+|\s+$/,"")},setData:function(a){var c,e,f,g,b=KE.g[a];b.srcTextarea&&(c=this.getData(a),b.srcTextarea.value!=c&&b.hasCreated&&(c.length,e=!1,window.replace_specialChar&&((c.indexOf("§")>-1||c.indexOf("¤")>-1||c.indexOf("〒")>-1)&&(e=!0),c=replace_specialChar(c)),f="</p>",g=c.length-f.length,0==c.indexOf("<p")&&c.indexOf(f)==g&&(c=c.replace(/<\/?p.*?>/gi,""),e=!0),/schemas-microsoft-com|worddocument|mso-\w+/i.test(c)&&(c=KE.removeWord(c),e=!0),e&&this.setFullHtml(a,c),b.srcTextarea.value=c,b.srcTextarea.onchange&&b.srcTextarea.onchange()))},focus:function(a){var b=KE.g[a];b.wyswygMode?b.iframeWin.focus():b.newTextarea.focus()},click:function(a,b){this.focus(a),KE.hideMenu(a),KE.plugin[b].click(a)},selection:function(a){KE.browser.IE&&KE.g[a].keRange||this.setSelection(a)},setSelection:function(a){var b=KE.g[a],c=new KE.selection(b.iframeDoc);(!KE.browser.IE||c.range.item||c.range.parentElement().ownerDocument===b.iframeDoc)&&(b.keSel=c,b.keRange=b.keSel.keRange,b.sel=b.keSel.sel,b.range=b.keSel.range)},select:function(a){KE.browser.IE&&KE.g[a].wyswygMode&&KE.g[a].range&&KE.g[a].range.select()},execCommand:function(a,b,c){var e,f,h;KE.util.focus(a),KE.util.select(a);try{KE.g[a].iframeDoc.execCommand(b,!1,c)}catch(d){}KE.toolbar.updateState(a),KE.util.execOnchangeHandler(a),e=this.getData(a),f="</p>",h=e.length-f.length,0==e.indexOf("<p")&&e.indexOf(f)==h&&(e="<div"+e.substring(2,h)+"</div>",this.setFullHtml(a,e),KE.g[a].srcTextarea.value=e,KE.g[a].srcTextarea.onchange&&KE.g[a].srcTextarea.onchange())},innerHtml:function(a,b){if(KE.browser.IE){a.innerHTML='<img id="__ke_temp_tag__" width="0" height="0" />'+b;var c=KE.$("__ke_temp_tag__",a.ownerDocument);c&&c.parentNode.removeChild(c)}else a.innerHTML=b},pasteHtml:function(a,b,c){var f,g,h,d=KE.g[a],e='<img id="__ke_temp_tag__" width="0" height="0" />';c?b=e+b:b+=e,KE.browser.IE?d.range.item?d.range.item(0).outerHTML=b:d.range.pasteHTML(b):(d.range.deleteContents(),f=d.range.createContextualFragment(b),d.range.insertNode(f)),g=KE.$("__ke_temp_tag__",d.iframeDoc),h=d.iframeDoc.createTextNode(""),g.parentNode.replaceChild(h,g),d.keRange.selectNode(h),d.keSel.addRange(d.keRange)},insertHtml:function(a,b){var c,e,f,g;if(""!==b&&(c=KE.g[a],c.wyswygMode&&c.range)){if(b=this.execSetHtmlHooks(a,b),KE.browser.IE)if(this.select(a),c.range.item)try{c.range.item(0).outerHTML=b}catch(d){e=c.range.item(0),f=e.parentNode,f.removeChild(e),"body"!=f.nodeName.toLowerCase()&&(f=f.parentNode),this.innerHtml(f,b+f.innerHTML)}else c.range.pasteHTML('<span id="__ke_temp_tag__">​</span>'+b),g=KE.$("__ke_temp_tag__",c.iframeDoc),g.parentNode.removeChild(g);else{if(KE.browser.GECKO)return this.execCommand(a,"inserthtml",b),void 0;this.pasteHtml(a,b)}KE.util.execOnchangeHandler(a)}},setFullHtml:function(a,b){var c=KE.g[a];KE.browser.IE||""!==b||(b="<br />"),b=KE.util.execSetHtmlHooks(a,b),this.innerHtml(c.iframeDoc.body,b),c.wyswygMode||(c.newTextarea.value=KE.util.getData(a,!0)),KE.util.execOnchangeHandler(a)},selectImageWebkit:function(a,b,c){var d,e;KE.browser.WEBKIT&&(d=b.srcElement||b.target,"img"==d.tagName.toLowerCase()&&(c&&KE.util.selection(a),e=KE.g[a].keRange,e.selectNode(d),KE.g[a].keSel.addRange(e)))},addTabEvent:function(a){var b=KE.g[a];KE.event.add(b.iframeDoc,"keydown",function(c){return 9==c.keyCode?(b.afterTab&&b.afterTab(a),KE.event.stop(c),!1):void 0},a)},addContextmenuEvent:function(a){var b=KE.g[a];0!=b.contextmenuItems.length&&b.useContextmenu&&KE.event.add(b.iframeDoc,"contextmenu",function(c){var d,e,f,g,h,i,j,k,l;for(KE.hideMenu(a),KE.util.setSelection(a),KE.util.selectImageWebkit(a,c,!1),d=0,e=[],f=0,g=b.contextmenuItems.length;g>f;f++)h=b.contextmenuItems[f],"-"===h?e.push(h):h.cond&&h.cond(a)&&(e.push(h),h.options&&(i=parseInt(h.options.width)||0,i>d&&(d=i))),j=h;for(;e.length>0&&"-"===e[0];)e.shift();for(;e.length>0&&"-"===e[e.length-1];)e.pop();for(j=null,f=0,g=e.length;g>f;f++)"-"===e[f]&&"-"===j&&delete e[f],j=e[f]||null;for(k=new KE.menu({id:a,event:c,type:"contextmenu",width:d}),l=!1,f=0,g=e.length;g>f;f++)h=e[f],h&&("-"===h?g-1>f&&k.addSeparator():(l=!0,k.add(h.text,function(b){return function(){b.click(a,k)}}(h),h.options)));return l||(k.add(KE.lang["copy"],function(){KE.util.select(a),k.hide(),KE.plugin["copy"].click(a)}),k.add(KE.lang["paste"],function(){KE.util.select(a),k.hide(),KE.plugin["pastetextfromword"].click(a)}),k.add(KE.lang["cut"],function(){KE.util.select(a),k.hide(),KE.plugin["cut"].click(a)})),k.show(),KE.event.stop(c),!1},a)},addNewlineEvent:function(a){var b=KE.g[a];KE.browser.IE&&"br"!=b.newlineTag.toLowerCase()||KE.browser.GECKO&&KE.browser.VERSION<3&&"p"!=b.newlineTag.toLowerCase()||KE.browser.OPERA||KE.event.add(b.iframeDoc,"keydown",function(c){var d,e,f,g;if(13!=c.keyCode||c.shiftKey||c.ctrlKey||c.altKey)return!0;if(KE.util.setSelection(a),d=b.keRange.getParentElement(),!KE.util.inMarquee(d)){if(e=d.tagName.toLowerCase(),"br"==b.newlineTag.toLowerCase()){if(!KE.util.inArray(e,["h1","h2","h3","h4","h5","h6","li"]))return KE.util.pasteHtml(a,"<br />"),f=b.keRange.startNode.nextSibling,KE.browser.IE?f||KE.util.pasteHtml(a,"<br />",!0):KE.browser.WEBKIT&&(f?(g=new KE.range(b.iframeDoc),g.selectNode(f.parentNode),g.setStart(f,0),""===g.cloneContents().innerHTML.replace(/<(?!img|embed).*?>/gi,"")&&KE.util.pasteHtml(a,"<br />",!0)):KE.util.pasteHtml(a,"<br />",!0)),KE.event.stop(c),!1}else KE.util.inArray(e,["p","h1","h2","h3","h4","h5","h6","pre","div","li"])||KE.util.execCommand(a,"formatblock","<P>");return!0}},a)}},KE.removeWord=function(a){return a=a.replace(/(<link(?:\s+[^>]*?)?)\s+href\s*=\s*(["']?)\s*file:\/\/.+?\s*\2((?:\s+[^>]*?)?\s*\/?>)/gi,""),a=a.replace(/<!--[\s\S]*?-->|<!(--)?\[[\s\S]+?\](--)?>|<style(\s+[^>]*?)?>[\s\S]*?<\/style>/gi,""),a=a.replace(/<\/?\w+:[^>]*>/gi,""),a=a.replace(/<\/?(span|a|img)(\s+[^>]*?)?>/gi,""),a=a.replace(/(<\w+(?:\s+[^>]*?)?)\s+class\s*=\s*(["']?)\s*mso.+?\s*\2((?:\s+[^>]*?)?\s*\/?>)/gi,"$1$3"),a=a.replace(/(<\w+(?:\s+[^>]*?)?)\s+lang\s*=\s*(["']?)\s*.+?\s*\2((?:\s+[^>]*?)?\s*\/?>)/gi,"$1$3"),a=a.replace(/(<\w+(?:\s+[^>]*?)?)\s+align\s*=\s*(["']?)\s*left\s*\2((?:\s+[^>]*?)?\s*\/?>)/gi,"$1$3"),a=a.replace(/<\w+(?:\s+[^>]*?)?(\s+style\s*=\s*(["']?)\s*(.*?)\s*\2)(?:\s+[^>]*?)?\s*\/?>/gi,function(a,b,c,d){return d=KE.util.trim(d.replace(/\s*(mso-[^:]+:.+?|margin\s*:\s*0cm 0cm 0pt\s*|(text-align|font-variant|line-height)\s*:\s*.+?)(;|$)\s*/gi,"")),a.replace(b,"")})},KE.layout={hide:function(a){var c,d,b=KE.g[a];for(KE.hideMenu(a),c=b.dialogStack;c.length>0;)d=c[c.length-1],d.hide();b.maskDiv.style.display="none"}},KE.hideMenu=function(a){var b=KE.g[a];b.hideDiv.innerHTML="",b.hideDiv.style.display="none"},KE.colorpicker=function(a){function j(){b=KE.$$("div"),b.className="ke-colorpicker",b.style.top=d+"px",b.style.left=c+"px",b.style.zIndex=e}var b,c=a.x||0,d=a.y||0,e=a.z||0,f=a.colors||KE.setting.colorTable,g=a.doc||document,h=a.onclick,i=(a.selectedColor||"").toLowerCase();j.call(this),this.remove=function(){g.body.removeChild(b)},this.getElement=function(){function a(a,b,c){if(i===b.toLowerCase()&&(c+=" ke-colorpicker-cell-selected"),a.className=c,a.title=b||KE.lang["noColor"],a.onmouseover=function(){this.className=c+" ke-colorpicker-cell-on"},a.onmouseout=function(){this.className=c},a.onclick=function(){h(b)},b){var d=KE.$$("div");d.className="ke-colorpicker-cell-color",d.style.backgroundColor=b,a.appendChild(d)}else a.innerHTML=KE.lang["noColor"]}var c,d,e,g,j,b=KE.$$("table");for(b.className="ke-colorpicker-table",b.cellPadding=0,b.cellSpacing=0,b.border=0,c=b.insertRow(0),d=c.insertCell(0),d.colSpan=f[0].length,a(d,"","ke-colorpicker-cell-top"),e=0;e<f.length;e++)for(c=b.insertRow(e+1),g=0;g<f[e].length;g++)j=f[e][g],d=c.insertCell(g),a(d,j,"ke-colorpicker-cell");return b},this.create=function(){b.appendChild(this.getElement()),KE.event.bind(b,"click",function(){}),KE.event.bind(b,"mousedown",function(){}),g.body.appendChild(b)}},KE.menu=function(a){function b(b,c){var g,h,i,j,k,l,d=a.id,e=0,f=0;return"menu"==this.type?(g=KE.g[d].toolbarIcon[a.cmd],h=KE.util.getElementPos(g[0]),e=h.x,f=h.y+g[0].offsetHeight):(h=KE.util.getCoords(a.event),i=KE.util.getElementPos(KE.g[d].iframe),e=h.x+i.x,f=h.y+i.y+5),(b>0||c>0)&&(j=KE.util.getScrollPos(),k=KE.util.getDocumentElement(),l=j.x+k.clientWidth-b-2,e>l&&(e=l)),{x:e,y:f}}function c(){var d,e,c=a.width;this.type=a.type&&"contextmenu"==a.type?a.type:"menu",d=KE.$$("div"),d.className="ke-"+this.type,d.setAttribute("name",a.cmd),e=b.call(this,0,0),d.style.top=e.y+"px",d.style.left=e.x+"px",a.width&&(d.style.width=/^\d+$/.test(c)?c+"px":c),KE.event.bind(d,"click",function(){},a.id),KE.event.bind(d,"mousedown",function(){},a.id),this.div=d}c.call(this),this.add=function(a,b,c){var d,e,g,h,i,j,k,f=!1;c!==undefined&&(d=c.height,e=c.iconHtml,f=c.checked),g=this,h=KE.$$("div"),h.className="ke-"+g.type+"-item",d&&(h.style.height=d),i=KE.$$("div"),i.className="ke-"+this.type+"-left",j=KE.$$("div"),j.className="ke-"+g.type+"-center",d&&(j.style.height=d),k=KE.$$("div"),k.className="ke-"+this.type+"-right",d&&(k.style.lineHeight=d),h.onmouseover=function(){this.className="ke-"+g.type+"-item ke-"+g.type+"-item-on",j.className="ke-"+g.type+"-center ke-"+g.type+"-center-on"},h.onmouseout=function(){this.className="ke-"+g.type+"-item",j.className="ke-"+g.type+"-center"},h.onclick=b,h.appendChild(i),h.appendChild(j),h.appendChild(k),f?KE.util.innerHtml(i,'<span class="ke-common-icon ke-common-icon-url ke-icon-checked"></span>'):e&&KE.util.innerHtml(i,e),KE.util.innerHtml(k,a),this.append(h)},this.addSeparator=function(){var a=KE.$$("div");a.className="ke-"+this.type+"-separator",this.append(a)},this.append=function(a){this.div.appendChild(a)},this.insert=function(a){KE.util.innerHtml(this.div,a)},this.hide=function(){KE.hideMenu(a.id)},this.show=function(){var c,d;this.hide(),c=a.id,KE.g[c].hideDiv.style.display="",KE.g[c].hideDiv.appendChild(this.div),d=b.call(this,this.div.clientWidth,this.div.clientHeight),this.div.style.top=d.y+"px",this.div.style.left=d.x+"px"},this.picker=function(b){var c=KE.g[a.id].colorTable,d=new KE.colorpicker({colors:c,onclick:function(b){KE.plugin[a.cmd].exec(a.id,b)},selectedColor:b});this.append(d.getElement()),this.show()}},KE.button=function(a){a=a||{},doc=a.doc||document;var b=KE.$$("span",doc);return b.className="ke-button-common ke-button-outer "+(a.className||""),b.title=a.text,btn=KE.$$("input",doc),btn.className="ke-button-common ke-button",btn.type="button",btn.value=a.text||"",a.clickFn&&(btn.onclick=a.clickFn),b.appendChild(btn),{span:b,btn:btn}},KE.dialog=function(a){function e(){KE.util.getDocumentElement();var b=KE.util.getScrollPos();c=b.y,d=b.x}function f(){this.beforeHide=a.beforeHide,this.afterHide=a.afterHide,this.beforeShow=a.beforeShow,this.afterShow=a.afterShow,this.ondrag=a.ondrag}function g(){var h,i,j,k,l,b=this.width+this.widthMargin,c=this.height+this.heightMargin,d=a.id,e=KE.g[d],f=0,g=0;return"page"==e.dialogAlignType?(h=KE.util.getDocumentElement(),i=KE.util.getScrollPos(),f=Math.round(i.x+(h.clientWidth-b)/2),g=Math.round(i.y+(h.clientHeight-c)/2)):(j=KE.util.getElementPos(KE.g[d].container),h=e.container,k=Math.round(h.clientWidth/2)-Math.round(b/2),l=Math.round(h.clientHeight/2)-Math.round(c/2),f=0>k?j.x:j.x+k,g=0>l?j.y:j.y+l),f=0>f?0:f,g=0>g?0:g,{x:f,y:g}}this.widthMargin=30,this.heightMargin=100,this.zIndex=19811214,this.width=a.width,this.height=a.height;var c,d;f.call(this),this.resize=function(a,b){a&&(this.width=a),b&&(this.height=b),this.hide(),this.show()},this.hide=function(){var b,c,d,f;this.beforeHide&&this.beforeHide(b),b=a.id,c=KE.g[b].dialogStack,c[c.length-1]==this&&(d=c.pop(),f=d.iframe,f.src="javascript:false",f.parentNode.removeChild(f),document.body.removeChild(this.div),c.length<1&&(KE.g[b].maskDiv.style.display="none"),KE.event.remove(window,"resize",e),KE.event.remove(window,"scroll",e),this.afterHide&&this.afterHide(b),KE.util.focus(b))},this.show=function(){var b,f,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x;this.beforeShow&&this.beforeShow(f),b=this,f=a.id,h=KE.$$("div"),h.className="ke-dialog",KE.event.bind(h,"click",function(){},f),i=KE.g[f].dialogStack,i.length>0&&(this.zIndex=i[i.length-1].zIndex+1),h.style.zIndex=this.zIndex,j=g.call(this),h.style.top=j.y+"px",h.style.left=j.x+"px",KE.g[f].shadowMode?KE.addClass(h,"ke-dialog-shadow"):KE.addClass(h,"ke-dialog-no-shadow"),k=KE.$$("div"),k.className="ke-dialog-title",k.innerHTML=a.title,l=KE.$$("span"),l.className="ke-dialog-close",l.alt=KE.lang["close"],l.title=KE.lang["close"],l.onclick=function(){b.hide(),KE.util.select(f)},k.appendChild(l),e(),KE.event.add(window,"resize",e),KE.event.add(window,"scroll",e),KE.util.drag(f,k,h,function(a,g,i,j,k,l){b.ondrag&&b.ondrag(f),e(),k=a+k,l=g+l,c>k&&(k=c),d>l&&(l=d),h.style.top=k+"px",h.style.left=l+"px"}),h.appendChild(k),m=KE.$$("div"),m.className="ke-dialog-body",n=KE.util.createTable(),n.table.className="ke-loading-table",n.table.style.width=this.width+"px",n.table.style.height=this.height+"px",o=KE.$$("span"),o.className="ke-loading-img",n.cell.appendChild(o),p=0==KE.g[f].dialogStack.length&&KE.g[f].dialog?KE.g[f].dialog:KE.$$("iframe"),p.className=a.useFrameCSS?"ke-dialog-iframe ke-dialog-iframe-border":"ke-dialog-iframe",p.setAttribute("frameBorder","0"),p.style.width=this.width+"px",p.style.height=this.height+"px",p.style.display="none",m.appendChild(p),m.appendChild(n.table),h.appendChild(m),q=KE.$$("div"),q.className="ke-dialog-bottom",r=null,s=null,t=null,a.previewButton&&(u=KE.button({className:"ke-dialog-preview",text:a.previewButton,clickFn:function(){var c=KE.g[f].dialogStack;c[c.length-1]==b&&(a.previewClickFn?a.previewClickFn(f):KE.plugin[a.cmd].preview(f))}}),t=u.btn,q.appendChild(u.span)),a.noButton&&(u=KE.button({className:"ke-dialog-no",text:a.noButton,clickFn:function(){b.hide(),KE.util.select(f)}}),r=u.btn,q.appendChild(u.span)),a.yesButton&&(u=KE.button({className:"ke-dialog-yes",text:a.yesButton,clickFn:function(){var c=KE.g[f].dialogStack;c[c.length-1]==b&&(a.yesClickFn?a.yesClickFn(f):KE.plugin[a.cmd].exec(f))}}),s=u.btn,q.appendChild(u.span)),(a.yesButton||a.noButton||a.previewButton)&&h.appendChild(q),document.body.appendChild(h),KE.event.bind(h,"mousedown",function(){},f),window.focus(),a.html!==undefined?(v=KE.util.getIframeDoc(p),w=KE.util.getFullHtml(f),v.open(),v.write(w),v.close(),KE.util.innerHtml(v.body,a.html)):a.url!==undefined?p.src=a.url:(x="id="+escape(f)+"&ver="+escape(KE.version),a.file===undefined?p.src=KE.g[f].pluginsPath+a.cmd+".html?"+x:(x=(/\?/.test(a.file)?"&":"?")+x,p.src=KE.g[f].pluginsPath+a.file+x)),KE.g[f].maskDiv.style.width=KE.util.getDocumentWidth()+"px",KE.g[f].maskDiv.style.height=KE.util.getDocumentHeight()+"px",KE.g[f].maskDiv.style.display="block",this.iframe=p,this.loading=n.table,this.noButton=r,this.yesButton=s,this.previewButton=t,this.div=h,KE.g[f].dialogStack.push(this),KE.g[f].dialog=p,KE.g[f].yesButton=s,KE.g[f].noButton=r,KE.g[f].previewButton=t,a.loadingMode||KE.util.hideLoadingPage(f),this.afterShow&&this.afterShow(f),KE.g[f].afterDialogCreate&&KE.g[f].afterDialogCreate(f)}},KE.toolbar={updateState:function(a){var c,d,e,b=["justifyleft","justifycenter","justifyright","justifyfull","insertorderedlist","insertunorderedlist","indent","outdent","subscript","superscript","bold","italic","underline","strikethrough"];for(c=0;c<b.length;c++){d=b[c],e=!1;try{e=KE.g[a].iframeDoc.queryCommandState(d)}catch(f){}e?KE.toolbar.select(a,d):KE.toolbar.unselect(a,d)}},isSelected:function(a,b){return KE.plugin[b]&&KE.plugin[b].isSelected?!0:!1},select:function(a,b){if(KE.g[a].toolbarIcon[b]){var c=KE.g[a].toolbarIcon[b][0];c.className="ke-icon ke-icon-selected",c.onmouseover=null,c.onmouseout=null}},unselect:function(a,b){if(KE.g[a].toolbarIcon[b]){var c=KE.g[a].toolbarIcon[b][0];c.className="ke-icon",c.onmouseover=function(){this.className="ke-icon ke-icon-on"},c.onmouseout=function(){this.className="ke-icon"}}},_setAttr:function(a,b,c){b.className="ke-icon",b.href="javascript:;",b.onclick=function(b){b=b||window.event;var d=KE.g[a].hideDiv.firstChild;return d&&d.getAttribute("name")==c?KE.hideMenu(a):KE.util.click(a,c),b.preventDefault&&b.preventDefault(),b.stopPropagation&&b.stopPropagation(),b.cancelBubble!==undefined&&(b.cancelBubble=!0),!1},b.onmouseover=function(){this.className="ke-icon ke-icon-on"},b.onmouseout=function(){this.className="ke-icon"},b.hidefocus=!0,b.title=KE.lang[c]},able:function(a,b){var c=this;KE.each(KE.g[a].toolbarIcon,function(d,e){var f,g;KE.util.inArray(d,b)||(f=e[0],g=e[1],c._setAttr(a,f,d),KE.util.setOpacity(g,100))})},disable:function(a,b){KE.each(KE.g[a].toolbarIcon,function(a,c){var d,e;KE.util.inArray(a,b)||(d=c[0],e=c[1],d.className="ke-icon ke-icon-disabled",KE.util.setOpacity(e,50),d.onclick=null,d.onmouseover=null,d.onmouseout=null)})},create:function(a){var d,e,f,g,h,i,j,k,l,m,n,o,p,b=this,c=KE.util.arrayToHash(KE.setting.items);for(KE.g[a].toolbarIcon=[],d=KE.util.createTable(),e=d.table,e.className="ke-toolbar",e.oncontextmenu=function(){return!1},e.onmousedown=function(){return!1},e.onmousemove=function(){return!1},f=d.cell,g=KE.g[a].items.length,h=0,KE.g[a].toolbarHeight=KE.g[a].toolbarLineHeight,j=0;g>j;j++)k=KE.g[a].items[j],0!=j&&"-"!=k||(l=KE.$$("table"),l.cellPadding=0,l.cellSpacing=0,l.border=0,l.className="ke-toolbar-table",i=l.insertRow(0),h=0,f.appendChild(l),"-"!=k)?(m=i.insertCell(h),m.hideforcus=!0,h++,"|"!=k?(o=KE.$$("a"),o.tabIndex=-1,b._setAttr(a,o,k),p=KE.$$("span"),p.className="undefined"==typeof c[k]?"ke-common-icon ke-icon-"+k:"ke-common-icon ke-common-icon-url ke-icon-"+k,o.appendChild(p),m.appendChild(o),KE.g[a].toolbarIcon[k]=[o,p],KE.toolbar.isSelected(a,k)&&KE.toolbar.select(a,k)):(n=KE.$$("div"),n.className="ke-toolbar-separator",m.appendChild(n))):KE.g[a].toolbarHeight+=KE.g[a].toolbarLineHeight;return e}},KE.history={addStackData:function(a,b){var c="";a.length>0&&(c=a[a.length-1]),(0==a.length||b!==c)&&a.push(b)},add:function(a,b){var e,c=KE.g[a],d=KE.util.getSrcData(a);c.undoStack.length>0&&(e=c.undoStack[c.undoStack.length-1],Math.abs(d.length-e.length)<b)||this.addStackData(c.undoStack,d)},undo:function(a){var c,d,b=KE.g[a];0!=b.undoStack.length&&(c=KE.util.getSrcData(a),this.addStackData(b.redoStack,c),d=b.undoStack.pop(),c===d&&b.undoStack.length>0&&(d=b.undoStack.pop()),d=KE.util.toData(a,d),b.wyswygMode?KE.util.innerHtml(b.iframeDoc.body,KE.util.execSetHtmlHooks(a,d)):b.newTextarea.value=d)},redo:function(a){var c,d,b=KE.g[a];0!=b.redoStack.length&&(c=KE.util.getSrcData(a),this.addStackData(b.undoStack,c),d=b.redoStack.pop(),d=KE.util.toData(a,d),b.wyswygMode?KE.util.innerHtml(b.iframeDoc.body,KE.util.execSetHtmlHooks(a,d)):b.newTextarea.value=d)}},KE.readonly=function(a,b){b=b==undefined?!0:b;var c=KE.g[a];KE.browser.IE?c.iframeDoc.body.contentEditable=b?"false":"true":c.iframeDoc.designMode=b?"off":"on"},KE.focus=function(a,b){if(b=(b||"").toLowerCase(),KE.g[a].container&&(KE.util.focus(a),"end"===b)){if(KE.util.setSelection(a),!KE.g[a].sel)return;var c=KE.g[a].keSel,d=KE.g[a].keRange,e=KE.g[a].iframeDoc;d.selectTextNode(e.body),d.collapse(!1),c.addRange(d)}},KE.blur=function(a){var c,b=KE.g[a];b.container&&(KE.browser.IE?(c=KE.$$("input"),c.type="text",b.container.appendChild(c),c.focus(),b.container.removeChild(c)):b.wyswygMode?b.iframeWin.blur():b.newTextarea.blur())},KE.html=function(a,b){return b===undefined?KE.util.getData(a):(KE.g[a].container&&(KE.util.setFullHtml(a,b),KE.focus(a)),void 0)},KE.text=function(a,b){return b===undefined?(b=KE.html(a),b=b.replace(/<.*?>/gi,""),b=b.replace(/&nbsp;/gi," "),b=KE.util.trim(b)):(KE.html(a,KE.util.escape(b)),void 0)},KE.insertHtml=function(a,b){if(KE.g[a].container){var c=KE.g[a].range;c?(KE.focus(a),KE.util.selection(a),KE.util.insertHtml(a,b)):KE.appendHtml(a,b)}},KE.appendHtml=function(a,b){KE.html(a,KE.html(a)+b)},KE.isEmpty=function(a){return KE.util.isEmpty(a)},KE.selectedHtml=function(a){var c,d,b=KE.g[a].range;return b?(c="",KE.browser.IE?c=b.item?b.item(0).outerHTML:b.htmlText:(d=KE.$$("div",KE.g[a].iframeDoc),d.appendChild(b.cloneContents()),c=d.innerHTML),KE.util.toData(a,c)):""},KE.count=function(a,b){if(b=(b||"html").toLowerCase(),"html"===b)return KE.html(a).length;if("text"===b){var c=KE.util.getPureData(a);return c=c.replace(/<(?:img|embed).*?>/gi,"K"),c=c.replace(/\r\n|\n|\r/g,""),c=KE.util.trim(c),c.length}return 0},KE.sync=function(a){return KE.util.setData(a)},KE.remove=function(a,b){var d,e,f,g,h,i,c=KE.g[a];if(!c.container)return!1;for(b="undefined"==typeof b?0:b,KE.util.setData(a),d=c.container,e=c.eventStack,f=0,g=e.length;g>f;f++)h=e[f],h&&KE.event.remove(h.el,h.type,h.fn,a);c.iframeDoc.src="javascript:false",c.iframe.parentNode.removeChild(c.iframe),1==b?document.body.removeChild(d):(i=c.srcTextarea,i.parentNode.removeChild(d),0==b&&(i.style.display="")),document.body.removeChild(c.hideDiv),document.body.removeChild(c.maskDiv),c.container=null,c.dialogStack=[],c.contextmenuItems=[],c.getHtmlHooks=[],c.setHtmlHooks=[],c.onchangeHandlerStack=[],c.eventStack=[]},KE.create=function(a,b){function E(){KE.hideMenu(a)}function F(){KE.toolbar.updateState(a)}function G(){KE.g[a].afterFocus&&KE.g[a].afterFocus(a)}function H(){KE.g[a].afterBlur&&KE.g[a].afterBlur(a)}function I(){KE.util.setSelection(a)}var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D;if(KE.g[a].beforeCreate&&KE.g[a].beforeCreate(a),KE.browser.IE&&KE.browser.VERSION<7)try{document.execCommand("BackgroundImageCache",!1,!0)}catch(c){}if(d=KE.$(a)||document.getElementsByName(a)[0],b="undefined"==typeof b?0:b,0!=b||!KE.g[a].container){if(e=KE.g[a].width||d.style.width||d.offsetWidth+"px",f=KE.g[a].height||d.style.height||d.offsetHeight+"px",g=KE.util.createTable(),h=g.table,h.className="ke-container",h.style.width=e,h.style.height=f,i=g.cell,i.className="ke-toolbar-outer",j=h.insertRow(1).insertCell(0),j.className="ke-textarea-outer",g=KE.util.createTable(),k=g.table,k.className="ke-textarea-table",l=g.cell,j.appendChild(k),m=h.insertRow(2).insertCell(0),m.className="ke-bottom-outer",d.style.display="none",1==b?document.body.appendChild(h):d.parentNode.insertBefore(h,d),n=KE.toolbar.create(a),n.style.height=KE.g[a].toolbarHeight+"px",i.appendChild(n),o=KE.g[a].iframe||KE.$$("iframe"),o.tabIndex=KE.g[a].tabIndex||d.tabIndex,o.className="ke-iframe",p=!!window.ActiveXObject,q=p&&!window.XMLHttpRequest,q&&(o.src="/html/blank.html"),o.setAttribute("frameBorder","0"),r=KE.$$("textarea"),r.tabIndex=o.tabIndex,r.className="ke-textarea",r.style.display="none",KE.g[a].container=h,KE.g[a].iframe=o,KE.g[a].newTextarea=r,KE.util.resize(a,e,f),l.appendChild(o),l.appendChild(r),s=KE.$$("table"),s.className="ke-bottom",s.cellPadding=0,s.cellSpacing=0,s.border=0,s.style.height=KE.g[a].statusbarHeight+"px",t=s.insertRow(0),u=t.insertCell(0),u.className="ke-bottom-left",v=KE.$$("span"),v.className="ke-bottom-left-img",(0==KE.g[a].config.resizeMode||1==b)&&(u.style.cursor="default",v.style.visibility="hidden"),u.appendChild(v),w=t.insertCell(1),w.className="ke-bottom-right",x=KE.$$("span"),x.className="ke-bottom-right-img",0==KE.g[a].config.resizeMode||1==b?(w.style.cursor="default",x.style.visibility="hidden"):1==KE.g[a].config.resizeMode&&(w.style.cursor="s-resize",x.style.visibility="hidden"),w.appendChild(x),m.appendChild(s),y=KE.$$("div"),y.className="ke-reset",y.style.display="none",z=KE.$$("div"),z.className="ke-mask",KE.util.setOpacity(z,50),KE.event.bind(z,"click",function(){},a),KE.event.bind(z,"mousedown",function(){},a),document.body.appendChild(y),document.body.appendChild(z),KE.util.setDefaultPlugin(a),A=o.contentWindow,B=KE.util.getIframeDoc(o),KE.browser.IE||(B.designMode="on"),C=KE.util.getFullHtml(a),B.open(),B.write(C),B.close(),KE.g[a].wyswygMode||(r.value=KE.util.execSetHtmlHooks(a,d.value),r.style.display="block",o.style.display="none",KE.toolbar.disable(a,["source","fullscreen"]),KE.toolbar.select(a,"source")),"form"==KE.g[a].syncType)for(D=d;D=D.parentNode;)if("form"==D.nodeName.toLowerCase()){KE.event.add(D,"submit",function(){KE.sync(a)},a);break}KE.browser.WEBKIT&&KE.event.add(B,"click",function(b){KE.util.selectImageWebkit(a,b,!0)},a),KE.browser.IE&&KE.event.add(B,"keydown",function(b){var c,d;return 8==b.keyCode&&(c=KE.g[a].range,c.item)?(d=c.item(0),d.parentNode.removeChild(d),KE.util.execOnchangeHandler(a),KE.event.stop(a),!1):void 0},a),KE.event.add(B,"mousedown",E,a),KE.event.add(B,"click",F,a),KE.event.input(B,F,a),KE.event.bind(r,"click",E,a),KE.event.add(document,"click",E,a),KE.event.add(A,"focus",G),KE.event.add(r,"focus",G),KE.event.add(A,"blur",H),KE.event.add(r,"blur",H),KE.g[a].toolbarTable=n,KE.g[a].textareaTable=k,KE.g[a].srcTextarea=d,KE.g[a].bottom=s,KE.g[a].hideDiv=y,KE.g[a].maskDiv=z,KE.g[a].iframeWin=A,KE.g[a].iframeDoc=B,KE.g[a].width=e,KE.g[a].height=f,KE.util.drag(a,w,h,function(b,c,d,e,f,g){2==KE.g[a].resizeMode?KE.util.resize(a,d+g+"px",e+f+"px",!0):1==KE.g[a].resizeMode&&KE.util.resize(a,d+"px",e+f+"px",!0,!1)}),KE.util.drag(a,u,h,function(b,c,d,e,f){KE.g[a].resizeMode>0&&KE.util.resize(a,d+"px",e+f+"px",!0,!1)}),KE.each(KE.plugin,function(b,c){c.init&&c.init(a)}),KE.g[a].getHtmlHooks.push(function(a){return a=a.replace(/(<[^>]*)kesrc="([^"]+)"([^>]*>)/gi,function(a,b,c){return a=a.replace(/(\s+(?:href|src)=")[^"]+(")/i,"$1"+c+"$2"),a=a.replace(/\s+kesrc="[^"]+"/i,"")}),a=a.replace(/(<[^>]+\s)ke-(on\w+="[^"]+"[^>]*>)/gi,function(a,b,c){return b+c})}),KE.g[a].setHtmlHooks.push(function(a){return a=a.replace(/(<[^>]*)(href|src)="([^"]+)"([^>]*>)/gi,function(a,b,c,d,e){return a.match(/\skesrc="[^"]+"/i)?a:a=b+c+'="'+d+'"'+' kesrc="'+d+'"'+e}),a=a.replace(/(<[^>]+\s)(on\w+="[^"]+"[^>]*>)/gi,function(a,b,c){return b+"ke-"+c})}),KE.util.addContextmenuEvent(a),KE.util.addNewlineEvent(a),KE.util.addTabEvent(a),KE.event.input(B,I,a),KE.event.add(B,"mouseup",I,a),KE.event.add(document,"mousedown",I,a),KE.onchange(a,function(a){(KE.g[a].autoSetDataMode||"auto"==KE.g[a].syncType)&&(KE.util.setData(a),KE.g[a].afterSetData&&KE.g[a].afterSetData(a)),KE.g[a].afterChange&&KE.g[a].afterChange(a),KE.history.add(a,KE.g[a].minChangeSize)}),KE.browser.IE&&(B.body.disabled=!0,KE.readonly(a,!1),B.body.removeAttribute("disabled")),KE.util.setFullHtml(a,d.value),KE.history.add(a,0),b>0&&KE.util.focus(a),KE.g[a].afterCreate&&KE.g[a].afterCreate(a),KE.g[a].hasCreated=!0,KE.g[a].pasteHtml||KE.event.ctrl(KE.g[a].iframeDoc,"V",function(){KE.plugin["plainpaste"].click(a)})}},KE.onchange=function(a,b){function d(){b(a)}var c=KE.g[a];c.onchangeHandlerStack.push(d),KE.event.input(c.iframeDoc,d,a),KE.event.input(c.newTextarea,d,a),KE.event.add(c.iframeDoc,"mouseup",function(){window.setTimeout(function(){b(a)},0)},a)},_needStyle=!0,KE.init=function(a){var b=KE.g[a.id]=a;b.config={},b.undoStack=[],b.redoStack=[],b.dialogStack=[],b.contextmenuItems=[],b.getHtmlHooks=[],b.setHtmlHooks=[],b.onchangeHandlerStack=[],b.eventStack=[],KE.each(KE.setting,function(c,d){b[c]="undefined"==typeof a[c]?d:a[c],b.config[c]=b[c]}),b.loadStyleMode&&_needStyle&&(KE.util.loadStyle(b.skinsPath+b.skinType+".css?v=6"),_needStyle=!1)},KE.show=function(a){KE.init(a),KE.event.ready(function(){KE.create(a.id)})},window.KE===undefined&&(window.KE=KE),window.KindEditor=KE)}(),function(a){a.langType="zh_CN",a.lang={source:"HTML代码",undo:"后退(Ctrl+Z)",redo:"前进(Ctrl+Y)",cut:"剪切(Ctrl+X)",copy:"复制(Ctrl+C)",paste:"粘贴(Ctrl+V)",plainpaste:"粘贴为无格式文本",wordpaste:"从Word粘贴",selectall:"全选",justifyleft:"左对齐",justifycenter:"居中",justifyright:"右对齐",justifyfull:"两端对齐",insertorderedlist:"编号",insertunorderedlist:"项目符号",indent:"增加缩进",outdent:"减少缩进",subscript:"下标",superscript:"上标",title:"标题",fontname:"字体",fontsize:"文字大小",textcolor:"文字颜色",bgcolor:"文字背景",bold:"粗体(Ctrl+B)",italic:"斜体(Ctrl+I)",underline:"下划线(Ctrl+U)",strikethrough:"删除线",removeformat:"删除格式",image:"图片",flash:"插入音频视频",media:"插入多媒体",table:"插入表格",hr:"插入横线",emoticons:"插入表情",link:"超级链接",unlink:"取消超级链接",fullscreen:"全屏显示",about:"关于",print:"打印",fileManager:"浏览服务器",advtable:"表格",tablecell:"单元格",yes:"确定",no:"取消",close:"关闭",editImage:"图片属性",deleteImage:"删除图片",editLink:"超级链接属性",deleteLink:"取消超级链接",tableprop:"表格属性",tablecellprop:"单元格属性",tableinsert:"插入表格",tabledelete:"删除表格",tablecolinsertleft:"左侧插入列",tablecolinsertright:"右侧插入列",tablerowinsertabove:"上方插入行",tablerowinsertbelow:"下方插入行",tablecoldelete:"删除列",tablerowdelete:"删除行",noColor:"无颜色",invalidImg:"请输入有效的URL地址。\n只允许jpg,gif,bmp,png格式。",invalidMedia:"请输入有效的URL地址。\n只允许swf,flv,mp3,wav,wma,wmv,mid,avi,mpg,asf,rm,rmvb格式。",invalidWidth:"宽度必须为数字。",invalidHeight:"高度必须为数字。",invalidBorder:"边框必须为数字。",invalidUrl:"请输入有效的URL地址。",invalidRows:"行数为必选项，只允许输入大于0的数字。",invalidCols:"列数为必选项，只允许输入大于0的数字。",invalidPadding:"边距必须为数字。",invalidSpacing:"间距必须为数字。",invalidBorder:"边框必须为数字。",pleaseInput:"请输入内容。",invalidJson:"服务器发生故障。",cutError:"您的浏览器安全设置不允许使用剪切操作，请使用快捷键(Ctrl+X)来完成。",copyError:"您的浏览器安全设置不允许使用复制操作，请使用快捷键(Ctrl+C)来完成。",pasteError:"您的浏览器安全设置不允许使用粘贴操作，请使用快捷键(Ctrl+V)来完成。"};var c=a.lang.plugins={};c.about={version:a.version,title:"HTML可视化编辑器"},c.plainpaste={comment:"请使用快捷键(Ctrl+V)把内容粘贴到下面的方框里。"},c.wordpaste={comment:"请使用快捷键(Ctrl+V)把内容粘贴到下面的方框里。"},c.link={url:"URL地址",linkType:"打开类型",newWindow:"新窗口",selfWindow:"当前窗口"},c.flash={url:"视频网站内容",width:"宽度",height:"高度",autostart:"自动播放（限PC端腾讯视频）"},c.media={url:"媒体文件地址",width:"宽度",height:"高度",autostart:"自动播放"},c.image={remoteImage:"远程图片",localImage:"本地上传",remoteUrl:"图片地址",localUrl:"图片地址",size:"图片大小",width:"宽",height:"高",resetSize:"重置大小",align:"对齐方式",defaultAlign:"默认方式",leftAlign:"左对齐",rightAlign:"右对齐",imgTitle:"图片说明",viewServer:"浏览..."},c.file_manager={emptyFolder:"空文件夹",moveup:"移到上一级文件夹",viewType:"显示方式：",viewImage:"缩略图",listImage:"详细信息",orderType:"排序方式：",fileName:"名称",fileSize:"大小",fileType:"类型"},c.advtable={cells:"单元格数",rows:"行数",cols:"列数",size:"大小",width:"宽度",height:"高度",percent:"%",px:"px",space:"边距间距",padding:"边距",spacing:"间距",align:"对齐方式",textAlign:"水平对齐",verticalAlign:"垂直对齐",alignDefault:"默认",alignLeft:"左对齐",alignCenter:"居中",alignRight:"右对齐",alignTop:"顶部",alignMiddle:"中部",alignBottom:"底部",alignBaseline:"基线",border:"边框",borderWidth:"边框",borderColor:"颜色",backgroundColor:"背景颜色"},c.title={h1:"标题 1",h2:"标题 2",h3:"标题 3",h4:"标题 4",p:"正 文"},c.fontname={fontName:{SimSun:"宋体",NSimSun:"新宋体",FangSong_GB2312:"仿宋_GB2312",KaiTi_GB2312:"楷体_GB2312",SimHei:"黑体","Microsoft YaHei":"微软雅黑",Arial:"Arial","Arial Black":"Arial Black","Times New Roman":"Times New Roman","Courier New":"Courier New",Tahoma:"Tahoma",Verdana:"Verdana"}}}(KindEditor),function(a,b){a.plugin.about={click:function(b){a.util.selection(b);var c=new a.dialog({id:b,cmd:"about",file:"about.html",width:300,height:70,loadingMode:!0,title:a.lang["about"],noButton:a.lang["close"]});c.show()}},a.plugin.undo={init:function(b){a.event.ctrl(a.g[b].iframeDoc,"Z",function(){a.plugin["undo"].click(b),a.util.focus(b)},b),a.event.ctrl(a.g[b].newTextarea,"Z",function(){a.plugin["undo"].click(b),a.util.focus(b)},b)},click:function(b){a.history.undo(b),a.util.execOnchangeHandler(b)
}},a.plugin.redo={init:function(b){a.event.ctrl(a.g[b].iframeDoc,"Y",function(){a.plugin["redo"].click(b),a.util.focus(b)},b),a.event.ctrl(a.g[b].newTextarea,"Y",function(){a.plugin["redo"].click(b),a.util.focus(b)},b)},click:function(b){a.history.redo(b),a.util.execOnchangeHandler(b)}},a.plugin.cut={click:function(b){try{if(!a.g[b].iframeDoc.queryCommandSupported("cut"))throw"e"}catch(c){return alert(a.lang.cutError),void 0}a.util.execCommand(b,"cut",null)}},a.plugin.copy={click:function(b){try{if(!a.g[b].iframeDoc.queryCommandSupported("copy"))throw"e"}catch(c){return alert(a.lang.copyError),void 0}a.util.execCommand(b,"copy",null)}},a.plugin.paste={click:function(b){try{if(!a.g[b].iframeDoc.queryCommandSupported("paste"))throw"e"}catch(c){return alert(a.lang.pasteError),void 0}a.util.execCommand(b,"paste",null)}},a.plugin.pastetextfromword={click:function(b){if(a.util.selection(b),window.clipboardData){var c="";try{c=clipboardData.getData("Text"),c=c.replace(/&/g,"&amp;"),c=c.replace(/</g,"&lt;"),c=c.replace(/>/g,"&gt;"),c=c.replace(/\r\n|\n|\r/g,"<br />"),c=a.removeWord(c),a.util.insertHtml(b,c)}catch(d){a.plugin["plainpaste"].click(b)}}else a.plugin["plainpaste"].click(b)}},a.plugin.plainpaste={click:function(b){a.util.selection(b),this.dialog=new a.dialog({id:b,cmd:"plainpaste",file:"plainpaste.html",width:450,height:300,loadingMode:!0,title:a.lang["plainpaste"],yesButton:a.lang["yes"],noButton:a.lang["no"]}),this.dialog.show()},exec:function(b){var c=a.util.getIframeDoc(this.dialog.iframe),d=a.$("textArea",c).value;d=a.util.escape(d),d="p"==a.g[b].newlineTag?d.replace(/^/,"<p>").replace(/$/,"</p>").replace(/\r\n|\n|\r/g,"</p><p>"):d.replace(/\r\n|\n|\r/g,"<br />"),a.util.insertHtml(b,d),this.dialog.hide(),a.util.focus(b)}},a.plugin.wordpaste={click:function(b){a.util.selection(b),this.dialog=new a.dialog({id:b,cmd:"wordpaste",file:"wordpaste.html",width:450,height:300,loadingMode:!0,title:a.lang["wordpaste"],yesButton:a.lang["yes"],noButton:a.lang["no"]}),this.dialog.show()},exec:function(b){var c=a.util.getIframeDoc(this.dialog.iframe),d=a.$("wordIframe",c),e=a.util.getIframeDoc(d).body.innerHTML;e=a.removeWord(e),e=a.util.execGetHtmlHooks(b,e),e=a.format.getHtml(e,a.g[b].htmlTags,a.g[b].urlType),a.util.insertHtml(b,e),this.dialog.hide(),a.util.focus(b)}},a.plugin.fullscreen={click:function(b){var h,i,c=a.g[b],d=this,e=function(){var b=a.util.getDocumentElement();c.width=b.clientWidth+"px",c.height=b.clientHeight+"px"},f="",g=function(){var g,h;d.isSelected&&(g=a.util.getDocumentElement(),h=[g.clientWidth,g.clientHeight].join(""),f!=h&&(f=h,e(),a.util.resize(b,c.width,c.height)))};this.isSelected?(this.isSelected=!1,a.util.setData(b),a.remove(b,1),c.width=this.width,c.height=this.height,a.create(b,2),document.body.parentNode.style.overflow="auto",a.event.remove(window,"resize",g),c.resizeMode=c.config.resizeMode,a.toolbar.unselect(b,"fullscreen")):(this.isSelected=!0,this.width=c.container.style.width,this.height=c.container.style.height,a.util.setData(b),a.remove(b,2),document.body.parentNode.style.overflow="hidden",e(),a.create(b,1),h=a.util.getScrollPos(),i=c.container,i.style.position="absolute",i.style.left=h.x+"px",i.style.top=h.y+"px",i.style.zIndex=19811211,a.event.add(window,"resize",g),c.resizeMode=0,a.toolbar.select(b,"fullscreen"))}},a.plugin.bgcolor={click:function(b){a.util.selection(b);var c=a.queryCommandValue(a.g[b].iframeDoc,"bgcolor");this.menu=new a.menu({id:b,cmd:"bgcolor"}),this.menu.picker(c)},exec:function(b,c){var d=new a.cmd(b);""==c?d.remove({span:[".background-color"]}):d.wrap("span",[{".background-color":c}]),a.util.execOnchangeHandler(b),this.menu.hide(),a.util.focus(b)}},a.plugin.fontname={click:function(b){var e,f,c=a.lang.plugins.fontname.fontName,d="fontname";a.util.selection(b),e=new a.menu({id:b,cmd:d,width:150}),f=a.queryCommandValue(a.g[b].iframeDoc,d),a.each(c,function(c,g){var h='<span class="ke-reset" style="font-family: '+c+';">'+g+"</span>";e.add(h,function(){a.plugin[d].exec(b,c)},{checked:f===c.toLowerCase()||f===g.toLowerCase()})}),e.show(),this.menu=e},exec:function(b,c){var d=new a.cmd(b);d.wrap("span",[{".font-family":c}]),a.util.execOnchangeHandler(b),this.menu.hide(),a.util.focus(b)}},a.plugin.fontsize={click:function(b){var e,f,g,h,i,j,c=["9px","10px","12px","14px","16px","18px","24px","32px"],d="fontsize";for(a.util.selection(b),e=a.queryCommandValue(a.g[b].iframeDoc,"fontsize"),f=new a.menu({id:b,cmd:d,width:120}),g=0,h=c.length;h>g;g++)i=c[g],j='<span class="ke-reset" style="font-size: '+i+';">'+i+"</span>",f.add(j,function(c){return function(){a.plugin[d].exec(b,c)}}(i),{height:parseInt(i)+12+"px",checked:e===i});f.show(),this.menu=f},exec:function(b,c){var d=new a.cmd(b);d.wrap("span",[{".font-size":c}]),a.util.execOnchangeHandler(b),this.menu.hide(),a.util.focus(b)}},a.plugin.hr={click:function(b){a.util.selection(b),a.util.insertHtml(b,"<hr />"),a.util.focus(b)}},a.plugin.print={click:function(b){a.util.selection(b),a.g[b].iframeWin.print()}},a.plugin.removeformat={click:function(b){var c,d,e,f;for(a.util.selection(b),c=new a.cmd(b),d={"*":["class","style"]},e=0,f=a.g[b].inlineTags.length;f>e;e++)d[a.g[b].inlineTags[e]]=["*"];c.remove(d),a.util.execOnchangeHandler(b),a.toolbar.updateState(b),a.util.focus(b)}},a.plugin.source={click:function(b){var c=a.g[b];c.wyswygMode?(a.hideMenu(b),c.newTextarea.value=a.util.getData(b),c.iframe.style.display="none",c.newTextarea.style.display="block",a.toolbar.disable(b,["source","fullscreen"]),c.wyswygMode=!1,this.isSelected=!0,a.toolbar.select(b,"source")):(a.util.setFullHtml(b,c.newTextarea.value),c.iframe.style.display="block",c.newTextarea.style.display="none",a.toolbar.able(b,["source","fullscreen"]),c.wyswygMode=!0,this.isSelected=!1,a.toolbar.unselect(b,"source")),a.util.focus(b)}},a.plugin.textcolor={click:function(b){a.util.selection(b);var c=a.queryCommandValue(a.g[b].iframeDoc,"textcolor");this.menu=new a.menu({id:b,cmd:"textcolor"}),this.menu.picker(c)},exec:function(b,c){var d=new a.cmd(b);""==c?d.remove({span:[".color"],font:["color"]}):d.wrap("span",[{".color":c}]),a.util.execOnchangeHandler(b),this.menu.hide(),a.util.focus(b)}},a.plugin.title={click:function(b){var g,h,c=a.lang.plugins.title,d={H1:c.h1,H2:c.h2,H3:c.h3,H4:c.h4,P:c.p},e={H1:28,H2:24,H3:18,H4:14,P:12},f="title";a.util.selection(b),g=a.queryCommandValue(a.g[b].iframeDoc,"formatblock"),h=new a.menu({id:b,cmd:f,width:"en"==a.langType?200:150}),a.each(d,function(c,d){var j,i="font-size:"+e[c]+"px;";"P"!==c&&(i+="font-weight:bold;"),j='<span class="ke-reset" style="'+i+'">'+d+"</span>",h.add(j,function(){a.plugin[f].exec(b,"<"+c+">")},{height:e[c]+12+"px",checked:g===c.toLowerCase()||g===d.toLowerCase()})}),h.show(),this.menu=h},exec:function(b,c){a.util.select(b),a.util.execCommand(b,"formatblock",c),this.menu.hide(),a.util.focus(b)}},a.plugin.emoticons={click:function(c){function s(b){var h,k,m,o,p,s,e=a.$$("table");for(q&&(e.onmouseover=function(){q.style.display="block"},e.onmouseout=function(){q.style.display="none"}),e.className="ke-plugin-emoticons-table",e.cellPadding=0,e.cellSpacing=0,e.border=0,h=(b-1)*j+i,k=0;f>k;k++)for(m=e.insertRow(k),o=0;g>o;o++)p=m.insertCell(o),p.className="ke-plugin-emoticons-cell",p.onmouseover=q?function(a,b){return function(){a>l?(q.style.left=0,q.style.right=""):(q.style.left="",q.style.right=0),r.src=n+b+".gif",this.className="ke-plugin-emoticons-cell ke-plugin-emoticons-cell-on"}}(o,h):function(){this.className="ke-plugin-emoticons-cell ke-plugin-emoticons-cell-on"},p.onmouseout=function(){this.className="ke-plugin-emoticons-cell"},p.onclick=function(a){return function(){return d.exec(c,a),!1}}(h),s=a.$$("span"),s.className="ke-plugin-emoticons-img",s.style.backgroundPosition="-"+24*h+"px 0px",p.appendChild(s),h++;return e}function v(b){var c,d;for(c=1;k>=c;c++)b!==c?(d=a.$$("a"),d.href="javascript:;",d.innerHTML="["+c+"]",d.onclick=function(a){return function(){p.removeChild(t);var b=s(a);return p.insertBefore(b,u),t=b,u.innerHTML="",v(a),!1}}(c),u.appendChild(d)):u.appendChild(document.createTextNode("["+c+"]")),u.appendChild(document.createTextNode(" "))}var p,q,r,t,u,w,d=this,e="emoticons",f=5,g=9,h=135,i=0,j=f*g,k=Math.ceil(h/j),l=Math.floor(g/2),m=a.g[c],n=m.pluginsPath+"emoticons/",o=m.allowPreviewEmoticons===b?!0:m.allowPreviewEmoticons;a.util.selection(c),p=a.$$("div"),p.className="ke-plugin-emoticons-wrapper",o&&(q=a.$$("div"),q.className="ke-plugin-emoticons-preview",q.style.right=0,r=a.$$("img"),r.className="ke-reset",r.src=n+"0.gif",r.border=0,q.appendChild(r),p.appendChild(q)),t=s(1),p.appendChild(t),u=a.$$("div"),u.className="ke-plugin-emoticons-page",p.appendChild(u),v(1),w=new a.menu({id:c,cmd:e}),w.append(p),w.show(),this.menu=w},exec:function(b,c){var d=a.g[b].pluginsPath+"emoticons/"+c+".gif",e='<img src="'+d+'" kesrc="'+d+'" alt="" />';a.util.insertHtml(b,e),this.menu.hide(),a.util.focus(b)}},a.plugin.flash={init:function(b){a.g[b].getHtmlHooks.push(function(b){return b.replace(/<img[^>]*class="?ke-flash"?[^>]*>/gi,function(b){var e,c=b.match(/style="[^"]*;?\s*width:\s*(\d+)/i)?RegExp.$1:0,d=b.match(/style="[^"]*;?\s*height:\s*(\d+)/i)?RegExp.$1:0;return c=c||(b.match(/width="([^"]+)"/i)?RegExp.$1:0),d=d||(b.match(/height="([^"]+)"/i)?RegExp.$1:0),b.match(/kesrctag="([^"]+)"/i)?(e=a.util.getAttrList(unescape(RegExp.$1)),e.width=c||e.width||0,e.height=d||e.height||0,e.kesrc=e.src,a.util.getMediaEmbed(e)):void 0})}),a.g[b].setHtmlHooks.push(function(c){return c.replace(/<embed[^>]*type="application\/x-shockwave-flash"[^>]*>(?:<\/embed>)?/gi,function(c){var e,f,g,d=c.match(/\s+src="([^"]+)"/i)?RegExp.$1:"";return c.match(/\s+kesrc="([^"]+)"/i)&&(d=RegExp.$1),e=c.match(/\s+width="([^"]+)"/i)?RegExp.$1:0,f=c.match(/\s+height="([^"]+)"/i)?RegExp.$1:0,g=a.util.getAttrList(c),g.src=d,g.width=e,g.height=f,a.util.getMediaImage(b,"flash",g)})})},click:function(b){a.util.selection(b),this.dialog=new a.dialog({id:b,cmd:"flash",file:"video.aspx",width:502,height:202,loadingMode:!0,title:a.lang["flash"],yesButton:a.lang["yes"],noButton:a.lang["no"]}),this.dialog.show()},check:function(b,c){var f=a.util.getIframeDoc(this.dialog.iframe);return c.match(/^.{3,}$/)?!0:(alert(a.lang["invalidUrl"]),a.$("url",f).focus(),!1)},exec:function(b){var e,f,g,h,i,j,k,l,m,c=a.util.getIframeDoc(this.dialog.iframe),d=a.$("url",c).value;return d?(e=d,-1==d.indexOf("<iframe")?(f=d.indexOf(".clouddn.com/")>-1||d.indexOf(".qnssl.com/")||d.indexOf(".paperol.cn/"),f?(g=d.indexOf(".mp3")>-1||d.indexOf(".wav")>-1,h="",h=g?'<audio src="'+d+'"  controls="controls" controlsList="nodownload"></audio>':'<video src="'+d+'"  width="320" height="240" controls="controls" controlsList="nodownload">Your browser does not support the video tag.</video>',a.util.insertHtml(b,h),this.dialog.hide(),a.util.focus(b),void 0):(alert("请复制通用代码插入视频，如有疑问请按帮助进行操作！"),!1)):(i=/(src\=\"[^\s\"\']+)/g,j=d.match(i),j||(j=d.match(/(\/\/[^\s\"\']+)/g)),d=j[0]||"",(d=d.replace('src="',""))?(k=640,l=498,m=a.$("autostart",c).checked,d=d.replace("&tiny=0","&tiny=1"),m&&(d.indexOf(".tudou.com")>-1?d+="&autoplay=true":d=d.replace("&auto=0","&auto=1")),this.check(b,d,k,l)?(d=d.replace("http://","//").replace("https://","//"),h='<iframe frameborder="0" width="640" video="1" height="400" src="'+d+'" allowfullscreen></iframe>',0==d.indexOf("//music.163.com")||d.indexOf("audio.paperol.cn")>-1&&d.indexOf(".mp3")>1?(m&&d.indexOf("audio.paperol.cn")>-1&&d.indexOf(".mp3")>1&&(d+="&auto=1"),h='<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="90%" height="80" src="'+d+'"></iframe>'):d.indexOf(".paperol.cn")>-1&&(h=e),a.util.insertHtml(b,h),this.dialog.hide(),a.util.focus(b),void 0):!1):!1)):(this.dialog.hide(),void 0)}},a.plugin.image={getSelectedNode:function(b){var c=a.g[b],d=c.keRange.startNode,e=c.keRange.endNode;if((a.browser.WEBKIT||c.keSel.isControl)&&1==d.nodeType&&"img"==d.tagName.toLowerCase()&&d==e)return d.className.match(/^ke-\w+/i)?void 0:d},init:function(b){var c=this,d=a.g[b];d.contextmenuItems.push({text:a.lang["editImage"],click:function(b,d){a.util.select(b),d.hide(),c.click(b)},cond:function(a){return c.getSelectedNode(a)},options:{width:"150px",iconHtml:'<span class="ke-common-icon ke-common-icon-url ke-icon-image"></span>'}}),d.contextmenuItems.push({text:a.lang["deleteImage"],click:function(b,d){a.util.select(b),d.hide();var e=c.getSelectedNode(b);e.parentNode.removeChild(e),a.util.execOnchangeHandler(b)},cond:function(a){return c.getSelectedNode(a)},options:{width:"150px"}}),d.contextmenuItems.push("-")},click:function(b){a.util.selection(b);var c="";window.parActivityId&&(c="&activity="+window.parActivityId),this.dialog=new a.dialog({id:b,cmd:"image",file:"image/fckuploadimg.aspx?id="+b+"&upt="+a.g[b].config.UploadPathType+"&design="+a.g[b].config.DesignPage+c+"&txtid="+b,width:620,height:480,loadingMode:!1,title:a.lang["image"]}),this.dialog.show(),this.dialog.div&&(this.dialog.div.style.background="white")},addEditorImage:function(a,c){a!=b&&this.insert(c,a,"",0,0,0,align)},check:function(){var h,c=a.util.getIframeDoc(this.dialog.iframe),d=a.$("type",c).value,e=a.$("imgWidth",c).value,f=a.$("imgHeight",c).value;return a.$("imgTitle",c).value,h=2==d?a.$("imgFile",c):a.$("url",c),h.value.match(/\.(jpg|jpeg|gif|bmp|png)(\s|\?|$)/i)?e.match(/^\d*$/)?f.match(/^\d*$/)?!0:(alert(a.lang["invalidHeight"]),a.$("imgHeight",c).focus(),!1):(alert(a.lang["invalidWidth"]),a.$("imgWidth",c).focus(),!1):(alert(a.lang["invalidImg"]),h.focus(),!1)},exec:function(b){var k,l,m,n,o,c=this,d=a.util.getIframeDoc(this.dialog.iframe),e=a.$("type",d).value,f=a.$("imgWidth",d).value,g=a.$("imgHeight",d).value,h=a.$("imgTitle",d).value,i=d.getElementsByName("align"),j="";for(k=0,l=i.length;l>k;k++)if(i[k].checked){j=i[k].value;break}return this.check(b)?2==e?(a.$("editorId",d).value=b,m=a.$("uploadIframe",d),a.util.showLoadingPage(b),n=function(){var d,e,k;a.event.remove(m,"load",n),a.util.hideLoadingPage(b),d=a.util.getIframeDoc(m),e="";try{e=a.util.parseJson(d.body.innerHTML)}catch(i){alert(a.lang.invalidJson)}if("object"==typeof e&&"error"in e){if(0!==e.error)return alert(e.message),!1;k=a.format.getUrl(e.url,"absolute"),c.insert(b,k,h,f,g,0,j)}},a.event.add(m,"load",n),d.uploadForm.submit(),void 0):(o=a.$("url",d).value,this.insert(b,o,h,f,g,0,j),void 0):!1},insert:function(b,c,d,e,f,g,h){var i='<img src="'+c+'" kesrc="'+c+'" ';e>0&&(i+='width="'+e+'" '),f>0&&(i+='height="'+f+'" '),d&&(i+='title="'+d+'" '),h&&(i+='align="'+h+'" '),i+='alt="'+d+'" ',g&&(i+='border="'+g+'" '),i+="/>",a.util.insertHtml(b,i),this.dialog.hide(),a.util.focus(b)}},a.plugin.link={getSelectedNode:function(b){return a.getCommonAncestor(a.g[b].keSel,"a")},init:function(b){var c=this;a.g[b].contextmenuItems.push({text:a.lang["editLink"],click:function(b,d){a.util.select(b),d.hide(),c.click(b)},cond:function(a){return c.getSelectedNode(a)},options:{width:"150px",iconHtml:'<span class="ke-common-icon ke-common-icon-url ke-icon-link"></span>'}})},click:function(b){a.util.selection(b),this.dialog=new a.dialog({id:b,cmd:"link",file:"link/link.html",width:400,height:90,loadingMode:!0,title:a.lang["link"],yesButton:a.lang["yes"],noButton:a.lang["no"]}),this.dialog.show()},exec:function(b){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,c=a.g[b];if(a.util.select(b),d=c.keRange,e=d.startNode,f=d.endNode,g=c.iframeDoc,h=a.util.getIframeDoc(this.dialog.iframe),i=a.$("hyperLink",h).value,j=a.$("linkType",h).value,!i.match(/.+/)||i.match(/^\w+:\/\/\/?$/))return alert(a.lang["invalidUrl"]),a.$("hyperLink",h).focus(),!1;for(k=d.getParentElement();k&&"a"!=k.tagName.toLowerCase()&&"body"!=k.tagName.toLowerCase();)k=k.parentNode;if(k=k.parentNode,l=a.browser.IE?!!c.range.item:1==e.nodeType&&e===f&&"br"!=e.nodeName.toLowerCase(),m=!l,l||(m=a.browser.IE?""===c.range.text:""===c.range.toString()),m||a.util.isEmpty(b))n=window.activityID||"",o="https://r.wjx.com/redirect.aspx?url="+encodeURIComponent(i)+"&activity="+n,p='<a href="'+o+'" data-url="'+i+'"',j&&(p+=' target="'+j+'"'),p+=">"+i+"</a>",a.util.insertHtml(b,p);else{for(g.execCommand("createlink",!1,"__ke_temp_url__"),q=k.getElementsByTagName("a"),r=0,s=q.length;s>r;r++)q[r].href.match(/\/?__ke_temp_url__$/)&&(n=window.activityID||"",o="https://r.wjx.com/redirect.aspx?url="+encodeURIComponent(i)+"&activity="+n,q[r].href=o,q[r].setAttribute("data-url",i),j?q[r].target=j:q[r].removeAttribute("target"));a.browser.WEBKIT&&l&&"img"==e.tagName.toLowerCase()&&(t=e.parentNode,"a"!=t.tagName.toLowerCase()&&(u=a.$$("a",g),t.insertBefore(u,e),u.appendChild(e),t=u),n=window.activityID||"",o="https://r.wjx.com/redirect.aspx?url="+encodeURIComponent(i)+"&activity="+n,t.href=o,t.setAttribute("data-url",i),j?t.target=j:t.removeAttribute("target"),c.keSel.addRange(d))}a.util.execOnchangeHandler(b),this.dialog.hide(),a.util.focus(b)}},a.plugin.unlink={init:function(b){var c=this;a.g[b].contextmenuItems.push({text:a.lang["deleteLink"],click:function(b,d){a.util.select(b),d.hide(),c.click(b)},cond:function(b){return a.plugin["link"].getSelectedNode(b)},options:{width:"150px",iconHtml:'<span class="ke-common-icon ke-common-icon-url ke-icon-unlink"></span>'}}),a.g[b].contextmenuItems.push("-")},click:function(b){var e,f,g,h,i,j,k,c=a.g[b],d=c.iframeDoc;if(a.util.selection(b),e=c.keRange,f=e.startNode,g=e.endNode,h=1==f.nodeType&&f===g,i=!h,h||(i=a.browser.IE?""===c.range.text:""===c.range.toString()),i){if(j=a.plugin["link"].getSelectedNode(b),!j)return;e=c.keRange,e.selectTextNode(j),c.keSel.addRange(e),a.util.select(b),d.execCommand("unlink",!1,null),a.browser.WEBKIT&&"img"==f.tagName.toLowerCase()&&(k=f.parentNode,"a"==k.tagName.toLowerCase()&&(a.util.removeParent(k),c.keSel.addRange(e)))}else d.execCommand("unlink",!1,null);a.util.execOnchangeHandler(b),a.toolbar.updateState(b),a.util.focus(b)}},a.plugin.media={init:function(b){var d={};a.each(a.g[b].mediaTypes,function(a,b){d[b]=a}),a.g[b].getHtmlHooks.push(function(b){return b.replace(/<img[^>]*class="?ke-\w+"?[^>]*>/gi,function(b){var e,c=b.match(/style="[^"]*;?\s*width:\s*(\d+)/i)?RegExp.$1:0,d=b.match(/style="[^"]*;?\s*height:\s*(\d+)/i)?RegExp.$1:0;return c=c||(b.match(/width="([^"]+)"/i)?RegExp.$1:0),d=d||(b.match(/height="([^"]+)"/i)?RegExp.$1:0),b.match(/\s+kesrctag="([^"]+)"/i)?(e=a.util.getAttrList(unescape(RegExp.$1)),e.width=c||e.width||0,e.height=d||e.height||0,e.kesrc=e.src,a.util.getMediaEmbed(e)):void 0})}),a.g[b].setHtmlHooks.push(function(c){return c.replace(/<embed[^>]*type="([^"]+)"[^>]*>(?:<\/embed>)?/gi,function(c,e){var f,g,h,i;return"undefined"==typeof d[e]?c:(f=c.match(/\s+src="([^"]+)"/i)?RegExp.$1:"",c.match(/\s+kesrc="([^"]+)"/i)&&(f=RegExp.$1),g=c.match(/\s+width="([^"]+)"/i)?RegExp.$1:0,h=c.match(/\s+height="([^"]+)"/i)?RegExp.$1:0,i=a.util.getAttrList(c),i.src=f,i.width=g,i.height=h,a.util.getMediaImage(b,"",i))})})},click:function(b){a.util.selection(b),this.dialog=new a.dialog({id:b,cmd:"media",file:"media.html",width:400,height:170,loadingMode:!0,title:a.lang["media"],yesButton:a.lang["yes"],noButton:a.lang["no"]}),this.dialog.show()},check:function(b,c,d,e){var f=a.util.getIframeDoc(this.dialog.iframe);return c.match(/^.{3,}\.(swf|flv|mp3|wav|wma|wmv|mid|avi|mpg|mpeg|asf|rm|rmvb)(\?|$)/i)?d.match(/^\d*$/)?e.match(/^\d*$/)?!0:(alert(a.lang["invalidHeight"]),a.$("height",f).focus(),!1):(alert(a.lang["invalidWidth"]),a.$("width",f).focus(),!1):(alert(a.lang["invalidMedia"]),a.$("url",f).focus(),!1)},exec:function(b){var g,h,c=a.util.getIframeDoc(this.dialog.iframe),d=a.$("url",c).value,e=a.$("width",c).value,f=a.$("height",c).value;return this.check(b,d,e,f)?(g=a.$("autostart",c).checked?"true":"false",h=a.util.getMediaImage(b,"",{src:d,type:a.g[b].mediaTypes[a.util.getMediaType(d)],width:e,height:f,autostart:g,loop:"true"}),a.util.insertHtml(b,h),this.dialog.hide(),a.util.focus(b),void 0):!1}},a.plugin.advtable={getSelectedTable:function(b){return a.getCommonAncestor(a.g[b].keSel,"table")},getSelectedRow:function(b){return a.getCommonAncestor(a.g[b].keSel,"tr")},getSelectedCell:function(b){return a.getCommonAncestor(a.g[b].keSel,"td")},tableprop:function(a){this.click(a)},tablecellprop:function(b){var d,c=this;a.util.selection(b),d=new a.dialog({id:b,cmd:"advtable",file:"advtable/cell.html",width:420,height:150,loadingMode:!0,title:a.lang["tablecell"],yesButton:a.lang["yes"],noButton:a.lang["no"],yesClickFn:function(b){var x,e=a.util.getIframeDoc(d.iframe),f=a.$("width",e),g=a.$("height",e),h=a.$("widthType",e),i=a.$("heightType",e),j=a.$("textAlign",e),k=a.$("verticalAlign",e),l=a.$("border",e),m=a.$("borderColor",e),n=a.$("backgroundColor",e),o=f.value,p=g.value,q=h.value,r=i.value,s=j.value,t=k.value,u=l.value,v=m.innerHTML,w=n.innerHTML;return o.match(/^\d*$/)?p.match(/^\d*$/)?u.match(/^\d*$/)?(x=c.getSelectedCell(b),x.style.width=""!==o?o+q:"",x.style.height=""!==p?p+r:"",x.style.backgroundColor=w,x.style.textAlign=s,x.style.verticalAlign=t,x.style.borderWidth=u,x.style.borderStyle=""!==u?"solid":"",x.style.borderColor=v,a.util.execOnchangeHandler(b),d.hide(),a.util.focus(b),void 0):(alert(a.lang["invalidBorder"]),l.focus(),!1):(alert(a.lang["invalidHeight"]),g.focus(),!1):(alert(a.lang["invalidWidth"]),f.focus(),!1)}}),d.show()},tableinsert:function(a){this.click(a,"insert")},tabledelete:function(a){var b=this.getSelectedTable(a);b.parentNode.removeChild(b)},tablecolinsert:function(a,b){var f,g,h,c=this.getSelectedTable(a),d=this.getSelectedCell(a),e=d.cellIndex+b;for(f=0,g=c.rows.length;g>f;f++)h=c.rows[f].insertCell(e),h.innerHTML="&nbsp;"},tablecolinsertleft:function(a){this.tablecolinsert(a,0)},tablecolinsertright:function(a){this.tablecolinsert(a,1)},tablerowinsert:function(a,b){var f,g,h,c=this.getSelectedTable(a),d=this.getSelectedRow(a),e=c.insertRow(d.rowIndex+b);for(f=0,g=d.cells.length;g>f;f++)h=e.insertCell(f),h.innerHTML="&nbsp;"},tablerowinsertabove:function(a){this.tablerowinsert(a,0)},tablerowinsertbelow:function(a){this.tablerowinsert(a,1)},tablecoldelete:function(a){var e,f,b=this.getSelectedTable(a),c=this.getSelectedCell(a),d=c.cellIndex;for(e=0,f=b.rows.length;f>e;e++)b.rows[e].deleteCell(d)},tablerowdelete:function(a){var b=this.getSelectedTable(a),c=this.getSelectedRow(a);b.deleteRow(c.rowIndex)},init:function(c){var g,h,i,d=this,e="ke-zeroborder",f="prop,cellprop,colinsertleft,colinsertright,rowinsertabove,rowinsertbelow,coldelete,rowdelete,insert,delete".split(",");for(g=0,h=f.length;h>g;g++)i="table"+f[g],a.g[c].contextmenuItems.push({text:a.lang[i],click:function(c){return function(e,f){a.util.select(e),f.hide(),d[c]!==b&&d[c](e),/prop/.test(c)||a.util.execOnchangeHandler(e)}}(i),cond:function(b){return a.util.inArray(b,["tableprop","tabledelete"])?function(a){return d.getSelectedTable(a)}:function(a){return d.getSelectedCell(a)}}(i),options:{width:"170px",iconHtml:'<span class="ke-common-icon ke-common-icon-url ke-icon-'+i+'"></span>'}});a.g[c].contextmenuItems.push("-"),a.g[c].setHtmlHooks.push(function(b){return b.replace(/<table([^>]*)>/gi,function(b,c){if(c.match(/\s+border=["']?(\d*)["']?/gi)){var d=RegExp.$1;return c.indexOf(e)<0&&(""===d||"0"===d)?a.addClass(b,e):b}return a.addClass(b,e)})})},click:function(b,c){c=c||"default";var d="advtable";a.util.selection(b),this.dialog=new a.dialog({id:b,cmd:d,file:"advtable/advtable.html?mode="+c,width:420,height:220,loadingMode:!0,title:a.lang["advtable"],yesButton:a.lang["yes"],noButton:a.lang["no"]}),this.dialog.show()},exec:function(b){var D,E,F,G,H,c="ke-zeroborder",d=a.util.getIframeDoc(this.dialog.iframe),e=a.$("mode",d),f=a.$("rows",d),g=a.$("cols",d),h=a.$("width",d),i=a.$("height",d),j=a.$("widthType",d),k=a.$("heightType",d),l=a.$("padding",d),m=a.$("spacing",d),n=a.$("align",d),o=a.$("border",d),p=a.$("borderColor",d),q=a.$("backgroundColor",d),r=f.value,s=g.value,t=h.value,u=i.value,v=j.value,w=k.value,x=l.value,y=m.value,z=n.value,A=o.value,B=p.innerHTML,C=q.innerHTML;if(""==r||0==r||!r.match(/^\d*$/))return alert(a.lang["invalidRows"]),f.focus(),!1;if(""==s||0==s||!s.match(/^\d*$/))return alert(a.lang["invalidCols"]),g.focus(),!1;if(!t.match(/^\d*$/))return alert(a.lang["invalidWidth"]),h.focus(),!1;if(!u.match(/^\d*$/))return alert(a.lang["invalidHeight"]),i.focus(),!1;if(!x.match(/^\d*$/))return alert(a.lang["invalidPadding"]),l.focus(),!1;if(!y.match(/^\d*$/))return alert(a.lang["invalidSpacing"]),m.focus(),!1;if(!A.match(/^\d*$/))return alert(a.lang["invalidBorder"]),o.focus(),!1;if("update"===e.value)D=this.getSelectedTable(b),D.style.width=""!==t?t+v:"",D.style.height=""!==u?u+w:"",D.style.backgroundColor=C,a.attr(D,"width",""),a.attr(D,"height",""),a.attr(D,"bgColor",""),a.attr(D,"cellPadding",x),a.attr(D,"cellSpacing",y),a.attr(D,"align",z),""===A||"0"===A?a.addClass(D,c):a.removeClass(D,c),a.attr(D,"border",A),a.attr(D,"borderColor",B),a.util.execOnchangeHandler(b);else{for(E="",""!==t&&(E+="width:"+t+v+";"),""!==u&&(E+="height:"+u+w+";"),""!==C&&(E+="background-color:"+C+";"),F="<table",""!==E&&(F+=' style="'+E+'"'),""!==x&&(F+=' cellpadding="'+x+'"'),""!==y&&(F+=' cellspacing="'+y+'"'),""!==z&&(F+=' align="'+z+'"'),(""===A||"0"===A)&&(F+=' class="'+c+'"'),""!==A&&(F+=' border="'+A+'"'),""!==B&&(F+=' bordercolor="'+B+'"'),F+=">",G=0;r>G;G++){for(F+="<tr>",H=0;s>H;H++)F+="<td>&nbsp;</td>";F+="</tr>"}F+="</table>",a.util.insertHtml(b,F)}this.dialog.hide(),a.util.focus(b)}}}(KindEditor);