function updateTopic(){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,a=1,b=1;for(firstPage.divTopic.innerHTML="<span style='font-size:14px; font-weight:normal;'>[&nbsp;第"+b+"页/共"+total_page+"页&nbsp;]</span>",b++,totalHideQcount=0,d=new Object,e=0;e<questionHolder.length;e++)f=questionHolder[e].dataNode,g=f._type,"page"!=g&&"cut"!=g?(0!=f._topic-a&&curNewQ!=questionHolder[e]&&(d[f._topic]=a),f._topic=a,questionHolder[e].divTopic&&(h=a,h-=totalHideQcount,i=h+"",0>h-100&&(i+="."),5==newQType&&(i=1==h?"":h-1+"."),hasCeShiQ&&(f._isCeShi||(i="",totalHideQcount++)),questionHolder[e].divTopic.innerHTML=i),questionHolder[e]._referDivQ&&(questionHolder[e].createTableRadio?questionHolder[e].createTableRadio():questionHolder[e].createSum&&questionHolder[e].createSum(),questionHolder[e].updateReferQ&&(questionHolder[e].updateReferQ(),questionHolder[e].updateSelCheck&&questionHolder[e].updateSelCheck())),a++):"page"==g&&(questionHolder[e].dataNode._topic=b,questionHolder[e].divTopic.innerHTML="<span style='font-size:14px; font-weight:normal;'>[&nbsp;第"+b+"页/共"+total_page+"页&nbsp;]</span>",b++);for(e=0;e<questionHolder.length;e++)if(f=questionHolder[e].dataNode,f._hasjump)if(f._anytimejumpto-1>0&&d[f._anytimejumpto])a=d[f._anytimejumpto],f._anytimejumpto=a,questionHolder[e].set_jump_ins&&questionHolder[e].set_jump_ins();else if(f._select){for(j=!1,k=1;k<f._select.length;k++)l=f._select[k]._item_jump,l-1>0&&d[l]&&"1"!=d[l]&&(f._select[k]._item_jump=d[l],j=!0);j&&questionHolder[e].createTableRadio&&questionHolder[e].createTableRadio(!0)}for(e=0;e<questionHolder.length;e++)if(f=questionHolder[e].dataNode,f._relation){for(m="",m=-1!=f._relation.indexOf("|")?"|":"$",n=f._relation.split(m),o="",j=!1,p=0;p<n.length;p++)q=n[p].split(","),r=parseInt(q[0]),d[r]?(a=d[r],s=a+","+q[1],o&&(o+=m),o+=s,j=!0):n[p]&&(o&&(o+=m),o+=n[p]);o&&j&&(f._relation=o,t=getRelationStr(o),u=questionHolder[e].RelationIns,t&&(u.innerHTML=t[0],u.title=t[1]))}for(e=0;e<questionHolder.length;e++)if(f=questionHolder[e].dataNode,f._hasitemrelation)for(v=f._select,w=1;w<v.length;w++)if(x=v[w]._item_relation){for(m="",m=-1!=x.indexOf("|")?"|":"$",n=x.split(m),o="",j=!1,y=!1,p=0;p<n.length;p++)if(q=n[p].split(","),r=parseInt(q[0]),d[r]){if(a=d[r],a>=f._topic){y=!0;break}s=a+","+q[1],o&&(o+=m),o+=s,j=!0}else n[p]&&(o&&(o+=m),o+=n[p]);y?(questionHolder[e].dataNode._hasitemrelation="",questionHolder[e].dataNode._select[w]._item_relation="",questionHolder[e].createTableRadio(!0)):o&&j&&(questionHolder[e].dataNode._select[w]._item_relation=o,questionHolder[e].createTableRadio(!0))}for(e=0;e<questionHolder.length;e++)if(f=questionHolder[e].dataNode,f._categoryid&&"-1"!=f._categoryid&&f._categoryid.indexOf("|")>-1){for(z=f._categoryid.split("〒"),A="",B=!1,w=0;w<z.length;w++)C=z[w].split("|"),D=C[0],D/1e4!=f._topic&&(B=!0,D=1e4*f._topic+D%1e4,A+=0==w?"":"〒",A+=D+"|"+C[1]);B&&(f._categoryid=A)}setNewRandom(d)}function recreateEditor(a){if(a.hasCreatedAttr&&!KE.browser.IE){var b=a.titleId;if(!b)return;KE.remove(b),KE.create(b),KE.util.focus(b)}}function getNextNode(a){var b=a.nextSibling;return b&&1!=b.nodeType&&(b=b.nextSibling),b}function Sleeper(){var a=this;return a.step=0,a.actions=[],a.push=function(b){return a.actions.push(b),a},a.run_next=function(){if(a.step<a.actions.length){var b=a.actions[a.step];b(),++a.step,setTimeout(a.run_next,0)}},a.run=function(){a.run_next()},a}function addpages(){var a,b,c,d,e,f;for(useShortCutAddNewQ=!0,batchAddPage=!0,needAddArray=new Array,a=0,b=questionHolder.length;b>a;a++)c=questionHolder[a],"page"!=c.dataNode._type&&"cut"!=c.dataNode._type&&(d=getNextNode(c),d&&d.dataNode&&"page"!=d.dataNode._type&&needAddArray.push(c));for(e=new Sleeper,b=needAddArray.length,ipageIndex=0,f=b/batchStep,b%batchStep&&(f+=1),a=0;f>a;a++)e.push(function(){for(var a=0;batchStep>a&&(curinsert=needAddArray[ipageIndex++],curinsert);a++)createFreQ("page"),show_status_tip("添加分页"+ipageIndex+"/"+needAddArray.length,1e3)});e.push(function(){useShortCutAddNewQ=!1,batchAddPage=!1,updateTopic()}),e.run()}function setMoveStyle(a){var b=a;setTimeout(function(){b.className="div_question div_question_move",prevcurmove&&prevcurmove!=b&&"div_question div_question_move"==prevcurmove.className.toLowerCase()&&(prevcurmove.className="div_question div_question_mouseout"),prevcurmove=b,prevcurmove.divTableOperation.style.visibility="hidden"},2)}function afterMove(a,b){recreateEditor(a),recreateEditor(b),updateTopic(a.dataNode._type),a.onmouseout(),a.focus(),setMoveStyle(a)}function moveUp(){var c,d,e,f,g,a=this.dataNode._type,b="page"==a||"cut"==a;if(isMergeAnswer&&!b)return alertNew("很抱歉，在以合并答卷模式下修改问卷为了保持数据一致性不允许上移题目！"),void 0;if(this._referDivQ&&(c=parseInt(this.dataNode._topic)-1,d=this._referDivQ.dataNode._topic,d>=c))return e="选项",("matrix"==this.dataNode._type||"sum"==this.dataNode._type)&&(e="行标题"),show_status_tip("此题"+e+"来源于第"+d+"题的选中项，不能再将此题移到第"+d+"题上方！",4e3),void 0;if(f=questionHolder.indexOf(this),f>0){if(1==f&&isCepingQ)return show_status_tip("不能移动到被测评对象上面",3e3),void 0;g=questionHolder[f-1],this.parentNode.insertBefore(this,g),questionHolder.moveUp(this),afterMove(this,g)}else show_status_tip("第1题不能再上移",3e3)}function moveDown(){var d,e,f,g,h,i,a=this.dataNode._type,b="page"==a||"cut"==a;if(isMergeAnswer&&!this.isMergeNewAdded&&!b)return alertNew("很抱歉，在以合并答卷模式下修改问卷为了保持数据一致性不允许下移题目！"),void 0;if(this._referedArray)for(d=parseInt(this.dataNode._topic)+1,e=0;e<this._referedArray.length;e++)if(f=this._referedArray[e].dataNode._topic,d-f>=0)return g="选项",("matrix"==this._referedArray[e].dataNode._type||"sum"==this._referedArray[e].dataNode._type)&&(g="行标题"),show_status_tip("第"+f+"题的"+g+"来源于此题的选中项，不能将此题移到第"+f+"题下方！",4e3),void 0;h=questionHolder.indexOf(this),h<questionHolder.length-1?(i=questionHolder[h+1],this.parentNode.insertBefore(i,this),questionHolder.moveDown(this),afterMove(this,i)):show_status_tip("最后1题不能再下移",3e3)}function moveFirst(){var c,d,e,a=this.dataNode._type,b="page"==a||"cut"==a;return isMergeAnswer&&!b?(alertNew("很抱歉，在以合并答卷模式下修改问卷为了保持数据一致性不允许上移题目！"),void 0):this._referDivQ?(c="选项",("matrix"==this.dataNode._type||"sum"==this.dataNode._type)&&(c="行标题"),show_status_tip("此题"+c+"来源于第"+this._referDivQ.dataNode._topic+"题的选中项，不能将此题移动最前！",4e3),void 0):(d=questionHolder.indexOf(this),d>0?(e=questionHolder[0],5==newQType&&(e=questionHolder[1]),this.parentNode.insertBefore(this,e),questionHolder.moveFirst(this),afterMove(this,e)):show_status_tip("第1题不能再上移",3e3),void 0)}function moveLast(){var a,b,c,d;if(this._referedArray){for(a="",b=0;b<this._referedArray.length;b++)b>0&&(a+=","),a+=this._referedArray[b].dataNode._topic;return show_status_tip("第"+a+"题的选项或行标题来源于此题的选中项，不能将此题移动到最后！",4e3),void 0}c=questionHolder.indexOf(this),c<questionHolder.length-1?(d=questionHolder[questionHolder.length-1],this.parentNode.insertBefore(this,d),this.parentNode.insertBefore(d,this),questionHolder.moveLast(this),afterMove(this,d)):show_status_tip("最后1题不能再下移",3e3)}function insertQ(a,b,c){var e,d=curinsert==a;if(d)resetInsertQ();else{if(curinsert=a,isCepingQ&&"page"==a.dataNode._type&&"1"==a.dataNode._topic)return alertNew("提示：不能在被测评对象前面插入题目！"),resetInsertQ(),void 0;if(c)return;e=$$("a",curinsert.divInsertOp)[0],e&&(e.innerHTML="取消插入点"),setMoveStyle(curinsert),isMergeAnswer?5==newQType?show_status_tip("提示：部分编辑模式下，360问卷只能插入分页和段落说明！"):show_status_tip("提示：部分编辑模式下，只能插入分页和段落说明题型，其它题型只能添加在问卷最后！",1e4):(3==newQType?document.getElementById("divITouPiao").style.display="":isKaoShi?document.getElementById("divIKaoShi").style.display="":5==newQType?document.getElementById("divI360").style.display="":6==newQType?document.getElementById("divICeping").style.display="":document.getElementById("divIdiaocha").style.display="",sb_setmenunav("divInsertQ",!0,b))}}function resetInsertQ(){if(null!=curinsert){"div_question div_question_move"==curinsert.className.toLowerCase()&&(curinsert.className="div_question div_question_mouseout");var a=$$("a",curinsert.divInsertOp)[0];a&&(a.innerHTML="在此题后插入新题"),curinsert=null,sb_setmenunav("divInsertQ",!1)}}function change_dataNode(a,b){var d,e,f,g,h,i,j,c=new Object;if(c._isTouPiao=!1,c._isCeShi=!1,c._isCePing=!1,d=!1,e=!1,a._select&&a._select.forEach(function(a){a._item_relation&&(a._item_relation="")}),"likert"==b)c._tag=2,c._type="radio";else if("order"==b)c._tag=1,c._type="check",c._upLimit=c._lowLimit="-1";else if(b.indexOf("matrix")>-1)f=b.split(",")[1],c._type="matrix",c._tag=f,c._rowtitle=a._rowtitle,c._rowtitle2=a._rowtitle2,a._columntitle&&(c._columntitle=a._columntitle),c._rowwidth=a._rowwidth,c._rowwidth2=a._rowwidth2,"202"==f||"301"==f?(c._minvalue=0,c._maxvalue=10):"302"==f&&(c._minvalue=""),(0>=f-101||"303"==f)&&(e=!0);else if("toupiaoradio"==b||"toupiaocheck"==b)c._type="toupiaoradio"==b?"radio":"check",c._isTouPiao=!0,c._touPiaoWidth=a._touPiaoWidth||50,c._displayTiao=a._displayTiao||!0,c._displayNum=a._displayNum||!0,c._displayPercent=a._displayPercent||!0;else{if("ceshiradio"==b||"ceshicheck"==b){if(g="ceshiradio"==b?"1":"2",c=createFreQdataNode("ceshi",g),c._title=a._title,c._topic=a._topic,a._select&&a._select.length>1&&(c._select=a._select,!a._isCeShi)){for(h=1;h<c._select.length;h++)c._select[h]._item_radio=!1;c._select[1]._item_radio=!0}return c._ceshiValue=5,d=!0,c}if("ceshiq1"==b)return c=createFreQdataNode("ceshi",6),c._title=a._title,c._topic=a._topic,c._ceshiValue=5,d=!0,c;if("ceshiq2"==b)return c=a,c._answer="请设置答案",c._height=1,d=!0,c;if("ceshiq3"==b)return c=createFreQdataNode("ceshi",3),c._title=a._title,c._topic=a._topic,c._ceshiValue=a._ceshiValue,d=!0,c;if("ceshiq"==b)c._type="question",c._isCeShi=!0,c._ceshiValue=5,c._ceshiDesc="",c._answer="请设置答案",d=!0;else{if("ceshigap"==b)return i=[],c=a,c._isCeShi=!0,c._isCloze=!1,c._ceshiValue=5,c._ceshiDesc="",c._rowVerify=i,d=!0,isCloze=!1,c;if("gapfill"==b)return c=a,c._isCeShi=!1,c._isCloze=!1,d=!1,isCloze=!1,c;if("clozegap"==b)return i=[{_answer:"A",_choice:"A,B,C",_verify:"指定选项"},{_answer:"B",_choice:"A,B,C",_verify:"指定选项"}],c=a,c._isCeShi=!0,c._ceshiValue=1,c._ceshiDesc="",c._isCloze=!0,c._rowVerify=i,isCloze=!0,d=!0,c;"cepingradio"==b||"cepingcheck"==b?(c._type="cepingradio"==b?"radio":"check",c._isCePing=!0):(c._type=b,c._tag=0)}}if(c._verify="0",c._topic=a._topic,c._title=a._title,c._requir=a._requir,c._ins=a._ins,c._hasjump=a._hasjump,c._anytimejumpto=a._anytimejumpto,c._keyword=a._keyword,"ceshiq"==b)return c._maxword="",c._minword="",c._height=a._height,c._height>1&&(c._answer="简答题无答案"),c._width="",c._hasList=!1,c._underline=!1,c._norepeat=!1,c._default="",c;if("question"==a._type){for(c._hasvalue=!1,c._randomChoice=!1,c._isTouPiao=!1,c._isCeShi=!1,c._default="",c._minword="",c._maxword="",c._numperrow="1",c._select=new Array,j=1;3>j;j++)c._select[j]=new Object,c._select[j]._item_title="选项"+j,c._select[j]._item_radio=!1,c._select[j]._item_value=0,c._select[j]._item_jump=0,c._select[j]._item_tb=!1,c._select[j]._item_tbr=!1,c._select[j]._item_img="",c._select[j]._item_imgtext=!1,c._select[j]._item_desc="",c._select[j]._item_label="";return"likert"==b&&(c._hasvalue=!0),c}if("question"==b)return c._height="1",c._maxword="",c._minword="",c._width="",c._hasList=!1,c._listId="",c._underline=!1,c._norepeat=!1,c._default="",c;if(c._hasvalue=!1,c._isCePing&&(c._hasvalue=!0),b.indexOf("matrix")>-1&&(c._hasvalue=e),c._randomChoice=a._randomChoice||!1,c._numperrow=a._numperrow||0,c._select=a._select,"check"==a._type||"likert"==b||"order"==b||c._isCePing)for(h=1;h<c._select.length;h++)c._select[h]._item_radio=!1;if("order"==b)for(h=1;h<c._select.length;h++)c._select[h]._item_tb=!1,c._select[h]._item_tbr=!1;if("check"==b&&c._hasjump&&"0"==c._anytimejumpto&&(c._hasjump=!1),"likert"==b||e||"cepingradio"==b){for(h=1;h<c._select.length;h++)c._select[h]._item_value=h;c._hasvalue=!0}if(d&&(c._hasvalue=!1,c._hasjump=!1,!a._isCeShi))for(h=1;h<c._select.length;h++)c._select[h]._item_radio=1==h?!0:!1,c._select[h]._item_tb=!1;return c}function changeQ(a){var b,c,d,e,f,g;if(cur.validate(),cur._referDivQ&&5!=newQType)return b="选项",("matrix"==cur.dataNode._type||"sum"==cur.dataNode._type)&&(b="行标题"),show_status_tip("此题"+b+"来源于第"+cur._referDivQ.dataNode._topic+"题的选中项，不能转换题型！",4e3),void 0;if(cur._referedArray){for(c="",d=0;d<cur._referedArray.length;d++)d>0&&(c+=","),c+=cur._referedArray[d].dataNode._topic;return show_status_tip("第"+c+"题的选项或行标题来源于此题的选中项，不能转换题型！",4e3),void 0}cur.checkValid()&&(e=copyNode(cur.dataNode),f=change_dataNode(e,a),f._topic=cur.dataNode._topic,g=createQ(f,!0),5==newQType&&"matrix"==f._type&&(f._referTopic="1",setReferDiv(g)))}function setReferDiv(a){var c,d,e,f,b=questionHolder[0];for(c=0,d=questionHolder.length;d>c;c++)if(e=questionHolder[c].dataNode,"page"!=e._type&&"cut"!=e._type&&(f=e._topic,"1"==f)){b=questionHolder[c];break}a._referDivQ=b,b._referedArray||(b._referedArray=new Array),-1==b._referedArray.indexOf(a)&&b._referedArray.push(a),b._referedArray.sort(function(a,b){return a.dataNode._topic-b.dataNode._topic})}function createFreQ(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v;if(!d){if(5==newQType&&isMergeAnswer&&"cut"!=a&&"page"!=a)return alertNew("提示：部分编辑模式下，360度评估不能添加新题目！"),void 0;if(f=["姓名","基本信息","性别","年龄段","省份","省市","省市区","手机","手机验证","Email","日期","时间","地图","职业","行业","高校","密码","邮寄地址","其它信息","部门"],g=!isMergeAnswer&&isKaoShi&&null==curinsert&&f.indexOf(a)>=0){if(h=firstPage,questionHolder.length>0)for(i=0;i<questionHolder.length;i++)if(questionHolder[i].dataNode._isCeShi){h=0==i?firstPage:questionHolder[i-1];break}insertQ(h,null,!0)}}return l=1440>=bodyWidth,d?(j=createFreQdataNode(a,b,c,"1"),k=create_question(j,!0),m=document.getElementById("prev_box"),n=e.offsetTop-document.getElementById("topnav").scrollTop,m.innerHTML='<i class="triangle"></i>',k.onmouseover=k.onmouseout=null,k.children[0].onclick=null,m.appendChild(k),o=document.createElement("span"),o.innerHTML="( 题型预览 )",o.className="preTit",m.appendChild(o),p=m.offsetHeight,document.getElementById("ss-cont").offsetHeight-n<p&&(q=m.children[0],r=n,n=document.getElementById("ss-cont").offsetHeight-p-10,s=r-n>p?p-7:r-n+14,s=s>p-14?p-16:s,q.style.top=s+"px"),l&&(n+=42),m.style.top=n-9+"px",PrevTimeSet=setTimeout(function(){m.style.visibility="visible"},300),void 0):(j=createFreQdataNode(a,b,c),batchAddPage&&(j._topic=total_page),k=createQ(j),firstPage&&(firstPage.style.display=""),t=!j._tag&&("radio"==j._type||"radio_down"==j._type),u="check"==j._type,v=/^[a-zA-Z_]+$/.test(a),5==newQType&&"matrix"==j._type&&(j._referTopic="1",setReferDiv(k)),(t||u)&&v&&(k.newAddQ=!0),vipUser||clickKaoShi||(clickKaoShi=!0),window.needSubmistHandle&&questionHolder.length>1&&window.divhandleBox&&"none"===window.divhandleBox.parentNode.style.display&&(window.divhandleBox.parentNode.style.display=""),k)}function setNewRandom(a){var b,c,d,e,f,g,h;if("1"==WjxActivity._random_mode)a[WjxActivity._random_begin]&&(WjxActivity._random_begin=a[WjxActivity._random_begin]),a[WjxActivity._random_end]&&(WjxActivity._random_end=a[WjxActivity._random_end]);else if("4"==WjxActivity._random_mode){for(b="",c=WjxActivity._partset.split(","),d=0;d<c.length;d++)b&&(b+=","),e=c[d].split(";"),f=parseInt(e[0]),g=parseInt(e[1]),h=e[2]||"",a[f]&&(f=a[f]),a[g]&&(g=a[g]),isInt(f)&&isInt(g)&&(b+=f+";"+g+";"+h);WjxActivity._partset=b}}function createFreQdataNode(a,b,c,d){var e,f,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,g="标题",h="question§1§",i="§0§1§§true§false§§§false§§"+a,j="";switch("check"==a&&c&&(j="-1"),k=g,l="您喜欢的网站/应用/服务",m="淘宝网〒false〒0〒0〒false〒false〒〒false〒〒§开心网〒false〒1〒0〒false〒false〒〒false〒〒§百度〒false〒1〒0〒false〒false〒〒false〒〒§腾讯〒false〒1〒0〒false〒false〒〒false〒〒§人人网〒false〒1〒0〒false〒false〒〒false〒〒",n="选项"+(d?1:select_item_num+1)+"〒false〒1〒0〒false〒false〒〒false〒〒§选项"+(d?2:select_item_num+2)+"〒false〒2〒0〒false〒false〒〒false〒〒",o="选项1〒true〒0〒0〒false〒false〒〒false〒〒§选项2〒false〒0〒0〒false〒false〒〒false〒〒",p="很不满意〒false〒1〒0§不满意〒false〒2〒0§一般〒false〒3〒0§满意〒false〒4〒0§很满意〒false〒5〒0",q="",r=!1,s="§§§§200§false§",t="",a){case"电话":q="您常用的电话号码：",r=!0,t=s;break;case"Email":q="您常用的Email地址：",r=!0,t=s;break;case"城市单选":case"城市多选":q="请选择城市:",r=!0;break;case"省市区":q="请选择省份城市与地区:",r=!0;break;case"地图":q="您的地理位置:",r=!0;break;case"多级下拉":q="请选择：",r=!0;break;case"生日":case"日期":q="请输入您的出生日期：",r=!0;break;case"手机":q="请输入您的手机号码：",r=!0,t=s;break;case"手机验证":q="请输入您的手机号码：",r=!0,t="§false〒true§§§150§false§",i="§0§1§§true§false§§§false§§手机";break;case"高校":q="您所在或者毕业的高校名称：",r=!0;break;case"时间":e="gapfill§1§时间："+GapFillStr+"："+GapFillStr+"§0§true§1§§false§0§";break;case"姓名":q="您的姓名：",r=!0,i="§0§1§§true§false§§§false§§"+a;break;case"其它信息":q="其它信息如工号：",r=!0,i="§0§1§§true§false§§§false§§";break;case"密码":q="密码：",r=!0,i="§0§1§§true§false§§§false§§"+a;break;case"性别":e="radio§3§您的性别：§0§8§false§false§§true§0000§§性别§§§男〒false〒0〒0§女〒false〒0〒0";break;case"部门":e="radio§3§您的部门：§0§3§false§false§§true§0000§§部门§§§设计部〒false〒0〒0§市场部〒false〒0〒0§客服部〒false〒0〒0§人力资源部〒false〒0〒0§产品部〒false〒0〒0§财务部〒false〒0〒0§生产部〒false〒0〒0§法务〒false〒0〒0§行政〒false〒0〒0";break;case"年龄段":e="radio§3§您的年龄段：§0§7§false§false§§true§0000§§年龄段§§§18岁以下〒false〒0〒0§18~25〒false〒0〒0§26~30〒false〒0〒0§31~40〒false〒0〒0§41~50〒false〒0〒0§51~60〒false〒0〒0§60以上〒false〒0〒0";break;case"行业":for(e="radio_down§10§您目前从事的行业：§0§1§false§false§§true§0000§§行业§§§",u="IT/软硬件服务/电子商务/因特网运营,快速消费品(食品/饮料/化妆品),批发/零售,服装/纺织/皮革,家具/工艺品/玩具,教育/培训/科研/院校,家电,通信/电信运营/网络设备/增值服务,制造业,汽车及零配件,餐饮/娱乐/旅游/酒店/生活服务,办公用品及设备,会计/审计,法律,银行/保险/证券/投资银行/风险基金,电子技术/半导体/集成电路,仪器仪表/工业自动化,贸易/进出口,机械/设备/重工,制药/生物工程/医疗设备/器械,医疗/护理/保健/卫生,广告/公关/媒体/艺术,出版/印刷/包装,房地产开发/建筑工程/装潢/设计,物业管理/商业中心,中介/咨询/猎头/认证,交通/运输/物流,航天/航空/能源/化工,农业/渔业/林业,其他行业",v=u.split(","),w="",x=0;x<v.length;x++)x>0&&(w+="§"),w+=v[x]+"〒false〒0〒0";e+=w;break;case"职业":e="radio_down§11§您目前从事的职业：§0§1§false§false§§true§0000§§职业§§§全日制学生〒false〒0〒0§生产人员〒false〒0〒0§销售人员〒false〒0〒0§市场/公关人员〒false〒0〒0§客服人员〒false〒0〒0§行政/后勤人员〒false〒0〒0§人力资源〒false〒0〒0§财务/审计人员〒false〒0〒0§文职/办事人员〒false〒0〒0§技术/研发人员〒false〒0〒0§管理人员〒false〒0〒0§教师〒false〒0〒0§顾问/咨询〒false〒0〒0§专业人士(如会计师、律师、建筑师、医护人员、记者等)〒false〒0〒0§其他〒false〒0〒0";break;case"省份":e="radio§19§您所在的省份：§0§8§false§false§§true§0000§§省份§§§安徽〒false〒0〒0§北京〒false〒1〒0§重庆〒false〒1〒0§福建〒false〒1〒0§甘肃〒false〒1〒0§广东〒false〒1〒0§广西〒false〒1〒0§贵州〒false〒1〒0§海南〒false〒1〒0§河北〒false〒1〒0§黑龙江〒false〒1〒0§河南〒false〒1〒0§香港〒false〒1〒0§湖北〒false〒1〒0§湖南〒false〒1〒0§江苏〒false〒1〒0§江西〒false〒1〒0§吉林〒false〒1〒0§辽宁〒false〒1〒0§澳门〒false〒1〒0§内蒙古〒false〒1〒0§宁夏〒false〒1〒0§青海〒false〒1〒0§山东〒false〒1〒0§上海〒false〒1〒0§山西〒false〒1〒0§陕西〒false〒1〒0§四川〒false〒1〒0§台湾〒false〒1〒0§天津〒false〒1〒0§新疆〒false〒1〒0§西藏〒false〒1〒0§云南〒false〒1〒0§浙江〒false〒1〒0§海外〒false〒1〒0";break;case"邮寄地址":e="matrix§1§请输入您的联系地址：§201§姓名：\n所在地区：\n街道地址:\n邮政编码:\n手机或固话：〒〒§false§false§§true§15%〒〒0,,,;1,省市区,,,50;2,,,,50;3,数字,,;4,电话,,〒10§§§§§"+p;break;case"基本信息":e="matrix§1§基本信息：§201§姓名：\n部门：\n员工编号:〒〒§false§false§§true§15%〒〒0,,,;1,,,;2,,,〒10§§§§§"+p;break;case"radio":case"radio_down":case"check":case"qingjing":case"shop":y="check"==a?"true,"+j+","+j:"true","qingjing"==a?(y="true,1",a="radio",n="情景1〒false〒0〒0§情景2〒false〒0〒0§情景3〒false〒0〒0§情景4〒false〒0〒0"):"shop"==a&&(a="check",g="请选择商品：",y="false,shop",n="商品1〒false〒10〒§商品2〒false〒10〒§商品3〒false〒10〒"),b&&(n+="§其它〒false〒1〒0〒true〒false〒〒false〒〒"),"check"==a&&c&&(n+="§选项"+(d?3:select_item_num+3)+"〒false〒2〒0〒false〒false〒〒false〒〒"),e=a+"§1§"+g+"§"+c+"§1§false§false§§"+y+"§§§§§§"+n;break;case"toupiao":a=1==b?"radio":"check",e=a+"§1§"+l+"§"+c+"§1§false§false§§true§true〒50〒false〒true〒true§§§§§"+m;break;case"ceshi":3==b||6==b?(A="请设置答案",B=1,6==b&&(A="简答题无答案",B=3),e="question§1§"+g+"§0§"+B+"§§true§false§§§false§§§false§§§§§§5〒"+A):4==b?(e="gapfill§1§问题1："+getFillStr(3)+"问题2："+getFillStr(3)+"§0§true§1§§false§0§§§1",9==b&&(e+="§1")):9==b?e="gapfill§1§Question 1："+getFillStr(3)+"Question 2："+getFillStr(3)+"§0§true§1§§false§0§§§1§1":5==b?(a="radio",e=a+"§1§"+k+"§"+c+"§1§true§false§§true,2§ceshi〒5〒§§§§§对〒true〒0〒0〒false〒false〒〒false〒〒§错〒false〒1〒0〒false〒false〒〒false〒〒"):7==b||10==b?(e="fileupload§1§"+g+"§0§true§200§"+defaultFileExt+"§4096〒1§§false§0§5",10==b&&(e+="§true")):(a=1==b?"radio":"check",e=a+"§1§"+k+"§"+c+"§1§true§false§§true§ceshi〒5〒§§§§§"+o),hasCeShiQ=!0,showCeShiInfo();break;case"ceping":a=1==b?"radio":"check",e=a+"§1§"+g+"§0§1§true§false§§true§ceping§§§§§"+n;break;case"boolean":e=a+"§1§"+g+"§0§8§true§false§§true§0000§§§§§是〒false〒1〒0§否〒false〒0〒0";break;case"likert":if(C="1","11"==b)for(p="",C="6",g="您向朋友或同事推荐我们的可能性有多大？",D=0;11>D;D++)p+=0==D?"不可能〒false〒0〒0§":10==D?"极有可能〒false〒10〒10":D+"〒false〒"+D+"〒"+D+"§";e="radio§1§"+g+"§"+C+"§1§true§false§§true§0000§§§§§"+p;break;case"matrix":if(E=b||2,F="",G="外观\n功能",H="",I=10,J=0,K=g,L="-1","202"==E&&(I=100,c&&(M=c.split("§"),M[0]&&(K=M[0]),J=M[1],I=M[2],M.length>=4&&(L=M[3]))),N=102>E||303==E,O=N?"true":"false",b-300>0&&(F="百度\n谷歌\n搜狗",c&&(G=2==c?"1\n2\n3\n4\n5":"成员1\n成员2",F="姓名\n年龄\n性别")),101==E){if(P="1〒false〒1〒0§2〒false〒2〒0§3〒false〒3〒0§4〒false〒4〒0§5〒false〒5〒0",c){if(Q=c.split("§"),Q[0]&&(K=Q[0]),Q[1]&&Q[2]&&(R=Q[1].split("\n"),S=Q[2].split("\n"),R.length==S.length))for(P="",T=0;T<R.length;T++)T>0&&(P+="§"),P+=R[T]+"〒false〒"+S[T]+"〒0";Q.length>=4&&(L=Q[3])}e="matrix§1§"+K+"§"+E+"§"+G+"〒〒"+F+"§"+O+"§false§§true§"+H+"〒〒0〒"+I+"§§§§§"+P}else 102==E?(U="速度快〒false〒1〒0§准确率高〒false〒2〒0§信息量多〒false〒3〒0§界面更美观〒false〒4〒0",e="matrix§1§请评议下面的搜索引擎：§"+E+"§百度\nGoogle\n搜狗〒〒"+F+"§"+O+"§false§§true§"+H+"〒〒0〒"+I+"§§§§§"+U):e="matrix§1§"+K+"§"+E+"§"+G+"〒〒"+F+"§"+O+"§false§§true§"+H+"〒〒"+J+"〒"+I+"§§§§§"+p;"-1"!=L&&(e+="¤"+L);break;case"question":B=b||1,V=c||!1,e="question§1§"+g+"§0§"+B+"§§true§false§§§false§§§"+V+"§§§§§";break;case"gapfill":e="gapfill§1§姓名："+getFillStr(3)+"&nbsp;&nbsp;&nbsp;&nbsp;年龄："+GapFillStr+"岁<br/>电话："+getFillStr(4)+"§0§true§1§§false§0§";break;case"slider":e="slider§1§"+g+"§0§true§0§100§不满意§满意§§false§0§";break;case"sum":e="sum§1§"+g+"§0§true§100§外观\n性能§15%§0§§false§0§";break;case"fileupload":e="fileupload§1§"+g+"§0§true§200§"+defaultFileExt+"§4096〒1§§false§0§";break;case"page":W=b||"",e=a+"§1§§§"+W;break;case"cut":q=b?b:"",e=a+"§"+q+"§"}return r&&(e=h+q+i+t),f=set_string_to_dataNode(e,!1,d),"时间"==a?(f._rowVerify=[],f._rowVerify[0]=new Object,f._rowVerify[0]._verify="指定选项",f._rowVerify[0]._choice="00,01,02,03,04,05,06,07,08,09,10,11,12,13,14,15,16,17,18,19,20,21,22,23|小时",f._rowVerify[1]=new Object,f._rowVerify[1]._verify="指定选项",f._rowVerify[1]._choice="00,01,02,03,04,05,06,07,08,09,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59|分钟"):"302"==b&&c?(f._rowVerify=[],f._rowVerify[0]=new Object,f._rowVerify[1]=new Object,f._rowVerify[1]._verify="数字",f._rowVerify[2]=new Object,f._rowVerify[2]._verify="指定选项",f._rowVerify[2]._choice="男,女",2==c&&(f._maxvalue="5",f._minvalue="2")):"ceshi"==a&&9==b&&(f._rowVerify=[],f._rowVerify[0]=new Object,f._rowVerify[0]._verify="指定选项",f._rowVerify[0]._choice="A,B,C",f._rowVerify[0]._answer="A",f._rowVerify[1]=new Object,f._rowVerify[1]._verify="指定选项",f._rowVerify[1]._choice="A,B,C",f._rowVerify[1]._answer="B"),f}function addNewQ(a,b,c,d){var g,h,f=a._type,e=create_question(a);return curNewQ=e,setQHandler(e),setAttrHander(e),null!=curinsert&&(d=curinsert),c&&(d=curover),b?(cur.parentNode.insertBefore(e,cur),e.isMergeNewAdded=cur.isMergeNewAdded,questionHolder[questionHolder.indexOf(cur)]=e,cur.deleteQ("noNeedConfirm"),cur=null):(isMergeAnswer&&"page"!=f&&"cut"!=f||!d?(null!=curinsert&&(5==newQType?alertNew("提示：部分编辑模式下，360问卷只能插入分页和段落说明！"):alertNew("提示：部分编辑模式下，只能插入分页和段落说明题型，其它题型只能添加在问卷最后！")),questions.appendChild(e),questionHolder.push(e),updateTopic()):(questions.lastChild==d?questions.appendChild(e):questions.insertBefore(e,d.nextSibling),d==firstPage?questionHolder.unshift(e):(questionHolder.insertBefore(e,d),questionHolder.moveUp(d)),batchAddPage||updateTopic()),a._categoryid&&"-1"!=a._categoryid&&(g=a._tag,300>=g?e.updateSpancategory():e.createTableRadio())),null!=curinsert&&resetInsertQ(),c&&curover&&curover._referDivQ&&(h=curover._referDivQ,e._referDivQ=h,h._referedArray||(h._referedArray=new Array),-1==h._referedArray.indexOf(e)&&h._referedArray.push(e),h._referedArray.sort(function(a,b){return a.dataNode._topic-b.dataNode._topic})),curNewQ=null,e}function createQ(a,b,c){var d,e,f;return cur&&(cur.divTableOperation.style.visibility="hidden"),d=addNewQ(a,b,c),!isMergeAnswer&&window.makeDrag&&makeDrag(d),d.createOp(),e=(new Date).getTime(),useShortCutAddNewQ?setMoveStyle(d):lastAddNewQTime&&!b?(f=e-lastAddNewQTime,f>8e3?qonclick.call(d):(cur&&cur.isEditing&&qonclick.call(cur),setMoveStyle(d))):qonclick.call(d),d.focus(),lastAddNewQTime=e,Calculatedscore(),d}function copyQ(){if(this.validate&&this.validate(),!this.checkValid||this.checkValid()){var a=copyNode(this.dataNode);a._hasjump=!1,a._needOnly=!1,a._hasList=!1,a._listId=-1,a._referedTopics="",createQ(a,!1,!0),show_status_tip("复制成功！",4e3)}}function copyNode(a){var c,d,e,b=new Object;for(c in a)b[c]=a[c];if(a._select)for(b._select=new Array,d=1;d<a._select.length;d++){b._select[d]=new Object;for(e in a._select[d])b._select[d][e]=a._select[d][e]}if(a._rowVerify)for(b._rowVerify=new Array,d=0;d<a._rowVerify.length;d++){b._rowVerify[d]=new Object;for(e in a._rowVerify[d])b._rowVerify[d][e]=a._rowVerify[d][e]}return b}function deleteQ(a,b){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,c=this.dataNode._type,d="page"==c||"cut"==c;if(this._referedArray){for(e="",f=0;f<this._referedArray.length;f++)f>0&&(e+=","),e+=this._referedArray[f].dataNode._topic;return show_status_tip("提示：第"+e+"题的选项或行标题来源于此题的选中项，不能删除此题！",4e3),void 0}if("page"!=c&&"noNeedConfirm"!=a){for(f=0;f<questionHolder.length;f++)if(g=questionHolder[f].dataNode,g._relation&&(h=g._relation.split(","),i=parseInt(h[0]),this.dataNode._topic==i))return j=g._topic,WjxActivity._use_self_topic&&(k=g._title.match(/^\s*\d+[\.\-\_\(\/]?\d+?\)?/),k&&(j=k)),l="第"+j+"题",j||(l="段落说明"),show_status_tip("提示："+l+"关联于此题的第"+h[1]+"个选项，不能删除此题！",4e3),void 0;for(f=0;f<questionHolder.length;f++)if(g=questionHolder[f].dataNode,g._hasjump){if(m=!0,n=0,g._anytimejumpto-1>0&&this.dataNode._topic==g._anytimejumpto)m=!1;else if(g._select)for(o=1;o<g._select.length;o++)p=g._select[o]._item_jump,p-1>0&&this.dataNode._topic==p&&(m=!1,n=o);if(!m)return j=g._topic,WjxActivity._use_self_topic&&(k=g._title.match(/^\s*\d+[\.\-\_\(\/]?\d+?\)?/),k&&(j=k)),l="第"+j+"题",n&&(l+="第"+n+"个选项"),show_status_tip("提示："+l+"设置了跳转到此题，不能删除此题！",4e3),void 0}}if(q="<a href='javascript:' onclick='setTikuRandom();return false;' class='titlelnk' style='font-weight: bold;'>题库随机设置</a>","noNeedConfirm"!=a)if("1"==WjxActivity._random_mode){if(this.dataNode._topic==WjxActivity._random_begin)return show_status_tip("提示：此题您设置的随机逻辑的开始题号，不能删除此题！"+q,1e4),void 0;if(this.dataNode._topic==WjxActivity._random_end)return show_status_tip("提示：此题您设置的随机逻辑的结束题号，不能删除此题！"+q,1e4),void 0}else if("4"==WjxActivity._random_mode)for(r=WjxActivity._partset.split(","),f=0;f<r.length;f++){if(s=r[f].split(";"),t=parseInt(s[0]),u=parseInt(s[1]),this.dataNode._topic==t)return show_status_tip("提示：此题您设置的随机逻辑的开始题号，不能删除此题！"+q,1e4),void 0;if(this.dataNode._topic==u)return show_status_tip("提示：此题您设置的随机逻辑的结束题号，不能删除此题！"+q,1e4),void 0}if("noNeedConfirm"!=a){if(isMergeAnswer&&!this.isMergeNewAdded&&!d)return show_status_tip("很抱歉，在以合并答卷模式下修改问卷为了保持数据一致性不允许删除原始问卷中的题目！",4e3),void 0;show_status_tip("可以通过Ctrl+Z恢复删除的问题",4e3)}"page"==c?total_page--:"cut"!=c&&total_question--,showhidebatq(),this.tabAttr&&(this.tabAttr.parentNode.removeChild(this.tabAttr),this.tabAttr=null,this.hasCreatedAttr=!1),this._referDivQ&&(this._referDivQ._referedArray.remove(this),this._referDivQ._referedArray.length||(this._referDivQ._referedArray=null),this._referDivQ=null),"noNeedConfirm"!=a&&(v=questionHolder.indexOf(this)),this.className="div_question div_question_mouseout",this.parentNode.removeChild(this),questionHolder.remove(this),b||("noNeedConfirm"!=a&&(updateTopic(),w=firstPage,v>0&&(w=questionHolder[v-1]),new DeleteAction(this,w).exec()),cur==this&&(cur=null),Calculatedscore())}function qSelect(){}function qonclick(){if(this.isCepingQ)return show_status_tip("被测评对象题不能进行编辑，请通过设置测评关系进行设置，设置好后此处会自动变化！"),void 0;try{window.getSelection?window.getSelection().removeAllRanges():document.selection.empty()}catch(b){}if(this.className="div_question div_question_onclick",this.title="",resetInsertQ(),(cur!=this||cur==this&&cur.isEditing)&&(null!=cur&&(cur.updateItem&&cur.updateItem(),cur.className="div_question",cur.hasCreatedAttr&&(cur.tabAttr.style.display="none"),cur.isEditing=!1,cur.style.cursor="move",changeEditText(cur.editQLink,!1),window.EditQWithoutPreview&&(cur.div_question_preview.style.display="",cur.style.paddingTop="30px")),cur&&cur.createAttr&&cur.checkValid&&!cur.checkValid()&&cur.validate(),cur==this))return this.divInsertOp.parentNode.style.display="",cur.focus(),cancelInputClick(this),!1;if(cancelInputClick(this),cur=this,this.dataNode,this.isEditing=!0,hasDisplayEditTip=!0,this.style.cursor="default",changeEditText(this.editQLink,!0),window.EditQWithoutPreview&&(this.div_question_preview.style.display="none",cur.style.paddingTop="0"),this.hasCreatedAttr)this.tabAttr.style.display="",cancelDblClick(this),this.hasDisplaySelCheck&&this.updateSelCheck(),this.dataNode._partScore&&(this.scoreRule.children[0].innerHTML="得部分分"),this.focus(),setQTopPos(this);else if(this.createAttr){var d=this;setTimeout(function(){d.createAttr(),cancelDblClick(d),d.setDataNodeToDesign(),setQTopPos(d)},0)}else show_status_tip("正在加载问题属性，请耐心等待....",4e3);return this.divInsertOp.parentNode.style.display="none",!1}function editQ(){curover&&(window._czc&&_czc.push(["_trackEvent","编辑页面","编辑题目","编辑按钮"]),qonclick.call(curover))}function changeEditText(){}function createOp(){var a,b,c;this.divTableOperation.OpCreated||(this.deleteQ=deleteQ,this.copyQ=copyQ,this.moveUp=moveUp,this.moveDown=moveDown,this.moveFirst=moveFirst,this.moveLast=moveLast,a=this.divTableOperation,b=this.dataNode._type,a.innerHTML="page"==b?this.dataNode._topic>1?toolbar_start+toolbar_add+toolbar_del_move+toolbar_end:toolbar_start+toolbar_add+toolbar_end:"cut"==b?toolbar_start+toolbar_add+toolbar_del_move+toolbar_end:isMergeAnswer&&!this.isMergeNewAdded?toolbar_start+toolbar_add+toolbar_copy+toolbar_end:isMergeAnswer?toolbar_start+toolbar_add+toolbar_copy+toolbar_del+toolbar_movedown+toolbar_movelast+toolbar_end:toolbar_start+toolbar_add+toolbar_copy+toolbar_del_move+toolbar_end,this.isCepingQ&&(a.innerHTML=""),a.OpCreated=!0,this.divTableOperation.style.visibility="visible",c=$$("span",a)[0],this.editQLink=c)}function qonmouseover(){this.isEditing||(this.divInsertOp.parentNode.style.display="",this.divInsertOp.style.visibility="visible",this.divTableOperation&&(this.divTableOperation.style.visibility="visible"),isCepingQ&&"page"==this.dataNode._type&&"1"==this.dataNode._topic&&(this.divInsertOp.style.visibility="hidden"));var b=this.className.toLowerCase();b.indexOf("div_question_onclick")<0&&this!=curinsert&&(this.className=b.indexOf("div_question_error")<0?"div_question div_question_mouseover":"div_question div_question_mouseover div_question_error"),this.createOp(),isMergeAnswer&&(this.style.cursor="default"),curover=this}function qonmouseout(){this.divInsertOp.style.visibility="hidden";var b=this.className.toLowerCase();b.indexOf("div_question_onclick")<0&&this!=curinsert&&(this.className=b.indexOf("div_question_error")<0?"div_question div_question_mouseout":"div_question div_question_mouseout div_question_error"),this.hasDisplayEditTip&&(sb_setmenunav(toolTipLayer,!1,this),this.hasDisplayEditTip=!1),this.divTableOperation&&(this.divTableOperation.style.visibility="hidden")}function getObjPos(a){var c,d,b=y=0;if(a.getBoundingClientRect)c=a.getBoundingClientRect(),d=document.documentElement,b=c.left+Math.max(d.scrollLeft,document.body.scrollLeft)-d.clientLeft,y=c.top+Math.max(d.scrollTop,document.body.scrollTop)-d.clientTop;else for(;a&&a!=document.body;)b+=a.offsetLeft,y+=a.offsetTop,a=a.offsetParent;return{x:b,y:y}}function getCurPos(a){a=a||window.event;var b=document.documentElement||document.body;return a.pageX?{x:a.pageX,y:a.pageY}:{x:a.clientX+b.scrollLeft-b.clientLeft,y:a.clientY+b.scrollTop-b.clientTop}}function mouseOverout(a){a.onmouseover=qonmouseover,a.onmouseout=qonmouseout
}function setQHandler(a){mouseOverout(a),a.createOp=createOp,a.deleteQ=deleteQ}function initEventHandler(){var b,c,a=$("divId");for(a.onmouseover=function(){this.style.background="#FAFAFA"},a.onmouseout=function(){this.style.background="#fff"},mouseOverout(firstPage),firstPage.createOp=createOp,b=0;b<questionHolder.length;b++)c=questionHolder[b],setQHandler(c)}function stopPropa(a){a=a||window.event,a&&(a.stopPropagation?a.stopPropagation():a.cancelBubble=!0)}function cancelDblClick(){}function toggleNav(a){var b=a.parentNode;b.className="open"==b.className?"":"open"}function hidePrev(){PrevTimeSet&&clearTimeout(PrevTimeSet);var a=document.getElementById("prev_box");a.innerHTML="",a.style.visibility="hidden"}function BaseAction(){}function DeleteAction(a,b){this.deleteDiv=a,this.prevDiv=b,this.status="done"}function undo(){actionIndex>0&&actionStack[--actionIndex].undo()}function redo(){actionIndex<actionStack.length&&actionStack[actionIndex++].redo()}var PrevTimeSet,needAddArray,ipageIndex,batchAddPage,batchStep,curNewQ,hasDisplayEditTipTimes,actionStack,actionIndex,toolbar_start="<ul class='stuff'>",toolbar_add="<li><a href='javascript:void(0);' onclick='editQ(this);return false;'><span class='design-icon design-edit'></span><span>编辑</span></a></li>",toolbar_copy="<li class='li_copy'><a href='javascript:void(0);' onclick='curover.copyQ();return false;' title='复制此题'><span class='design-icon design-copy'></span><span>复制</span></a></li>",toolbar_moveup="<li class='li_up'><a href='javascript:void(0);' onclick='curover.moveUp();return false;'  title='将此题上移'><span class='design-icon design-up'></span><span>上移</span></a></li>",toolbar_movedown="<li class='li_down'><a href='javascript:void(0);' onclick='curover.moveDown();return false;'  title='将此题下移'><span class='design-icon design-down'></span><span>下移</span></a></li>",toolbar_movefirst="<li class='li_first'><a href='javascript:void(0);' onclick='curover.moveFirst();return false;'  title='将此题移动到第一题'><span class='design-icon design-first'></span><span>最前</span></a></li>",toolbar_movelast="<li class='li_last'><a href='javascript:void(0);' onclick='curover.moveLast();return false;'  title='将此题移动到最后一题'><span class='design-icon design-last'></span><span>最后</span></a></li>",toolbar_del="<li class='li_del' onmouseover='openDelWindow(curover,this);' onmouseout='this.hasOut=true;sb_setmenunav(batchDeleteMenu,false);' style='height:23px;'><a href='javascript:;' onclick='curover.deleteQ();sb_setmenunav(batchDeleteMenu,false);return false;' ><span class='design-icon design-delete'></span><span>删除</span></a></li>",toolbar_del_move=toolbar_del+toolbar_moveup+toolbar_movedown+toolbar_movefirst+toolbar_movelast,toolbar_end="<div style='clear:both;'></div></ul>",clickKaoShi=!1;Array.prototype.indexOf=function(a){for(var b=0,c=this.length;c>b;b++)if(this[b]==a)return b;return-1},Array.prototype.moveUp=function(a){var b=this.indexOf(a);return this._moveElement(b,-1)},Array.prototype.moveFirst=function(a){for(var b=this.indexOf(a);this._moveElement(b--,-1););5==newQType&&this.moveDown(a)},Array.prototype.moveDown=function(a){var b=this.indexOf(a);return this._moveElement(b,1)},Array.prototype.moveLast=function(a){for(var b=this.indexOf(a);this._moveElement(b++,1););},Array.prototype.moveTo=function(a,b){var e,c=this.indexOf(a),d=Math.abs(b-c);if(b>c)for(e=0;d>e;e++)this._moveElement(c++,1);else for(e=0;d>e;e++)this._moveElement(c--,-1)},Array.prototype._moveElement=function(a,b){var c,d;return 0>a||a>=this.length?!1:(c=a+b,0>c||c>=this.length||c==a?!1:(d=this[c],this[c]=this[a],this[a]=d,!0))},Array.prototype.insertAt=function(a,b){this.splice(b,0,a)},Array.prototype.forEach||(Array.prototype.forEach=function(a,b){var c,d,e,f,g;if(null==this)throw new TypeError("this is null or not defined");if(e=Object(this),f=e.length>>>0,"function"!=typeof a)throw new TypeError(a+" is not a function");for(arguments.length>1&&(c=b),d=0;f>d;)d in e&&(g=e[d],a.call(c,g,d,e)),d++}),Array.prototype.insertBefore=function(a,b){this.insertAt(a,this.indexOf(b))},Array.prototype.remove=function(a){return this.removeAt(this.indexOf(a)),a},Array.prototype.removeAt=function(a){var b=this[a];return b&&this.splice(a,1),b},needAddArray=null,ipageIndex=0,batchAddPage=!1,batchStep=10,curNewQ=null,hasDisplayEditTipTimes=0,initEventHandler(),actionStack=new Array,actionIndex=0,BaseAction.prototype.exec=function(){actionStack[actionIndex++]=this},BaseAction.prototype.undo=function(){return!1},BaseAction.prototype.redo=function(){return!1},DeleteAction.prototype=new BaseAction,DeleteAction.prototype.undo=function(){"done"==this.status&&(this.prevDiv.parentNode.insertBefore(this.deleteDiv,this.prevDiv),this.prevDiv.parentNode.insertBefore(this.prevDiv,this.deleteDiv),this.prevDiv==firstPage?questionHolder.unshift(this.deleteDiv):(questionHolder.insertBefore(this.deleteDiv,this.prevDiv),questionHolder.moveUp(this.prevDiv)),updateTopic(),this.deleteDiv.focus(),this.status="undone")},DeleteAction.prototype.redo=function(){"undone"==this.status&&(this.deleteDiv.deleteQ(),this.status="done")};