function StringBuilder(){this._stringArray=new Array}function RndNum(a){var c,b="";for(c=0;a>c;c++)b+=Math.floor(10*Math.random());return b}function forbidBackSpace(a){var b=a||window.event,c=b.target||b.srcElement,d=c.type||c.getAttribute("type"),e=8==b.keyCode&&"password"!=d&&"text"!=d&&"textarea"!=d;return e?!1:void 0}function getGapFillCount(a){var e,b=0,c=0,d=a.length;do if(c=a.indexOf(GapFillStr,c),-1!=c)for(b++,c+=GapFillStr.length,e=c;d>e&&"_"==a.charAt(e);e++)c++;while(-1!=c);return b}function replaceImg(a){var b="http://pubimageqiniu.paperol.cn",c="//pubnewfr.paperol.cn";0==a.src.indexOf("http://pubssl.sojump.com")||0==a.src.indexOf("https://pubssl.sojump.com")||0==a.src.indexOf("http://pubimage.sojump.com")||0==a.src.indexOf("http://pubimage.sojump.cn")||0==a.src.indexOf("http://pubssl.sojump.cn")?(a.src=a.src.replace("http://pubssl.sojump.com",b).replace("https://pubssl.sojump.com",b).replace("http://pubimage.sojump.com",b).replace("http://pubimage.sojump.cn",b).replace("http://pubssl.sojump.cn",b),hasErrorImg=!0):(0==a.src.indexOf("http://pubalifr.sojump.com")||0==a.src.indexOf("https://pubalifr.sojump.com")||0==a.src.indexOf("https://pubali.sojump.com")||0==a.src.indexOf("http://pubali.sojump.com")||0==a.src.indexOf("http://pubali.sojump.cn")||0==a.src.indexOf("http://pubalifr.sojump.cn")||0==a.src.indexOf("https://pubali.sojump.cn")||0==a.src.indexOf("https://pubalifr.sojump.cn"))&&(a.src=a.src.replace("http://pubalifr.sojump.com",c).replace("https://pubalifr.sojump.com",c).replace("http://pubali.sojump.com",c).replace("https://pubali.sojump.com",c).replace("http://pubali.sojump.cn",c).replace("https://pubali.sojump.cn",c).replace("http://pubalifr.sojump.cn",c).replace("https://pubalifr.sojump.cn",c),hasErrorImg=!0)}function replaceGapFill(a,b){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,c=0,d=0;EndGapReq=!0,b._requir&&(e=a.indexOf("<br"),e>-1&&(f=a.indexOf(GapFillStr),f>e&&(EndGapReq=!1,a=a.substring(0,e)+"<span class='req'>&nbsp;*</span>"+a.substring(e)))),g=new StringBuilder,h=0;do{if(d=c,c=a.indexOf(GapFillStr,c),i=GapFillStr,j="",k=!1,b._requir&&b._rowVerify)for(l=0;l<b._rowVerify.length;l++)if(0==b._rowVerify[l]._isRequir){k=!0,EndGapReq=!1;break}if(-1!=c){for(m=0,g.append(a.substr(d,c-d)),c+=GapFillStr.length,n=c;n<a.length&&"_"==a[n];n++)m++,i+="_",c++;if(o=GapWidth+m*(GapWidth/3),o>600&&(o=600),p=!1,b._rowVerify[h]&&("日期"==b._rowVerify[h]._verify?(o=70,p=!0):"指定选项"==b._rowVerify[h]._verify&&(j=b._rowVerify[h]._choice)),q="",b._isCeShi&&(r=b._rowVerify,r[h]&&(s=r[h]._answer||"请设置答案",q=s+":"+(r[h]._ceshiValue||1)+"分",t=12*s.length+24,t>o&&(o=t))),u="",u=j?GapFillReplace.replace("width:"+GapWidth+"px","display:none;width:"+o+"px"):GapFillReplace.replace("width:"+GapWidth+"px","width:"+o+"px"),q&&(u=u.replace("/>"," value='"+q+"'/>")),u=b._useTextBox?u.replace("/>"," class='inputtext'/>"):u.replace("/>"," class='underline'/>"),v="",j){for(w=j.split("|"),x=w[0].split(/[,，]/),y=w[1]||"请选择",z="<select style='vertical-align:middle;'><option value=''>"+y+"</option>",l=0;l<x.length;l++)A=x[l],z+="<option value='"+A+"'>"+A+"</option>";z+="</select>",u=u.replace("/>","/>"+z),v="left:-4px;"}B=!0,b._rowVerify[h]&&0==b._rowVerify[h]._isRequir&&(B=!1),g.append(u),k&&B&&g.append("<span class='req' style='top:5px;position:relative;"+v+"'>&nbsp;*</span>"),h++}else d<a.length&&g.append(a.substr(d))}while(-1!=c);return g.toString()}function showItemDesc(a){var e,f,g,h,c=document.getElementById(a),d=document.getElementById("divDescPopData");d.innerHTML=c.innerHTML,e=trim(c.innerHTML),0==e.indexOf("http")?PDF_launch(e.replace(/&amp;/g,"&"),800,600):(f=document.getElementById("divDescPop"),f.style.width="500px",g=d.offsetHeight+20,h=500,500>g&&g>30&&(h=g),PDF_launch("divDescPop",500,h))}function replace_specialChar(a){return a.replace(/(§)/g,"ξ").replace(/(¤)/g,"○").replace(/(〒)/g,"╤")}function getCoords(a){var b=a.getBoundingClientRect(),c=a.ownerDocument,d=c.body,e=c.documentElement,f=e.clientTop||d.clientTop||0,g=e.clientLeft||d.clientLeft||0,h=b.top+(self.pageYOffset||e.scrollTop||d.scrollTop)-f,i=b.left+(self.pageXOffset||e.scrollLeft||d.scrollLeft)-g;return{top:h,left:i}}function mouseCoords(a){return a?a.pageX||a.pageY?{x:a.pageX,y:a.pageY}:{x:a.clientX+document.body.scrollLeft-document.body.clientLeft,y:a.clientY+document.body.scrollTop-document.body.clientTop}:void 0}function showFillData(a){toolTipLayer.innerHTML="选中此项后，需要进行填空",sb_setmenunav(toolTipLayer,!0,a)}function sb_setmenunav(a,b,c,d,e){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,f=a;"object"!=typeof f&&(f=document.getElementById(a)),f&&(b&&(f.timeArray&&(window.clearTimeout(f.timeArray),f.timeArray=0),f.style.display="block",f.onmouseover||(f.onmouseover=function(){sb_setmenunav(a,!0)},f.onmouseout=function(){sb_setmenunav(a,!1)}),d?(g=window.event||sb_setmenunav.caller.arguments[0],h=mouseCoords(g),f.style.left=h.x+1+"px",f.style.top=h.y+1+"px"):c&&(i=c,"li"!=i.parentNode.tagName.toLowerCase()||e||(i=c.parentNode),j=getCoords(i),k=j.left,l=j.top+i.offsetHeight,m=e||document.documentElement.clientHeight||document.body.clientHeight,n=document.documentElement.clientWidth||document.body.clientWidth,1440>=n&&(f.style.position="fixed"),o=n,"divDesc"==f.id&&(o=700),c.nextObj&&(l=j.top-33),p=c.parentNode.parentNode.className&&"tabqtypet"==c.parentNode.parentNode.className.toLowerCase(),"toolTipLayer"!=f.id||e||(q=f.clientWidth-c.clientWidth,k-=q/2),"toolTipLayerTop"==f.id?l=l-f.clientHeight-30:"divInsertQ"==f.id?l+=10:"batchDeleteMenu"!=f.id&&(r=getIEVersion(),r&&9>r&&(l-=10)),p&&(k-=(f.offsetWidth-c.offsetWidth)/2,prevQType&&prevQType!=f&&(prevQType.style.display="none"),prevQType=f),k+f.offsetWidth>o&&(k=o-f.offsetWidth-30),l+f.offsetHeight>m&&(s=30,p&&(s=0),t=m-s-l,30>t&&(t=30),f.style.height=t+"px"),f.style.left=k+"px",f.style.top=l+"px")),c&&"a"==c.tagName.toLowerCase()?(f.needSaveClass=c,f.prevClass=c.className):f.needSaveClass&&(f.needSaveClass.className=b?f.prevClass?f.prevClass+" hover":"hover":f.prevClass||""),b||(f.timeArray=window.setTimeout(function(){f.style.display="none",f.style.height="",f.style.overflow="",toolTipLayer.style.marginTop="10px"},300)))}function getFillStr(a){var c,b="";for(c=0;a>c;c++)b+=GapFillStr;return b||(b=GapFillStr),b}function getByClass(a,b,c){var f,d=$$(a,b),e=new Array;for(f=0;f<d.length;f++)d[f].className.toLowerCase()==c.toLowerCase()&&e.push(d[f]);return e}function getbyTagName(a,b,c){var d,e;for(e=0;e<a.childNodes.length;e++)d=a.childNodes[e],d.tagName===b&&c.push(d),d.childNodes.length>0&&1==d.nodeType&&getbyTagName(d,b,c)}function Request(a){var f,g,b=window.document.location.href,c=b.indexOf("?"),d=b.substr(c+1),e=d.split("&");for(f=0;f<e.length;f++)if(g=e[f].split("="),g[0].toUpperCase()==a.toUpperCase())return g[1];return""}function isEmpty(a){return""==trim(a)}function isInt(a){var b=/^-?[0-9]+$/;return b.test(a)}function isPositive(a){var b=/^\+?[1-9][0-9]*$/;return b.test(a)}function toInt(a){return parseInt(trim(a))}function trim(a){return a&&a.replace?a.replace(/(^\s*)|(\s*$)/g,""):a}function init_page(){addEventSimple(window,"resize",setSidePos),"2"==vipUser&&(EditToolBarItems.push("source"),EditToolBarItemsPageCut.push("source")),setSidePos(),show_status_tip("正在读取数据，请稍后..."),processData(),interval_time=setInterval(autoSave,9e4),setTimeout(function(){window._czc&&window.screen&&window.screen.width&&_czc.push(["_trackEvent","屏幕宽度","w"+window.screen.width])},5e3)}function processData(){var a,c,d;if(serverVersion&&serverVersion!=designversion)return alert("很抱歉，由于问卷星系统版本升级，您本机使用的脚本文件已过期，请您刷新页面或者重启浏览器再编辑问卷！"),void 0;if(a=hfData.value,"error"==a)window.location="/error/error.aspx?source=designQHandler";else if("timeout"==a)alert("您的登录信息超时，请重新登录，谢谢！"),window.location="/wjx/manage/myquestionnaires.aspx";else{show_status_tip("数据读取成功，初始化..."),set_data_fromServer(a),set_data_toDesign(),isCompleteLoad=!0;try{Calculatedscore()}catch(b){}if(loadComplete(),document.title="设计问卷 － 专业的在线问卷调查平台",100>total_question)for(c=document.getElementsByTagName("img"),d=0;d<c.length;d++)c[d].onerror=function(){this.onerror=null,replaceImg(this)},replaceImg(c[d])}}function autoSave(){var a=$("chkAutoSave");a.checked&&save_paper("edit",!1)}function showCeShiInfo(){(hasCeShiQ||isKaoShi)&&($("spanRandom").parentNode.style.display="none",$("chkUseSelfTopic").parentNode.style.display="none")}function set_data_fromServer(a,b){var f,g,h,i,j,k,l,m,n,o,c=new Array,d=a,e="";if(window.dqdata?e=window.dqdata:(f=a.split("£"),d=f[0],e=f[1]),c=d.split("¤"),g=new Array,g=e.split("§"),isMergeAnswer="true"==g[0]?!0:!1,isMergeAnswer&&(h=$("chkAutoSave"),h.checked=!1),userGuid=g[1],langVer=Number(g[2]),i=new Array,i=c[0].split("§"),WjxActivity._start_time=i[0],WjxActivity._title=i[1],WjxActivity._tag=i[2],WjxActivity._random_begin=i[3],WjxActivity._random_end=i[4],WjxActivity._random_mode=i[5],WjxActivity._use_self_topic="true"==i[6]?!0:!1,WjxActivity._display_part=!1,WjxActivity._display_part_num=0,WjxActivity._partset="",WjxActivity._partsetnew="","1"==WjxActivity._random_mode||"2"==WjxActivity._random_mode?(WjxActivity._display_part="true"==i[7]?!0:!1,WjxActivity._display_part&&(WjxActivity._display_part_num=parseInt(i[8]))):"3"==WjxActivity._random_mode||"4"==WjxActivity._random_mode?WjxActivity._partset=i[7]||"":"5"==WjxActivity._random_mode&&(WjxActivity._partsetnew=i[7]||""),window.categoreDate){if(j=window.categoreDate.split("〒"),j[0])for(k=j[0].split("§"),l=0;l<k.length;l++)m=k[l].split("|"),2==m.length&&(CategoryIdtoname[m[0]]=m[1]);if(j[1])for(n=j[1].split("§"),l=0;l<n.length;l++)o=n[l].split("|"),2==o.length&&(QuesidtoCategoryId[o[0]]=o[1])}for(l=1;l<c.length;l++)DataArray[l-1]=set_string_to_dataNode(c[l],!0,b),"page"!=DataArray[l-1]._type&&"cut"!=DataArray[l-1]._type&&initQCount++;showCeShiInfo()}function setLiCat(){}function isQuestionLikert(a){var b=a._type,c=a._tag||0;return"radio"==b&&c}function set_string_to_dataNode(a,b,c){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,d=new Object,e=new Array,f=a.split("¤");switch(e=f[0].split("§"),d._type=e[0],e[0]){case"page":d._topic=e[1],d._title=e[2],d._iszhenbie="true"==e[4],d._istimer="time"==e[4],d._mintime=e[5]?parseInt(e[5]):"",d._maxtime=e[6]?parseInt(e[6]):"",c||total_page++;break;case"cut":d._title=e[1],d._video=e[2]||"",d._relation=e[3]||"";break;case"fileupload":d._topic=e[1],g=e[2].split("〒"),d._title=g[0],d._keyword=2==g.length?g[1]:"",d._relation=g[2]||"",d._requir="true"==e[4]?!0:!1,d._width=e[5]?parseInt(e[5]):200,d._ext=e[6]||"",-1!=e[7].indexOf("〒")?(h=e[7].split("〒"),d._maxsize=h[0]?parseInt(h[0]):4096,d._uploadlimit=h[1]?parseInt(h[1]):1):(d._maxsize=e[7]?parseInt(e[7]):4096,d._uploadlimit=1),d._ins=e[8],d._hasjump="true"==e[9]?!0:!1,d._anytimejumpto=e[10],e[11]&&(i=e[11].split("〒"),d._isCeShi=!0,d._ceshiValue=i[0]||5,d._ceshiDesc=i[1]||""),"true"==e[12]&&(d._isvoice=!0),QuesidtoCategoryId[e[1]]&&(d._categoryid=QuesidtoCategoryId[e[1]]);break;case"slider":d._topic=e[1],g=e[2].split("〒"),d._title=g[0],d._keyword=2==g.length?g[1]:"",d._relation=g[2]||"",d._requir="true"==e[4]?!0:!1,d._minvalue=e[5],d._maxvalue=e[6],d._minvaluetext=e[7],d._maxvaluetext=e[8],d._ins=e[9],d._hasjump="true"==e[10]?!0:!1,d._anytimejumpto=e[11],QuesidtoCategoryId[e[1]]&&(d._categoryid=QuesidtoCategoryId[e[1]]);break;case"question":d._topic=e[1],g=e[2].split("〒"),d._title=g[0],d._keyword=2==g.length?g[1]:"",d._relation=g[2]||"",d._height=e[4]?parseInt(e[4]):1,d._maxword=e[5],d._requir="true"==e[6]?!0:!1,d._norepeat="true"==e[7]?!0:!1,d._default=e[8],d._ins=e[9],d._hasjump="true"==e[10]?!0:!1,d._anytimejumpto=e[11],d._verify=e[12],e[13]&&(j=e[13].split("〒"),d._needOnly="true"==j[0]?!0:!1,d._needsms="true"==j[1]?!0:!1),d._hasList="true"==e[14]?!0:!1,d._listId=e[15]?parseInt(e[15]):-1,d._width=e[16]?parseInt(e[16]):"",d._underline="true"==e[17]?!0:!1,d._minword=e[18]?parseInt(e[18]):"",e[19]&&("多级下拉"==d._verify?d._levelData=e[19]||"":(k=e[19].split("〒"),d._isCeShi=!0,d._ceshiValue=k[0]||5,d._answer=k[1]||"请设置答案",d._ceshiDesc=k[2]||"",d._include="true"==k[3],hasCeShiQ=!0)),QuesidtoCategoryId[e[1]]&&(d._categoryid=QuesidtoCategoryId[e[1]]);break;case"gapfill":if(d._topic=e[1],g=e[2].split("〒"),d._title=g[0],d._keyword=2==g.length?g[1]:"",d._relation=g[2]||"",d._requir="true"==e[4]?!0:!1,d._gapcount=e[5]?parseInt(e[5]):1,d._ins=e[6],d._hasjump="true"==e[7]?!0:!1,d._anytimejumpto=e[8],l=e[9]||"",d._rowVerify=new Array,e[11]&&(m=e[11].split("〒"),"1"==m[0]&&(d._isCeShi=!0,hasCeShiQ=!0,d._ceshiDesc=m[1]||"")),e[12]&&(d._isCloze=!0),l)for(n=l.split("〒"),o=0;o<n.length;o++)p=new Object,q=n[o].split("¦"),"指定选项"==q[0]?(p._verify=q[0],p._choice=q[1]||"",d._isCloze?(p._ceshiValue=q[2]||1,p._answer=q[3]||"",p._ceshiDesc=q[4]||""):p._isRequir="false"==q[2]?!1:!0):(r=n[o].split(","),p._verify=r[0],p._minword=r[1],p._maxword=r[2],d._isCeShi?(p._ceshiValue=r[3]||1,p._answer=r[4]||"请设置答案",p._ceshiDesc=r[5]||"",p._include="true"==r[6],hasCeShiQ=!0):(p._isRequir="false"==r[3]?!1:!0,p._needOnly="true"==r[4])),d._rowVerify[o]=p;d._useTextBox="true"==e[10],QuesidtoCategoryId[e[1]]&&(d._categoryid=QuesidtoCategoryId[e[1]]);break;case"sum":d._topic=e[1],g=e[2].split("〒"),d._title=g[0],d._keyword=2==g.length?g[1]:"",d._relation=g[2]||"",d._requir="true"==e[4]?!0:!1,d._total=parseInt(e[5]),d._rowtitle=e[6],d._rowwidth=e[7].indexOf("%")>-1?e[7]:"",d._ins=e[9],d._hasjump="true"==e[10]?!0:!1,d._anytimejumpto=e[11],QuesidtoCategoryId[e[1]]&&(d._categoryid=QuesidtoCategoryId[e[1]]);break;case"radio":case"check":case"radio_down":case"matrix":case"boolean":if("boolean"==e[0]?(d._isbool=!0,d._type="radio"):d._type=e[0],d._topic=e[1],g=e[2].split("〒"),d._title=g[0],d._keyword=2==g.length?g[1]:"",d._relation=g[2]||"",d._mainWidth=g[3]||"",d._hasitemrelation="true"==g[4]?!0:!1,d._tag=isInt(e[3])?toInt(e[3]):0,"matrix"==d._type?(s=e[4].split("〒"),d._rowtitle=s[0].replace(/\|1/g,""),s[0].indexOf("|1")>-1&&(d._reverseScoringRowtitle=s[0]),d._rowtitle2=s.length>=2?s[1]:"",d._columntitle=3==s.length?s[2]:""):(t=e[4].split("〒"),d._numperrow=isInt(t[0])?toInt(t[0]):1,d._randomChoice=!1,2==t.length&&(d._randomChoice="true"==t[1]?!0:!1)),d._hasvalue="true"==e[5]?!0:!1,d._hasjump="true"==e[6]?!0:!1,d._anytimejumpto=e[7],"check"==e[0]||"matrix"==e[0]&&"102"==d._tag?(u=e[8].split(","),d._requir="true"==u[0]?!0:!1,"shop"==u[1]?d._isShop=!0:"part"==u[1]?d._partScore=!0:(d._lowLimit=u[1],d._upLimit=u[2])):"true"==e[8]?d._requir=!0:"radio"==e[0]?(u=e[8].split(","),d._requir="true"==u[0],"1"==u[1]?d._isQingJing=!0:"2"==u[1]&&(d._ispanduan=!0)):d._requir=!1,"matrix"==d._type){if(w=e[9].split("〒"),x=w[0].split(","),d._rowwidth=x[0].indexOf("%")>-1?x[0]:"",d._randomRow="true"==x[1],d._rowwidth2="",w.length>=2&&(d._rowwidth2=w[1].indexOf("%")>-1?w[1]:""),d._minvalue=0,d._maxvalue=10,"202"==d._tag||"301"==d._tag)d._minvalue=w[2]||"",y=w[3]||"",d._maxvalue=y,"301"==d._tag&&(z=y.split(","),d._maxvalue=z[0]||"",d._digitType=z[1]||0,"true"==w[4]&&(d._noslider=!0));else if("102"==d._tag||"103"==d._tag)d._daoZhi="true"==w[2];else if("201"==d._tag||"302"==d._tag){if(d._hasvalue=!1,l=w[2]||"",d._rowVerify=new Array,l)for(n=l.split(";"),o=0;o<n.length;o++)n[o]&&(p=new Object,q=n[o].split("¦"),"指定选项"==q[1]?(p._verify=q[1],p._choice=q[2]||"",p._isRequir="false"==q[3]?!1:!0,A=parseInt(q[0]),d._rowVerify[A]=p):(r=n[o].split(","),p._verify=r[1],p._minword=r[2],p._maxword=r[3],p._width=r[4]||"",p._isRequir="false"==r[5]?!1:!0,p._needOnly="true"==r[6],A=parseInt(r[0]),d._rowVerify[A]=p));"302"==d._tag&&5==w.length&&isInt(w[3])&&isInt(w[4])&&(d._minvalue=w[3],d._maxvalue=w[4])}d._isTouPiao=!1,d._isCeShi=!1}else B=e[9].split("〒"),"true"==B[0]?(d._isTouPiao=!0,d._touPiaoWidth=isInt(B[1])?parseInt(B[1]):50,d._displayDesc="true"==B[2],d._displayNum="true"==B[3],d._displayPercent="true"==B[4],d._displayThumb="true"==B[5],d._displayDescTxt=B[6]||""):"ceshi"==B[0]?(d._isCeShi=!0,hasCeShiQ=!0,d._ceshiValue=B[1]||5,d._ceshiDesc=B[2],d._displayDesc="true"==B[3],d._displayDescTxt=B[4]||""):"ceping"==B[0]?(d._isCePing=!0,d._displayDesc="true"==B[1],d._displayDescTxt=B[2]||""):"desc"==B[0]&&(d._displayDesc=!0,d._displayDescTxt=B[1]||"");for(d._ins=e[10],C=e[11].split(","),d._verify=C[0],"true"==C[1]&&(d._nocolumn=!0),d._referTopic=e[12],d._referedTopics=e[13],d._select=new Array,D=14,E=D;E<e.length;E++)F=new Array,F=e[E].split("〒"),G=E-D+1,d._select[G]=new Object,d._select[G]._item_title=F[0],d._select[G]._item_radio="true"==F[1]?!0:!1,H=F[2].split("_"),d._select[G]._item_value=H[0],I="",2==H.length&&(I=H[1]),d._select[G]._item_relation=I,d._select[G]._item_jump=F[3],d._select[G]._item_tb=!1,d._select[G]._item_tbr=!1,d._select[G]._item_img="",d._select[G]._item_max="",d._select[G]._item_imgtext=!1,d._select[G]._item_desc="",d._select[G]._item_label="",F.length>=9&&(d._select[G]._item_tb="true"==F[4],d._select[G]._item_tbr="true"==F[5],"matrix"==d._type?d._select[G]._item_max=F[6]||"":d._select[G]._item_img=F[6],d._select[G]._item_imgtext="true"==F[7],d._select[G]._item_img&&"true"!=F[7]&&(d._hideTxt=!0),d._select[G]._item_desc=F[8],d._select[G]._item_label=F[9],d._select[G]._item_huchi="true"==F[10]),c||select_item_num++;if(2==f.length)d._categoryid=f[1];else if(b)if("301"==d._tag||"303"==d._tag||"6"==window.newQType&&"matrix"==d._type)for(J="-1",K=trim(d._columntitle).split("\n"),"6"==window.newQType&&"matrix"==d._type&&(K=trim(d._rowtitle).split("\n")),L=0;L<K.length;L++)G=L+1,M=1e4*parseInt(e[1])+parseInt(G),"-1"==J?J=QuesidtoCategoryId[M]?M+"|"+QuesidtoCategoryId[M]:"-1":QuesidtoCategoryId[M]&&(J+="〒"+M+"|"+QuesidtoCategoryId[M]),d._categoryid=J;else N=e[1],QuesidtoCategoryId[N]&&(d._categoryid=QuesidtoCategoryId[N])}return d}function showJumpTip(a,b,c){if(a){var d=getDataNodeByTopic(b);d&&(html="选择此选项跳转到<span style='color:#0066ff;'>"+getDisplayTitle(d)+"</span>",toolTipLayerMenu.style.width="330px",toolTipLayerMenu.innerHTML=html,sb_setmenunav(toolTipLayerMenu,!0,c))}else sb_setmenunav(toolTipLayerMenu,!1)}function showRelTip(a,b){a?(toolTipLayerMenu.style.width="300px",toolTipLayerMenu.innerHTML="引用前面多选题或者排序题的选中项&nbsp;&nbsp;<a target='_blank' class='link-U00a6e6' href='/help/help.aspx?helpid=217&h=1'>查看示例</a>",b.hasOut=!1,setTimeout(function(){b.hasOut||sb_setmenunav(toolTipLayerMenu,!0,b)},200)):(b.hasOut=!0,sb_setmenunav(toolTipLayerMenu,!1))}function set_data_toDesign(){var b,c,d,e,f,g,a=$("paper_attr_title");a.value=WjxActivity._title,b=$("pater_title"),b.innerHTML=a.value,c=$("paper_attr_desc"),c.value=WjxActivity._tag,d=$("pater_desc"),d.innerHTML=c.value,c.value||(d.innerHTML="添加问卷说明"),e=$("divId"),e.onclick=function(){paper_attr("paper_attr_title")},c.onblur=c.onclick=c.onchange=function(){paper_attr_desc_onblur(this)},f=$("chkUseTopic"),g=$("chkUseSelfTopic"),f.checked=g.checked=WjxActivity._use_self_topic,f.onclick=g.onclick=function(){var a,b;for(WjxActivity._use_self_topic=this.checked,f.checked=g.checked=this.checked,a=0;a<questionHolder.length;a++)b=questionHolder[a].dataNode._type,"cut"!=b&&"page"!=b&&(questionHolder[a].divTopic.style.display=WjxActivity._use_self_topic?"none":"");this.checked&&show_status_tip("设置成功！请在问题标题前添加自定义题号。",4e3)},c.value.indexOf("<")>-1&&(c.style.display="none"),document.title="正在加载问卷，请耐心等待....",set_dataNode_to_Design()}function getIEVersion(){var a=navigator.userAgent.match(/(?:MSIE |Trident\/.*; rv:)(\d+)/);return a?parseInt(a[1]):void 0}function setQTopPos(a){var c,e,b=!1;a.dataNode._select&&a.dataNode._select.length>6&&a.attrMain?(a.attrMain.scrollIntoView(),b=!0):a.dataNode._rowtitle&&a.attrMain&&(c=trim(a.dataNode._rowtitle).split("\n"),c.length>5&&(a.attrMain.scrollIntoView(),b=!0)),b||(document.body.scrollTop||document.documentElement.scrollTop,e=a.offsetTop-10,divSurvey.scrollTop=e)}function set_dataNode_to_Design(){var a,e,f,g,h,b=0,d=document.createDocumentFragment();for(e=0;e<DataArray.length;e++){if(a=create_question(DataArray[e]),d.appendChild(a),"page"==DataArray[e]._type&&null==firstPage?(firstPage=a,window.isTiKu&&(firstPage.style.display="none")):(0==b&&isCepingQ&&(a.isCepingQ=!0),questionHolder[b++]=a),DataArray[e]._referedTopics)for(f=DataArray[e]._referedTopics.split(","),g=0;g<f.length;g++)referRelHT[f[g]]=a;"page"!=DataArray[e]._type&&referRelHT[DataArray[e]._topic]&&(h=referRelHT[DataArray[e]._topic],a._referDivQ=h,h._referedArray||(h._referedArray=new Array),h._referedArray.push(a),"sum"==DataArray[e]._type?a.createSum():a.createTableRadio&&a.createTableRadio())}questions.appendChild(d),0==total_question&&firstPage&&!firstPage.dataNode._title&&(firstPage.style.display="none")}function getDisplayTitle(a){var b=a._topic+".";return WjxActivity._use_self_topic&&(b=""),b+a._title}function getDataNodeByTopic(a){var b,c,d;for(b=0,c=questionHolder.length;c>b;b++)if(d=questionHolder[b].dataNode,"page"!=d._type&&"cut"!=d._type&&a==d._topic)return d;return null}function getjumpNode(a){var b,c,d;for(b=0,c=DataArray.length;c>b;b++)if(d=DataArray[b],"page"!=d._type&&"cut"!=d._type&&a==d._topic)return d;return null}function getDivIndex(a){var b,c,d;for(b=0,c=questionHolder.length;c>b;b++)if(d=questionHolder[b].dataNode,"page"!=d._type&&"cut"!=d._type&&a==d._topic)return b;return-1}function show_status_tip(a,b,c){var d,e;clearTimeout(status_tip_timeout),status_tip.style.display="block",status_tip.innerHTML=a,d=document.documentElement.scrollTop||document.body.scrollTop,e=document.documentElement.clientHeight||document.body.clientHeight,status_tip.hasSetWidth&&(status_tip.style.width=""),status_tip.style.top=d+e-status_tip.offsetHeight-80+"px",c&&c.popHint&&c.popHint(a),status_tip.style.width=divSurvey.offsetWidth-10+"px",b>0&&(status_tip_timeout=setTimeout(function(){status_tip.style.display="none",status_tip.style.width="",status_tip.hasSetWidth=!1,c&&c.popHint&&c.popHint("")},b))}function setSidePos(){var a,b;status_tip.style.right="0px",a=document.documentElement.clientHeight||document.body.clientHeight,divSurvey.style.height=a-57+"px",topnav.style.height=a-100+"px",b=document.documentElement.clientWidth||document.body.clientWidth,1440>b&&(topnav.style.height=a-92+"px"),document.getElementById("m-rightbar").style.right=1440>b?"0":"-48px"}function show(){}function paper_attr(a){var b,c;divQAttr.style.width="740",b="paper_attr_desc",layer.open({zIndex:19491010,content:jQuery("#divQAttr"),shade:.65,area:["720px"," 350px"],title:!1,type:1,success:function(){KE.init({id:b,width:"650px",height:"180px",filterMode:filter,items:EditToolBarItemsPageCut,afterChange:function(a){KE.util.setData(a)},DesignPage:1}),KE.create(b),KE.util.focus(b)},end:function(){KE.remove(b)}}),c=$(a),c.select()}function paper_attr_title_onblur(a){var b=$("pater_title");b.innerHTML=a.value=replace_specialChar(trim(a.value))}function paper_attr_desc_onblur(a){var c,b=$("pater_desc");b.innerHTML=a.value,$("spanHInput").innerHTML=a.value.length,c=1e4-a.value.length,0>c&&(c=0),$("spanLeftInput").innerHTML=c,$("spanDTip").style.display=""}function openTitleEditor(a,b,c){c=c||"";var d="textTitleId";b&&getArgumentsList(b).length>0&&(layerCallBack=b),layer.open({zIndex:19491010,content:jQuery("#divTitleEditor"),shade:.65,area:["680px","432px"],title:c,type:1,success:function(){KE.init({id:d,items:EditToolBarItems,filterMode:filter}),KE.create(d),setInterval(new Function('KE.util.setData("textTitleId")'),500),KE.util.focus(d);var b=a.value||a.innerHTML||"";$("divTitleEditor").initContent=b,KE.util.setFullHtml(d,b)},end:function(){KE.remove(d)}})}function enlargeEditor(a,b){b=b||"",PDF_launch("divTextAreaEditor",800,600,null,b),curEnlargeControl=a;var c=curEnlargeControl.value;$("divTextAreaEditor").initContent=c,txtEnlarge.value=c,createTextAreaWithLines(txtEnlarge)}function createTextAreaWithLines(a){var d,b="",c=a.value.split("\n").length;if(25>c&&(c=25),lineObj.prevLen!=c){for(d=1;c>=d;d++)b.length>0&&(b+="<br>"),b+=d;lineObj.innerHTML=b,lineObj.prevLen=c}}function positionLineObj(a,b){a.style.top=-1*b.scrollTop+lineObjOffsetTop+"px"}function clickOktxt(){curEnlargeControl&&(curEnlargeControl.value=$("txtEnlarge").value,curEnlargeControl.onblur&&curEnlargeControl.onblur()),window.parent.PDF_close()}function clickOK(){var a=KE.util.getData("textTitleId");window.parent.PDF_close(a)}function clickCancel(){var a="-1nc";return CheckIsDirty()?(lconfirm("您要保存刚才所做的更改吗？",function(){a=KE.util.getData("textTitleId"),window.parent.PDF_close(a)}),void 0):(window.parent.PDF_close(a),void 0)}function CheckIsDirty(){var a=KE.util.getData("textTitleId");return $("divTitleEditor").initContent!=a}function getQList(a,b){var d,e,f,g,h,i,j,k;for(a.dataNode._topic,d="",d+="<div style='border-top:1px solid #ccddff;margin:10px 0;'>",e=0,f=questionHolder.length;f>e;e++)if(g=questionHolder[e].dataNode,"page"!=g._type&&(!b||"cut"!=g._type)){if(h=g._topic,questionHolder[e]==a)break;i=h+".",WjxActivity._use_self_topic&&(i=""),j=g._title.replace(/<.+?>/gim,""),k="",k="referSelected("+h+",this);return false;",d+="<div style='margin-top:6px;'><a class='link-U666' onclick='"+k+"' href='javascript:void(0);'  title='"+j+"'>"+i+j.substring(0,23)+"</a></div>"}return d+="</div></div>"}function openReferWindow(a,b){var c="&nbsp;<span style='color:#333;font-weight:bold;'>将前面题目的答案引用到下文：</span>";c+=getQList(a,!0),toolTipLayer.innerHTML=c,toolTipLayer.referObj=b,toolTipLayer.style.width="300px",toolTipLayer.style.overflow="auto",toolTipLayer.style.marginTop="0px",sb_setmenunav(toolTipLayer,!0,b)}function referSelected(a){var g,c="[q"+a+"]",d=cur.gettextarea(),e=d.value.match(/\[q(\d+)\]/);return e&&isInt(e[1])?(alertNew("此题已经设置了引用到第"+e[1]+"题！"),void 0):(d.value.length,g=d.id,KE.g[g].wyswygMode&&(KE.util.focus(g),KE.util.selection(g),KE.util.insertHtml(g,c),KE.util.focus(g)),cur.checkTitle(),toolTipLayer.style.width="250px",show_status_tip("操作成功，被引用题目["+a+"]的答案将会显示在此题标题中！",6e3),sb_setmenunav(toolTipLayer,!1),void 0)}function openDelWindow(a,b){var d,e,c=a.dataNode._topic;"cut"!=a.dataNode._type&&(d="","page"==a.dataNode._type&&(d="&page=1"),e="",e+="<div style='margin:2px 0;'>",e+='<a onclick=\'batchDeleteMenu.style.display="none";PDF_launch("/wjx/design/deletebatchq.aspx?ct='+c+d+"\",500,250);return false;'  href='javascript:void(0);' style='font-size:12px;' class='link-444'>批量删除</a>",e+="</div>",batchDeleteMenu.innerHTML=e,sb_setmenunav(batchDeleteMenu,!0,b))}function openValWindow(a,b){var c="<div style='padding:5px 10px;'>";c+="<div style='cursor:pointer;margin-top:3px;'><a onclick='valChanged(2);return false;' class='link-444' href='javascript:void(0);'>交换选项分数</a></div>",c+="<div style='cursor:pointer;margin-top:3px;'><a onclick='valChanged(0);return false;' class='link-444' href='javascript:void(0);'>分数<b>从1开始</b>顺序递增</a></div>",c+="<div style='cursor:pointer;margin-top:3px;'><a onclick='valChanged(1);return false;' class='link-444' href='javascript:void(0);'>选项分数全部<b>加1</b></a></div>",c+="<div style='cursor:pointer;margin-top:3px;'><a onclick='valChanged(-1);return false;' class='link-444' href='javascript:void(0);'>选项分数全部<b>减1</b></a></div>","matrix"!=cur.dataNode._type||"101"!=cur.dataNode._tag&&"2"!=cur.dataNode._tag&&"3"!=cur.dataNode._tag&&"6"!=cur.dataNode._tag||5==newQType||(c+="<div style='cursor:pointer;margin-top:3px;'><a onclick='reverseScoring();return false;' class='link-444' href='javascript:void(0);'>反向计分项</a></div>"),c+="</div>",toolTipLayer.innerHTML=c,toolTipLayer.valObj=a,toolTipLayer.style.width="160px",sb_setmenunav(toolTipLayer,!0,b)}function reverseScoring(){var a,b,c,d,e,f,g,h;if(toolTipLayer.valObj){for(a=toolTipLayer.valObj.dataNode,a._reverseScoringRowtitle||(a._reverseScoringRowtitle=a._rowtitle),b=trim(a._rowtitle).split("\n"),c=a._reverseScoringRowtitle.split("\n"),d="",e=0;e<b.length;e++)f="【标签】"==b[e].substring(0,4),g=-1==c[e].indexOf("|1")||f?"":"checked",h=f?"hidden":"checkbox",d+='<label class="selItem" for="cbs'+a._topic+"_"+e+'">'+'<input type="'+h+'" id="cbs'+a._topic+"_"+e+'" '+g+' name="" value="" />'+"<span>"+b[e]+"</span></label>";document.getElementById("selItemWrap").innerHTML=d,PDF_launch("reverseScoring",592,552,"","反向计分项")}}function reverseScoringSave(){var c,a=document.getElementById("selItemWrap").getElementsByTagName("input"),b="";for(c=0;c<a.length;c++)b+=a[c].checked&&-1==a[c].nextSibling.innerHTML.indexOf("|1")?trim(a[c].nextSibling.innerHTML)+"|1\n":trim(a[c].nextSibling.innerHTML)+"\n";cur.dataNode._reverseScoringRowtitle=b,cur.updateItem&&cur.updateItem(),toolTipLayer.valObj=null,PDF_close()}function valChanged(a){var b,c,d,e,f,g,h;if(toolTipLayer.valObj){if(b=toolTipLayer.valObj,c=toolTipLayer.valObj.dataNode,d=b.option_radio,0==a)for(e=1;e<d.length;e++)""!=d[e].get_item_value().value&&(d[e].get_item_value().value=e);else if(2==a)for(f=1,g=d.length-1;g>f;)h=d[g].get_item_value().value,d[g].get_item_value().value=d[f].get_item_value().value,d[f].get_item_value().value=h,d[g].get_item_novalue()&&(h=d[g].get_item_novalue().checked,d[g].get_item_novalue().checked=d[f].get_item_novalue().checked,d[f].get_item_novalue().checked=h),f++,g--;else for(e=1;e<d.length;e++)""!=d[e].get_item_value().value&&(d[e].get_item_value().value=parseInt(c._select[e]._item_value)+a);b.updateItem(),toolTipLayer.valObj=null,sb_setmenunav(toolTipLayer,!1)}}function openProvinceWindow(a,b){var f,g,h,i,c="北京,天津,河北,山西,内蒙古,辽宁,吉林,黑龙江,上海,江苏,浙江,安徽,福建,江西,山东,河南,湖北,湖南,广东,广西,海南,重庆,四川,贵州,云南,西藏,陕西,宁夏,甘肃,青海,新疆,香港,澳门,台湾,其它国家,不指定",d="<div style='padding:5px 10px;'>",e=c.split(",");for(f=1;f<=e.length;++f)g=e[f-1],h="link-06f","不指定"==g&&(h="link-f60"),i="<span style='cursor:pointer;margin-top:3px;'><a onclick='provinceChanged(this);return false;' class='"+h+"' href='javascript:void(0);'>"+g+"</a></span>",d+=i,d+=0==f%8?"<div></div>":"&nbsp;&nbsp;";d+="</div>",toolTipLayer.innerHTML=d,toolTipLayer.provinceObj=b,toolTipLayer.style.width="360px",sb_setmenunav(toolTipLayer,!0,b)}function provinceChanged(a){toolTipLayer.provinceObj&&(toolTipLayer.provinceObj.value=a.innerHTML,"不指定"==toolTipLayer.provinceObj.value&&(toolTipLayer.provinceObj.value=""),toolTipLayer.provinceObj.onblur&&toolTipLayer.provinceObj.onblur(),toolTipLayer.provinceObj=null,sb_setmenunav(toolTipLayer,!1))}function getPageQCount(){var d,a=0,b=new Array,c=0;for(d=0;d<questionHolder.length;d++)"page"==questionHolder[d].dataNode._type?(a++,b.push(c),c=0):"cut"!=questionHolder[d].dataNode._type&&c++;return b.push(c),b}function initPageQuestionRandom(){var a="/wjx/design/setrandom.aspx";PDF_launch(a,623,472,null,null)}function setTikuRandom(){var a="/wjx/design/settiku.aspx";2!=newQType?a="/wjx/design/setrandom.aspx":"3"==WjxActivity._random_mode&&(a="/wjx/design/settikuold.aspx"),PDF_launch(a,643,472,null,"题库随机设置")}function $import(a){var b=document.createElement("script");b.setAttribute("src",a),b.setAttribute("type","text/javascript"),document.getElementsByTagName("head")[0].appendChild(b)}function $importNoCache(a){$import(a)}function loadComplete(){show_status_tip("成功获得数据",2e3),save_paper("init",!1),setSidePos(),divMenu.style.visibility="visible",topnav.style.visibility="visible";var a=window.JsVersion||75;$importNoCache("/Js/operation_new.js?v="+a),$importNoCache("/kindeditor/kindeditor.js?v="+a),$importNoCache("/Js/createqattr_new.js?v="+a),$importNoCache("/Js/utility_new.js?v="+a)}function getXmlHttp(){var a;try{a=new XMLHttpRequest}catch(b){try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(b){try{a=new ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}}return a}function removeEventSimple(a,b,c){a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent&&a.detachEvent("on"+b,c)}function addEventSimple(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+b,c)}function control_text(a){var b=document.createElement("input");return b.type="text",b.style.width=10*a+"px",b.className="choicetxt",b}function control_image(a){var b=document.createElement("img");return b.src=a,b}function control_check(){var a=document.createElement("input");return a.type="checkbox",a.tabIndex="-1",a}function control_textarea(a,b){var c=document.createElement("textarea");return c.wrap="soft",c.rows=a,c.style.width=10*b+"px",c.style.height=22*a+"px",c.className="inputtext",c
}function control_btn(a){var b=document.createElement("input");return b.type="button",b.value=a,b}function control_radio(a){var b;if(-1==navigator.appName.indexOf("Microsoft"))return b=document.createElement("input"),b.type="radio",b.name=a,b;try{return b=document.createElement('<input type="radio" name="'+a+'" />')}catch(c){return b=document.createElement("input"),b.type="radio",b.name=a,b}}function addTouPiao(a,b){(b._displayPercent||b._displayNum)&&(b._displayNum&&a.append("<span style='color:#ff6600;'>0票</span>"),b._displayPercent&&(b._displayNum&&a.append("("),a.append("0%"),b._displayNum&&a.append(")")))}function openCityBox(){}function setCityBox(a){txtCurCity.value=a}function setBatchA(){var a=document.getElementById("divbatchq"),b=a.getElementsByTagName("a")[0];b.style.display="",document.getElementById("hrefBatch"),5==newQType&&addCommonQue?(addCommonQue.style.display="",b.onclick=function(){PDF_launch("addbatch360.aspx",792,620)},addCommonQue.onclick=function(){PDF_launch("/newwjx/design/categorysettings.aspx?activity="+activityID+"&type=1",732,620,getcategoryinf)}):isKaoShi||hasCeShiQ?(b.innerHTML="批量添加考试题",b.onclick=function(){PDF_launch("addbatchq.aspx?ks=1",840,640)}):b.onclick=function(){PDF_launch("addbatchq.aspx",840,640)},isKaoShi||hasCeShiQ||(b.innerHTML="批量添加题目",b.className="wjxui-btn wjxui-btn-primary",b.style.width="120px",b.style.height="35px",b.style.lineHeight="35px"),5==newQType&&(a.style.width="300px")}function showhidebatq(){var a=document.getElementById("divbatchq");a&&setBatchA()}function create_question(a,b){function mb(){var a=cur||curover;return a.dataNode._relation=currentRelation||"",a.displayRelation&&a.displayRelation(),!1}function nb(){var a=cur||curover;return a.displayItemRelation&&a.displayItemRelation(),!1}var g,h,i,j,k,l,m,n,o,p,q,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb,ob,pb,qb,rb,sb,c=a._type;return a._verify,a._height>1,_likertMode=a._tag||0,g=!1,isMergeAnswer&&isCompleteLoad&&(g=!0),h=document.createElement("div"),h.className="div_question",h.dataNode=a,h.tabIndex=-1,i=$ce("div","",h),i.className="div_preview",i.onclick=function(){qonclick.call(h)},h.div_question_preview=i,j="question"==c,k="slider"==c,l="sum"==c,m="page"==c,n="cut"==c,o="check"==c,p="radio"==c,q=p&&_likertMode,s="radio_down"==c,t="matrix"==c,u="matrix"==c&&_likertMode>300,v=o&&_likertMode,w="fileupload"==c,x=p||s||o||t,y=!n&&!m,z="gapfill"==c,A="302"==_likertMode&&a._minvalue&&0!=a._minvalue?!0:!1,h.isMergeNewAdded=g,y&&total_question++,QIndentity++,showhidebatq(),B=document.createElement("div"),b||(y&&(C=a._topic,C-=totalHideQcount,D=C+"",0>C-100&&(D+="."),5==newQType&&(D=1==C?"":C-1+"."),hasCeShiQ&&(a._isCeShi||(D="",totalHideQcount++)),E=$ce("div",D,B),h.divTopic=E,E.className="div_topic_question",a._topic-100>=0&&(E.style.fontSize="14px"),WjxActivity._use_self_topic&&(E.style.display="none")),m&&(F=a._iszhenbie,B.style.position="relative",G="<span style='font-size:14px; font-weight:normal;'>[&nbsp;第"+a._topic+"页/共"+total_page+"页&nbsp;]</span>",E=$ce("span",G,B),E.className="div_topic_page_question",H=$ce("div",!1,B),H.className="related_settings",h.title="分页栏",h.divTopic=E,h.divZhenBie=$ce("span","<b style='color:red;'>甄别页</b>",H),a._istimer&&$ce("span","<b style='color:red;'>--时间页</b>",H),h.divZhenBie.style.display=F?"":"none",h.divTimeLimit=$ce("span","",H),h.showTimeLimit=function(){var a="";this.dataNode._istimer?this.dataNode._mintime&&(a="<b style='color:green;'>页面停留时间："+this.dataNode._mintime+"秒</b>"):(this.dataNode._mintime&&(a="<b style='color:green;'>最短填写时间："+this.dataNode._mintime+"秒</b>"),this.dataNode._maxtime&&(a&&(a+="&nbsp;"),a+="<b style='color:red;'>最长填写时间："+this.dataNode._maxtime+"秒</b>")),h.divTimeLimit.innerHTML=a},h.showTimeLimit(),"1"==a._topic&&(isPrevFirstPage=!0))),n&&(B.className="div_title_cut_question"),y&&(B.className="div_title_question_all"),a._isQingJing&&(B.style.display="none"),I=$ce("div","",B),b||(I.onclick=function(a){h.isEditing&&(h.gettextarea().focus(),h.attrMain.scrollIntoView(),stopPropa(a))}),J=a._title,z?(K="<div style='margin-top:8px;'></div>",J=replaceGapFill(J,a).replace(/\<br\s*\/?\>/g,K)):n&&(J=J||"请在此输入说明文字",J.length<=10&&(J="<b>"+J+"</b>")),L=$ce("span",J,I),m?(I.className="div_title_page_question",""==J?I.style.margin="0 auto":(I.style.margin="0 auto",I.style.marginBottom="10px",I.style.borderBottom="1px dashed #efefef")):n&&a._video?(M="<iframe height='498' width='510' src='"+a._video+"' frameborder=0 allowfullscreen></iframe>",h.div_video_title=$ce("div",M,I)):I.className="div_title_question",h.get_div_title=function(){return L},isCepingQ&&"check"==a._type&&"1"==a._topic&&(h.style.display="none"),y&&(N=$ce("span","*",I),h.setreqstatus=function(){return N.className="req",N.style.display=this.dataNode._requir&&!b?"":"none",z?(this.checkTitle&&this.checkTitle(),(!EndGapReq||this.dataNode._partRequir)&&(N.style.display="none")):this.dataNode._requir&&"matrix"==this.dataNode._type&&"201"==this.dataNode._tag&&this.dataNode._partRequir&&(N.style.display="none"),N},h.setreqstatus(),h.updateTitle=function(){this.txttitle&&(this.txttitle.value=this.dataNode._title),this.get_div_title().innerHTML=this.dataNode._title},j&&(O=$ce("span","",I),O.className="font-a0",h.showMinMaxWord=function(a,b){var c=this.dataNode,d="",e=type_wd_words,f=type_wd_minlimit,g="数字"==c._verify||"小数"==c._verify;g&&(e="",f=type_wd_minlimitDigit,d=type_wd_digitfrom),isEmpty(a)||isEmpty(b)?isEmpty(a)?isEmpty(b)?O.style.display="none":(O.innerHTML="&nbsp;（"+f+b+e+"）",O.style.display=""):(O.innerHTML="&nbsp;（"+a+type_wd_limit+"）",g&&(O.innerHTML="&nbsp;（"+type_wd_maxlimitDigit+a+"）"),O.style.display=""):(O.innerHTML="&nbsp;（"+d+b+type_wd_to+a+e+"）",O.style.display="",b!=a||g||(O.innerHTML="&nbsp;（"+a+type_wd_words+"）","学号"==c._verify&&(O.innerHTML="&nbsp;（"+a+"位数字）")))},h.showMinMaxWord(a._maxword,a._minword),h.get_span_maxword=function(){return O}),a._isCeShi&&(j||p||o||w)&&(P=$ce("span","",I),P.style.color="#efa030",j?(h.setCeshiQTip=function(){var b="答案："+a._answer;"简答题无答案"==a._answer&&(b="无标准答案需人工评分"),P.innerHTML="（"+b+"，分值："+a._ceshiValue+"分）"},h.setCeshiQTip()):P.innerHTML="（分值："+a._ceshiValue+"分）",h.spanCeShi=P),a._isTouPiao&&(Q=$ce("span","",I),Q.style.color="#efa030",R="&nbsp;投票题",Q.innerHTML=R),o||t&&"102"==_likertMode?(S=document.createElement("span"),h.updateSpanCheck=function(){var b,c,d,e,f,a=this.dataNode;a._isShop||(a._lowLimit=a._lowLimit||"",a._upLimit=a._upLimit||"",b=type_check,t&&(b="多选题"),c="",d=!1,v&&(c="-1"),e="",a._isTouPiao||(e="["),a._lowLimit!=c&&a._upLimit!=c?(S.innerHTML=a._lowLimit==a._upLimit?"&nbsp;"+e+type_check_limit1+"<b>"+a._lowLimit+"</b>"+type_check_limit5:"&nbsp;"+e+type_check_limit1+"<b>"+a._lowLimit+"</b>-<b>"+a._upLimit+"</b>"+type_check_limit5,d=!0):a._lowLimit!=c?(f=type_check_limit5,"1"==a._lowLimit&&1==langVer&&(f=" item"),S.innerHTML="&nbsp;"+e+type_check_limit3+"<b>"+a._lowLimit+"</b>"+f,d=!0):a._upLimit!=c?(S.innerHTML="&nbsp;"+e+type_check_limit4+"<b>"+a._upLimit+"</b>"+type_check_limit5,d=!0):S.innerHTML="&nbsp;"+e+b,v&&(d?((""==a._lowLimit||a._lowLimit==a._select.length-1)&&(S.innerHTML="&nbsp;["+type_check_limit1+"<b>"+type_order_all+"</b>"+type_check_limit5),S.innerHTML+=type_order_limit_end):S.innerHTML="&nbsp;["+type_order),a._isTouPiao||(S.innerHTML+="]"),a._isCeShi&&(S.innerHTML="["+type_check+"]"),S.className="qtypetip")},h.updateSpanCheck(),I.appendChild(S)):u&&(S=$ce("span","",I),h.updateSpanCheck=function(){"301"==this.dataNode._tag&&""!==this.dataNode._minvalue&&""!==this.dataNode._maxvalue?(S.innerHTML="&nbsp;[输入"+this.dataNode._minvalue+"到"+this.dataNode._maxvalue+"的数字]",S.className="qtypetip"):S.innerHTML="",S.style.display="301"==this.dataNode._tag?"":"none"},h.updateSpanCheck()),t&&("102"==a._tag||"103"==a._tag)&&(T=$ce("span","",I),h.updateSpanMatrix=function(){if(a._daoZhi){var b="竖向单选";"102"==a._tag&&(b="竖向多选"),T.innerHTML="&nbsp;["+b+"]",T.className="qtypetip"}else T.innerHTML=""},h.updateSpanMatrix()),U=$ce("span","",I),h.updateSpancategory=function(){var c,d,a=h.dataNode,b=h.dataNode._tag?h.dataNode._tag:0;300>=b&&(a._categoryid&&"-1"!=a._categoryid?(c=a._categoryid,CategoryIdtoname[c]&&(d="/newwjx/design/ChangeCategory.aspx?activity="+activityID+"&ct="+a._topic+"&cid="+c,U.innerHTML="<br/><a href='###' onclick='PDF_launch(\""+d+"\",550,200);stopPropa(event);' >  ["+CategoryIdtoname[c]+"]</a>",U.className="qtypetip")):U.innerHTML="")},h.updateSpancategory()),V=$ce("div","",B),V.style.clear="both",i.appendChild(B),(y||n)&&(W=$ce("div","",i),W.className="div_table_par"),y&&(X=document.createElement("div"),X.className="div_ins_question",X.innerHTML=a._ins||"",X.style.display=a._ins?"":"none",W.appendChild(X),h.get_div_ins=function(){return X},Y=document.createElement("div"),Y.className="div_table_radio_question",Z=$ce("div","",Y),Z.className="div_table_clear_top",W.appendChild(Y),a._isQingJing&&(Y.style.paddingLeft="0")),j&&($=$ce("div","",Y),$.style.position="relative",_=control_textarea("1","50"),_.style.paddingLeft="27px",$.appendChild(_),ab=$ce("span","",$),ab.style.position="absolute",ab.style.left="3px",ab.style.top="3px",_.style.overflow="auto",$ce("div","",Y).style.marginBottom="6px","省市区"!=a._verify&&"高校"!=a._verify?_.value=a._default:a._default&&(_.value="指定省份为："+a._default),h.showTextAreaUnder=function(){_.className=this.dataNode._underline?"underline":"inputtext"},h.showTextAreaWidth=function(){isEmpty(this.dataNode._width)?_.style.width="62%":(_.style.width=this.dataNode._width+"px",_.style.display=1==this.dataNode._width?"none":"")},h.showTextAreaHeight=function(){_.style.height=22*this.dataNode._height+"px"},h.showSmsVerify=function(){if(!this.divsms){var a=$ce("div","",Y);a.style.marginTop="15px",a.innerHTML="<a href='javascript:;' style='padding:5px 6px;height:20px;border:1px solid #ccc;background:#eeeeee;display:inline-block;color:#555;font-size:12px;float:left;'>发送验证短信</a><textarea style='text-align:center;width:66px;height:26px;line-height:26px;padding:2px;display:inline-block;border:1px solid #ccc;border-left:none;float:left;overflow:hidden;tabindex:-1;' placeholder='验证码'></textarea><div class='divclear'></div>",this.divsms=a}this.divsms.style.display="手机"==this.dataNode._verify&&this.dataNode._needsms?"":"none"},h.showConfirmPwd=function(){if(!this.divConfirmPwd){var a=$ce("div","",Y);a.style.margin="8px 0",a.innerHTML='<textarea wrap="soft" placeholder="重复输入密码" rows="1" class="inputtext" style="width: 250px;font-size:14px; height: 22px; overflow: auto;padding-left:27px;"></textarea>',this.divConfirmPwd=a}this.divConfirmPwd.style.display="密码"==this.dataNode._verify?"":"none"},h.showTextAreaDate=function(){var d,e,f,a=this.dataNode._verify,c=this.dataNode._topic;_.onclick=null,_.style.background="none",d="",ab.innerHTML="",_.placeholder="","日期"==a||"生日"==a||"入学时间"==a?(_.style.width="100px",_.style.height="22px",d="/images/form/date.png"):"数字"==a||"小数"==a?(_.style.width="150px",_.style.height="22px"):"密码"==a?(_.style.width="250px",_.style.overflow="auto",_.placeholder="密码，至少8位，需包含字母和数字",_.style.fontSize="14px"):"城市单选"==a||"城市多选"==a||"省市区"==a||"高校"==a||"多级下拉"==a||"地图"==a?(_.style.height="22px",_.style.paddingLeft="27px",e="150px",f=1,d="/images/form/city.png","城市多选"==a?(e="400px",f=2):"省市区"==a?(e="250px",f=3):"高校"==a?(e="250px",f=4,d="/images/form/school.png"):"多级下拉"==a?(e="400px",f=5,d="/images/form/click.png"):"地图"==a&&(_.disabled=!0,_.style.resize="none",_.style.height="98px",_.style.borderRadius="2px",_.style.borderStyle="dashed",_.style.cursor="pointer",_.style.background="url('/images/form/getLocal.png')",_.style.backgroundPosition="center",_.style.paddingLeft="0",e="698px",f=6,d=""),b&&(e="600px"),_.style.width=e,_.onclick=function(){openCityBox(this,f,null,c)}):("手机"==a?d="/images/form/mobile.png":"Email"==a?d="/images/form/email.png":"电话"==a||"固话"==a?d="/images/form/tel.png":"QQ"==a?d="/images/form/qq.png":"姓名"==a?d="/images/form/name.png":"网址"==a&&(d="/images/form/website.png"),ab.innerHTML="",this.showTextAreaWidth(),this.showTextAreaHeight()),"密码"==this.dataNode._verify?this.showConfirmPwd():this.divConfirmPwd&&(this.divConfirmPwd.style.display="none"),d&&(ab.innerHTML="<img src='"+d+"' alt=''/>")},h.showTextAreaUnder(),h.showTextAreaWidth(),h.showTextAreaHeight(),h.showTextAreaDate(),h.dataNode._needsms&&h.showSmsVerify(),h.get_textarea=function(){return _}),w&&(bb=$ce("div","",Y),h.updateFileUpload=function(){var d,e,f,g,h,i,b=a._maxsize,c="";c=0==b%1024?"（不超过"+b/1024+"M）":"（不超过"+b+"KB）",d=getIEVersion(),e=d&&(!document.documentMode||document.documentMode<8),f=7>=d||e,g="position:relative;",f&&(g=""),h="选择文件"+c,a._isvoice&&(h="请录制语音（不超过60s）"),i='<div class="file"><img class="uppic" src="/images/newimg/upload@2x.png" alt="">'+h,f||(i+='<input disabled type="file" style="position: absolute;left: 0;top: 0;height: 30px; filter:alpha(opacity=0);opacity:0; background-color: transparent;width:200px; font-size:180px;"/>'),i+="</div>",bb.innerHTML=i},h.updateFileUpload()),k&&(cb=$ce("span",a._minvaluetext||"",Y),cb.className="spanLeft",cb.style.color="red",h.get_span_min_value_text=function(){return cb},db=$ce("span","("+(a._minvalue||0)+")",Y),db.className="spanLeft",db.style.color="red",h.get_span_min_value=function(){return db},eb=$ce("span","("+(a._maxvalue||100)+")",Y),eb.className="spanRight",eb.style.color="red",h.get_span_max_value=function(){return eb},fb=$ce("span",a._maxvaluetext||"",Y),fb.className="spanRight",fb.style.color="red",h.get_span_max_value_text=function(){return fb},$ce("div","",Y).className="divclear",gb=$ce("div","",Y),gb.style.position="relative",gb.style.height="32px",hb=control_image("/Images/WJX/JoinQuestionnaire/slider1.png"),hb.style.width="35px",hb.style.position="absolute",hb.style.top="0",hb.style.left="0",ib=control_image("/Images/WJX/JoinQuestionnaire/sliderEnd.png"),ib.style.width="97%",ib.style.height="5px",ib.style.marginTop="15px",gb.appendChild(hb),gb.appendChild(ib),Y.appendChild(gb),$ce("div","",Y).className="divclear",Y.style.width="60%",_=control_textarea("1","10"),_.style.display="none"),l&&(h.createSum=function(){var c,d,e,f,g,h,i,b=new StringBuilder;if(b.append("<div  class='div_table_clear_top'></div>"),this._referDivQ&&b.append("此题行标题来源于第"+this._referDivQ.dataNode._topic+"题的选中项"),b.append("<table style='width:100%;' border='0px'  cellpadding='5' cellspacing='0'>"),c="",d="",b.append("<tbody>"),e=new Array,e=trim(a._rowtitle).split("\n"),this._referDivQ){for(e=new Array,f=1;f<this._referDivQ.dataNode._select.length&&(e.push(this._referDivQ.dataNode._select[f]._item_title),3!=f);f++);e.push("......")}for(g="",h=0;h<e.length;h++)h==e.length-1&&(c="",d=""),e[h].length>4&&"【标签】"==e[h].substring(0,4)?(i=e[h].substring(4),b.append("<tr><th align='left'><b style='color:#0066ff;'>"+i+"</b></th><td></td></tr>"),g="padding-left:10px;"):(""==a._rowwidth?b.append("<tr><th align='left' style='"+d+g+"'>"+e[h]+"</th>"):b.append("<tr><th align='left' style='width:"+a._rowwidth+";"+d+g+"'>"+e[h]+"</th>"),b.append("<td  "+c+"align='left' width='36'><input  type='text' class='inputtext' style='width:30px;height:18px;line-height:18px;'/></td>"),b.append("<td  "+c+"align='left' style='position:relative'><img src='/Images/WJX/JoinQuestionnaire/slider1.png' style='width: 35px;position:absolute;top:-3px;left:0'/><img src='/Images/WJX/JoinQuestionnaire/sliderEnd.png' style='width:250px;height: 5px;'/></td>"),b.append("</tr>"));b.append("</tbody></table>"),b.append("<div style='margin-top:10px;'><span style='color:#666666;'>"+sum_hint+"</span></div>"),Y.innerHTML=b.toString("")},h.createSum()),x&&(h.createTableRadio=function(){var j,k,m,n,r,u,w,x,y,z,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Z,$,_,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb,mb,nb,ob,pb,qb,rb,sb,tb,ub,vb,wb,xb,yb,zb,Ab,Bb,Cb,Db,Eb,Fb,Gb,Hb,Ib,Jb,Kb,Lb,Mb,Nb,Ob,Pb,Qb,Rb,Sb,Tb,Ub,Vb,Wb,Xb,Yb,Zb,$b,ac,bc,cc,dc,ec,fc,gc,hc,ic,jc,kc,lc,mc,nc,oc,pc,a=this.dataNode,d="matrix"==a._type&&("101"==a._tag||"2"==a._tag||"3"==a._tag||"6"==a._tag)&&a._reverseScoringRowtitle&&5!=newQType,e=a._isTouPiao,f=a._isCeShi,g=a._isCePing,i=a._numperrow?a._numperrow:1;if(-1==i&&(i=1),j=a._select,k=a._tag,a._displayThumb,m=!1,e&&-1!=a._numperrow)for(n=1;n<j.length;n++)j[n]._item_img&&(m=!0);if(m&&(i=4),r=new StringBuilder,r.append("<div  class='div_table_clear_top'></div>"),u=!1,this._referDivQ)w="选项",("matrix"==a._type||"sum"==a.type)&&(w="行标题"),u=!0,x="第"+this._referDivQ.dataNode._topic+"题",("matrix"==a._type||"sum"==a.type)&&(u=!1,r.append("<span style='color:red;'>")),5==newQType&&(x="被测评对象"),r.append("此题"+w+"来源于"+x+"的选中项"),("matrix"==a._type||"sum"==a.type)&&r.append("</span>");else if(a._isQingJing)y=this.qingjing||1,y>=j.length&&(y=1),u=!0,r.append("<div style='font-size:16px;color:#333;font-weight:bold;margin-top:10px;'>"+j[y]._item_title+"&nbsp;<a style='font-size:16px;cursor:pointer;' onclick='if(curover)curover.createTableRadio();stopPropa(event);'>切换场景</a></div>"),r.append(j[y]._item_desc||"请设置情景说明"),y++,this.qingjing=y;else if(a._isShop){for(u=!0,r.append("<ul>"),b&&(j.length=3),n=1;n<j.length;n++)z=j[n]._item_title,B=j[n]._item_value,C=j[n]._item_img,D="",n>1&&1==n%3&&(D=" style='clear:both;'"),r.append("<li class='shop-item' "+D+" style='line-height:20px;'>"),C&&r.append("<div class='img_place'><img src='"+C+"' alt='' /></div>"),r.append("<div class='text_place'>"),r.append("<div class='item_name'>"+z+"</div>"),r.append('<p class="item_price">'),j[n]._item_jump&&r.append('<span style="color:#999;font-size:12px;font-weight:normal">库存'+j[n]._item_jump+"件</span><br/>"),r.append("￥"+B+"</p>"),r.append('<p class="item_select"><span class="operation remove">-</span><input class="operation itemnum" value="0" disabled="disabled"><span class="operation add">+</span></p>'),r.append("</div><div class='divclear'></div></li>");r.append("</ul>")}if(!u){if(s){for(r.append("<select><option>"+type_radio_down+"</option>"),n=1;n<j.length;n++)j[n]._item_radio?r.append("<option selected='selected'>"+trim(j[n]._item_title)+"</option>"):r.append("<option>"+trim(j[n]._item_title)+"</option>");r.append("</select>")}if(p||o&&!v){for(r.append("<ul>"),F="%",q?(E=40,F="px",i=1):E=100/i-1,G=!1,H=1,I=!1,n=1;n<j.length;n++)if(j[n]._item_img){I=!0;break}for(n=1;n<j.length;n++)"radio"==c&&k>=1&&101!=k&&1==n&&(J="5px",r.append("<li class='notchoice' style='padding-right:15px;padding-top:"+J+"'><b>"+j[1]._item_title+"</b></li>"),"6"==k&&r.append("<li><ul class='onscore'>")),p&&k>1&&101!=k?(K="style='padding-left:3px;'",L=j.length-1,M="off",N="on","6"==k&&(O=parseInt(355/L)-2,n==L&&(O+=355%L),L>=18&&(P=12,Q=9,21==L&&(P=11,Q=10),R=(P+2)*Q,S=L-Q,T=355-R,L>=18&&(O=n>=Q+1?parseInt(T/S)-2:P),n==L&&(O+=T%S)),K="style='width:"+O+"px' ",M="off",N="on"),n==L?r.append("<li "+K+" class='"+M+a._tag+"'  >"):r.append("<li "+K+" class='"+N+a._tag+"'  >"),"6"==k&&(U=j[n]._item_value,U==NoValueData&&(U="&nbsp;"),r.append(U)),r.append("</li>")):(j[n]._item_label&&(G&&r.append("</ul></li>"),r.append("<li style='width:100%;'><div><b>"+j[n]._item_label+"</b></div><ul>"),G=!0,H=1),101==k&&(E=16*trim(j[n]._item_title).length+28),r.append("<li  style='width:"+E+F+";"),j[n]._item_img&&r.append("margin-bottom:15px;"),r.append("'>"),V=!1,"radio"!=c&&"check"!=c||!j[n]._item_radio||(V=!0),j[n]._item_img?(hb=j[n]._item_img,ib=hb,jb="",kb="",lb=hb.indexOf(".sojump.com")>-1||hb.indexOf(".sojump.cn")>-1||hb.indexOf(".paperol.cn")>-1,m&&lb?(hb.indexOf("pubali")>-1||hb.indexOf("pubnew")>-1?(mb="?x-oss-process",nb=hb.indexOf(mb),nb>-1&&(hb=hb.substring(0,nb)),hb=hb+mb+"=image/quality,q_90/resize,m_lfit,h_200,w_200"):(mb="?imageMogr2",nb=hb.indexOf(mb),nb>-1&&(hb=hb.substring(0,nb)),hb=hb+mb+"/thumbnail/200x200!"),jb="width:152px;white-space: nowrap;",kb=" style='height:200px;overflow:hidden;'  pimg='"+ib+"'"):jb="margin-right:15px;",r.append("<div style='text-align:center;padding:5px;border:1px solid #ddd;"+jb+"'>"),r.append("<table align='center' cellspacing='0' cellpadding='0' style='table-layout: fixed;width:100%;'><tr><td>"),r.append("<div"+kb+" class='hasImagelabel'>"),e&&r.append('<i class="icon_lookBigpic" onclick="elagerImg(event,this);stopPropa(event);"></i>'),r.append("<img style='border:none;margin:0 auto;' src='"+hb+"' alt='' /></div>"),r.append("</td></tr>"),j[n]._item_desc&&(r.append("<tr><td>"),a._displayDesc||e?(fb="divDesc_"+a._topic+"_"+n,gb=a._displayDescTxt||"查看详情",r.append("<div style='text-align:center;'><a class='link-U333' href='javascript:' onclick='showItemDesc(\""+fb+"\",this);'>"+gb+"</a></div><div id='"+fb+"' style='display:none;'><div style='padding:10px;'>"+j[n]._item_desc+"</div></div>")):(r.append("<div class='div_item_desc'"),r.append(" style='text-align:left;"),m&&r.append("height:20px;width:150px;margin-left:0px;overflow:hidden;"),r.append("'"),r.append(">"),r.append(j[n]._item_desc),r.append("</div>")),r.append("</td></tr>")),r.append("</table>"),r.append("<div>"),e&&(r.append("<div style='text-align:center;'>"),addTouPiao(r,a,n),r.append("</div>")),m&&(W="jqRadio",p||(W="jqCheckbox"),V&&(W+=" jqChecked"),r.append("<a href='###' class='"+W+"' style='position:static;'></a><input style='display:none;'"),p?r.append(" type='radio'"):r.append(" type='checkbox'"),V&&r.append(" checked='checked'"),"radio"==c&&1==k?r.append("'/><label style='vertical-align:middle;padding-left:2px;'>"+trim(j[n]._item_value)+"</label>"):r.append("'/>")),m||(W="jqRadio",p||(W="jqCheckbox"),V&&(W+=" jqChecked"),r.append("<a href='###' class='"+W+"' style='position:static;'></a><input style='display:none;'"),p?r.append(" type='radio'"):r.append(" type='checkbox'"),V&&r.append(" checked='checked'"),"radio"==c&&1==k?r.append("'/><label style='vertical-align:middle;padding-left:2px;'>"+trim(j[n]._item_value)+"</label>"):r.append("'/>")),m?r.append("<label style='display:inline-block;padding:0;max-width:125px;white-space: normal;line-height:20px;vertical-align: middle;'>"+trim(j[n]._item_title)+"</label>"):j[n]._item_imgtext?r.append(trim(j[n]._item_title)):r.append("&nbsp;"),j[n]._item_tb&&(width=500,m&&(r.append("<br/>"),width=120),r.append(" <input type='text' class='inputtext' style='color:#999999;max-width:"+width+"px;' value='"+defaultOtherText+"'/>")),j[n]._item_tbr&&r.append("<span style='color: red;'> *</span>"),a._hasitemrelation&&j[n]._item_relation&&""!=j[n]._item_relation&&"undefined"!=j[n]._item_relation&&(db=getRelationStr(j[n]._item_relation),db&&2==db.length&&(eb="<span onmouseover='toolTipPlay(this)' onmouseout='toolTipHide(this)' style='color:#efa030;font-size:14px;'>&nbsp;("+db[0]+")<i style='display:none'>"+db[1]+"</i></span>",r.append(eb))),r.append("</div>"),r.append("</div>")):(e?r.append("<div style='float:left;width:"+a._touPiaoWidth+"%;'>"):f&&j[n]._item_radio&&r.append("<span style='color:#efa030;'>"),W="jqRadio",p||(W="jqCheckbox"),V&&(W+=" jqChecked"),r.append("<a href='###' class='"+W+"' style='position:static;'></a><input style='display:none;'"),p?r.append(" type='radio'"):r.append(" type='checkbox'"),V&&r.append(" checked='checked'"),"radio"==c&&1==k?(X=trim(j[n]._item_value),"-77777"==X&&(X=""),r.append("/><label style='vertical-align:middle;padding-left:2px;'>"+X+"</label>")):r.append("/><label style='vertical-align:middle;padding-left:2px;'>"+trim(j[n]._item_title)+"</label>"),j[n]._item_tb&&r.append(" <input type='text' class='underline' style='color:#999999;max-width:500px;' value='"+defaultOtherText+"'/>"),j[n]._item_tbr&&r.append(" <span style='color: red;'> *</span>"),e?(r.append("</div>"),r.append("<div style='float:left;'>"),addTouPiao(r,a,n),r.append("</div><div class='divclear'></div>")):f&&j[n]._item_radio?r.append("&nbsp;<label style='vertical-align:middle;'>(正确答案)</label></span>"):g&&(Z=j[n]._item_value,(Z==NoValueData||""==Z)&&(Z="N/A"),r.append("<span style='color:#efa030;font-size:14px;'>&nbsp;(分值："+Z+")</span>")),a._hasjump&&a._anytimejumpto<1&&($="",_="","1"==j[n]._item_jump?$="结束作答":"-1"==j[n]._item_jump?$="点下一页时提交为无效答卷":j[n]._item_jump-1>0&&(ab=j[n]._item_jump,WjxActivity._use_self_topic&&(bb=getjumpNode(j[n]._item_jump),bb&&(cb=bb._title.match(/^\s*\d+[、\.\-\_\(\/]?\d*\)?/),cb&&(ab=cb))),$="跳转到第"+ab+"题",_=' onmouseover="showJumpTip(true,'+j[n]._item_jump+',this);" onmouseout="showJumpTip(false);"'),$&&r.append("<span style='color:#efa030;font-size:14px;'"+_+">&nbsp;("+$+")</span>")),a._hasitemrelation&&j[n]._item_relation&&""!=j[n]._item_relation&&"undefined"!=j[n]._item_relation&&(db=getRelationStr(j[n]._item_relation,!0),db&&2==db.length&&(eb="<span onmouseover='toolTipPlay(this)' onmouseout='toolTipHide(this)' style='color:#efa030;font-size:14px;'>&nbsp;("+db[0]+")<i style='display:none'>"+db[1]+"</i></span>",r.append(eb))),j[n]._item_desc&&(a._displayDesc||e&&I?(fb="divDesc_"+a._topic+"_"+n,gb=a._displayDescTxt||"查看详情",r.append("<div style='margin:0 0 15px 20px;'><a class='link-U333' href='javascript:' onclick='showItemDesc(\""+fb+"\",this);'>"+gb+"</a></div><div id='"+fb+"' style='display:none;'><div style='padding:10px;'>"+j[n]._item_desc+"</div></div>")):r.append("<div class='div_item_desc'>"+j[n]._item_desc+"</div>"))),r.append("</li>")),p&&k>=1&&101!=k&&n==j.length-1&&(J="5px",6==k&&r.append("</ul></li>"),r.append("<li  class='notchoice'  style='padding-left:15px;padding-top:"+J+"'><b>"+j[j.length-1]._item_title+"</b></li>")),i>1&&0==H%i&&r.append("<div style='clear:both;'></div></ul><ul>"),H++;r.append("<div style='clear:both;'></div></ul>"),G&&r.append("</li></ul>"),f&&a._ceshiDesc&&r.append("<div style='color:#666;'>答案解析："+a._ceshiDesc+"</div>")}if(v){for(r.append("<div><ul>"),E=100/i,n=1;n<j.length;n++)ob="sortnum",r.append("<li style='float:none;margin-bottom:6px;padding:3px 0;line-height:20px;'>"),r.append("<div style='float:left;'><input type='checkbox' style='display:none;' /><span class='"+ob+"'></span></div>"),b?r.append("<div style='float:left;line-height:16px;text-align:left;width:400px;'>"):r.append("<div style='float:left;text-align:left;width:660px;'>"),pb=!0,j[n]._item_img&&(hb=j[n]._item_img,r.append("<div style='text-align:left;'>"),r.append("<img style='border:none;margin:0;' src='"+hb+"' alt='' />"),r.append("</div>"),j[n]._item_imgtext||(pb=!1)),pb&&r.append(trim(j[n]._item_title)),j[n]._item_tb&&r.append(" <input type='text' class='underline' style='color:#999999;' value=''/>"),j[n]._item_tbr&&r.append(" <span style='color: red;'> *</span>"),a._hasitemrelation&&j[n]._item_relation&&""!=j[n]._item_relation&&"undefined"!=j[n]._item_relation&&(db=getRelationStr(j[n]._item_relation,!0),db&&2==db.length&&(eb="<span onmouseover='toolTipPlay(this)' onmouseout='toolTipHide(this)' style='color:#efa030;font-size:14px;'>&nbsp;("+db[0]+")<i style='display:none'>"+db[1]+"</i></span>",r.append(eb))),r.append("</div>"),r.append("<div style='clear:both;'></div>"),r.append("</li>");r.append("</ul>")}if(t){if(qb=a._daoZhi,rb="100%",a._mainWidth&&(rb=a._mainWidth+"%"),r.append("<table style='width:"+rb+";' border='0px'  cellpadding='5' cellspacing='0'>"),sb="",tb="",ub="radio",vb=new Array,vb=trim(a._rowtitle).split("\n"),d)for(wb=trim(a._reverseScoringRowtitle).split("\n"),xb=0;xb<vb.length;xb++)wb[xb]&&-1!=wb[xb].indexOf("|1")&&"【标签】"!=vb[xb].substring(0,4)&&(vb[xb]=vb[xb]+"<span style='font-size:12px;color:#808080;font-weight:400;margin-left:2px;'>(反向计分项)<span>");if(yb=trim(a._rowtitle2).split("\n"),zb=trim(a._rowtitle2)?!0:!1,this._referDivQ){for(vb=new Array,Ab=1;Ab<this._referDivQ.dataNode._select.length&&(vb.push(this._referDivQ.dataNode._select[Ab]._item_title),3!=Ab);Ab++);vb.push("......"),zb=!1}if(Bb=!1,Cb="",0==k||k>100&&200>k||k>300){if(A?r.append("<thead><tr>"):r.append("<thead><tr><th></th>"),k>300){if(Db=new Object,a._categoryid&&"-1"!=a._categoryid){for(Eb=a._categoryid.split("〒"),Fb="",Gb=!1,Hb=0;Hb<Eb.length;Hb++)Ib=Eb[Hb].split("|"),Jb=Ib[0],Jb/1e4!=a._topic&&(Gb=!0,Jb=1e4*a._topic+Jb%1e4,Fb+=0==Hb?"":"〒",Fb+=Jb+"|"+Ib[1]),2==Ib.length&&(Db[Jb]=Ib[1]);Gb&&(a._categoryid=Fb)}for(Kb=trim(a._columntitle).split("\n"),n=0;n<Kb.length;n++)r.append("<td align='center'>"+trim(Kb[n])),Lb=n+1,Mb=1e4*parseInt(a._topic)+parseInt(Lb),Db[Mb]&&-1!=Db[Mb]&&(Nb=Db[Mb],CategoryIdtoname[Nb]&&(Ob="/newwjx/design/ChangeCategory.aspx?activity="+activityID+"&ct="+Mb+"&cid="+Nb,r.append("<br/><a href='###' onclick='PDF_launch(\""+Ob+"\",550,200);stopPropa(event);' >  ["+CategoryIdtoname[Nb]+"]</a>"))),r.append("</td>")}else if(qb)for(n=0;n<vb.length;n++)vb[n].length>4&&"【标签】"==vb[n].substring(0,4)||r.append("<td align='center'>"+trim(vb[n])+"</td>");else{for(Pb=100,Qb=12,Rb=1,n=1;n<j.length;n++)Sb=trim(j[n]._item_title).length,Sb>Rb&&(Rb=Sb);for(2==Rb?Qb=6:3==Rb?Qb=8:(Tb=75/(j.length-1),Qb=2.4*Rb,Qb>Tb&&(Qb=Tb)),a._rowwidth&&(Pb-=parseInt(a._rowwidth),Qb=Pb/(j.length-1)),yb.length>0&&a._rowwidth2&&(Pb-=parseInt(a._rowwidth2),Qb=Pb/(j.length-1)),n=1;n<j.length;n++)r.append("<td"),Rb>1&&r.append(" width='"+Qb+"%'"),r.append(" align='center'>"+trim(j[n]._item_title)+"</td>")}if(tb="border-bottom:1px solid #efefef;",sb="style='"+tb+"'",r.append("</tr>"),101==k){for(r.append("<tr><th style='color:#efa030;font-size:14px;' align='left'>分值</th>"),n=1;n<j.length;n++)Z=trim(j[n]._item_value),-77777==Z&&(Z=""),r.append("<td align='center' style='color:#efa030;font-size:14px;'>"+Z+"</td>");r.append("</tr>")}r.append("</thead>"),102==k&&(ub="checkbox")}if(301==k&&(ub="text"),r.append("<tbody>"),"202"==k&&(Ub=a._minvalue,Vb=a._maxvalue,Wb=" width='60%'",Xb="90",r.append("<tr><th></th><td align='left' width='410'><table width='100%'><tr><td "+Wb+"><div style='width:"+Xb+"%'><div style='float:left;color:red;'>"+Ub+"</div><div style='float:right;color:red;'>"+Vb+"</div><div style='clear:both;'></div></div></td></tr></table></td><th></th>")),Yb=!1,201==k&&a._requir&&a._rowVerify){for(n=0;n<a._rowVerify.length;n++)if(0==a._rowVerify[n]._isRequir){Yb=!0;break}a._partRequir=Yb,Yb&&h.setreqstatus()}if(qb)for(n=1;n<j.length;n++){for(n==j.length-1&&(sb="",tb=""),""==a._rowwidth?r.append("<tr><th align='left' style='"+tb+Cb+"'>"+trim(j[n]._item_title)+"</th>"):r.append("<tr><th align='left' style='width:"+a._rowwidth+";"+tb+Cb+"'>"+trim(j[n]._item_title)+"</th>"),Hb=0;Hb<vb.length;Hb++)vb[Hb].length>4&&"【标签】"==vb[Hb].substring(0,4)||r.append("<td  "+sb+"align='center'><input  type='"+ub+"'/></td>");r.append("</tr>")}else{if(Zb=0,$b=!1,Db=new Object,"5"!=window.newQType&&a._categoryid&&"-1"!=a._categoryid){for(Eb=a._categoryid.split("〒"),Gb=!1,Fb="",Hb=0;Hb<Eb.length;Hb++)Ib=Eb[Hb].split("|"),Jb=Ib[0],Jb/1e4!=a._topic&&(Gb=!0,Jb=1e4*a._topic+Jb%1e4,Fb+=0==Hb?"":"〒",Fb+=Jb+"|"+Ib[1]),2==Ib.length&&(Db[Jb]=Ib[1]);Gb&&(a._categoryid=Fb)}for(ac=0,n=0;n<vb.length;n++)if(n==vb.length-1&&(sb="",tb=""),vb[n].length>4&&"【标签】"==vb[n].substring(0,4))bc=vb[n].substring(4),r.append("<tr class='labelname'><th align='left'><b>"+bc+"</b></th><td colspan='"+j.length+"'></td>"),Bb=!0,Cb="padding-left:20px;",$b=!$b;else{if(""==a._rowwidth?A?A&&parseInt(vb[n])>a._minvalue?r.append("<tr style='display: none;'>"):r.append("<tr>"):(r.append("<tr><th align='left' style='"+tb+Cb+"'>"),Lb=ac+1,Mb=1e4*parseInt(a._topic)+parseInt(Lb),Db[Mb]&&-1!=Db[Mb]&&(Nb=Db[Mb],CategoryIdtoname[Nb]&&(Ob="/newwjx/design/ChangeCategory.aspx?activity="+activityID+"&ct="+Mb+"&cid="+Nb,r.append("<a href='###' onclick='PDF_launch(\""+Ob+"\",550,200);stopPropa(event);' style='font-weight: normal;'  >  ["+CategoryIdtoname[Nb]+"]</a>&nbsp;"))),r.append(vb[n]+"</th>")):(r.append("<tr><th align='left' style='width:"+a._rowwidth+";"+tb+Cb+"'>"),Lb=ac+1,Mb=1e4*parseInt(a._topic)+parseInt(Lb),Db[Mb]&&-1!=Db[Mb]&&(Nb=Db[Mb],CategoryIdtoname[Nb]&&(Ob="/newwjx/design/ChangeCategory.aspx?activity="+activityID+"&ct="+Mb+"&cid="+Nb,r.append("<a href='###' onclick='PDF_launch(\""+Ob+"\",550,200);stopPropa(event);' style='font-weight: normal;' >  ["+CategoryIdtoname[Nb]+"]</a>&nbsp;"))),r.append(vb[n]+"</th>")),ac++,100>k&&k&&(r.append("<td>"),r.append("<ul"),6==k&&r.append(" class='onscore'"),r.append(">")),k>200&&300>k)if(201==k){if(cc=a._rowVerify&&a._rowVerify[Zb]?a._rowVerify[Zb]._verify:"",dc="",ec="",fc=a._rowVerify&&a._rowVerify[Zb]?a._rowVerify[Zb]._width:"",fc&&(fc="width:"+fc+"%"),"日期"==cc?dc="/images/form/date.png":"地图"==cc?dc="/images/form/map.png":"手机"==cc?dc="/images/form/mobile.png":"Email"==cc?dc="/images/form/email.png":"电话"==cc||"固话"==cc?dc="/images/form/tel.png":"QQ"==cc?dc="/images/form/qq.png":"姓名"==cc?dc="/images/form/name.png":"网址"==cc?dc="/images/form/website.png":"指定选项"==cc?ec=a._rowVerify[Zb]._choice:"高校"==cc?dc="/images/form/school.png":("城市单选"==cc||"城市多选"==cc||"省市区"==cc)&&(dc="/images/form/city.png"),r.append("<td  "+sb+"align='left'>"),r.append("<div style='position:relative;'>"),ec){for(gc=ec.split(/[,，]/),hc="<select style='border:1px solid #d5d5d5;vertical-align:middle;'><option value=''>请选择</option>",ic=0;ic<gc.length;ic++)jc=gc[ic],hc+="<option value='"+jc+"'>"+jc+"</option>";
hc+="</select>",r.append(hc)}else r.append("<textarea class='inputtext' style='overflow:auto;height:22px;"+fc+"'></textarea>"),dc&&r.append("<img src='"+dc+"' alt='' style='position:absolute;top:3px;left:3px;'/>");kc=!0,a._rowVerify&&a._rowVerify[Zb]&&0==a._rowVerify[Zb]._isRequir&&(kc=!1),Yb&&kc&&r.append("<span class='req' style='left:auto;top:5px;'>&nbsp;*</span>"),r.append("</div>"),r.append("</td>")}else 202==k&&(Wb=" width='410'",Xb="90",r.append("<td  "+sb+"align='left' "+Wb+" style='position:relative'><img src='/Images/WJX/JoinQuestionnaire/slider1.png' style='width: 35px;position:absolute;top:-3px;left:0'/><img src='/Images/WJX/JoinQuestionnaire/sliderEnd.png' style='width:"+Xb+"%;height: 5px;'/></td>"));else if(k>300){if(lc="","303"==k){for(lc+="<select><option>"+type_radio_down+"</option>",mc=1;mc<j.length;mc++)lc+="<option>"+trim(j[mc]._item_title)+"</option>";lc+="</select>"}for(Kb=trim(a._columntitle).split("\n"),nc=Number(300/Kb.length),Hb=0;Hb<Kb.length;Hb++)if(oc="","303"==k)r.append("<td  "+sb+"align='center'>"+lc+"</td>");else{if("301"==k&&(nc="30"),r.append("<td  "+sb+"align='center'>"),ec="","302"==k&&(cc=a._rowVerify&&a._rowVerify[Hb]?a._rowVerify[Hb]._verify:"","指定选项"==cc&&(ec=a._rowVerify[Hb]._choice),ec)){for(gc=ec.split(/[,，]/),hc="<select style='border:1px solid #d5d5d5;vertical-align:middle;'><option value=''>请选择</option>",ic=0;ic<gc.length;ic++)jc=gc[ic],hc+="<option value='"+jc+"'>"+jc+"</option>";hc+="</select>",r.append(hc)}ec||(oc&&r.append("<div style='position:relative;'>"),r.append("<textarea class='inputtext' type='text' style='overflow:hidden;height:22px;width:"+nc+"px;'></textarea>"),oc&&(r.append(oc),r.append("</div>"))),r.append("</td>")}}else for(Hb=1;Hb<j.length;Hb++)k>100||0==k?(W="jqRadio","checkbox"==ub&&(W="jqCheckbox"),r.append("<td "+sb+"align='center'"),102!=k&&103!=k&&101!=k||!j[Hb]._item_tb||r.append(" onmouseover=showFillData(this); onmouseout=' sb_setmenunav(toolTipLayer, false);' "),r.append(">"),r.append("<a href='###' class='"+W+"' style='position:static;'></a><input style='display:none;' type='"+ub+"'/>"),r.append("</td>")):(K="style='padding-left:3px;'",L=j.length-1,M="off",N="on","6"==k&&(O=parseInt(355/L)-2,Hb==j.length-1&&(O+=355%L),K="style='width:"+O+"px' ",M="off",N="on"),Hb==j.length-1?r.append("<li "+K+" class='"+M+k+"'>"):r.append("<li "+K+" class='"+N+a._tag+"'>"),"6"==k&&(U=j[Hb]._item_value,U==NoValueData&&(U="&nbsp;"),r.append(U)),r.append("</li>"));100>k&&k&&r.append("</ul></td>"),pc="",Zb<yb.length&&(pc=yb[Zb]),""==a._rowwidth2?r.append("<th "+sb+">"+pc+"</th>"):r.append("<th style='width:"+a._rowwidth2+";"+tb+"'>"+pc+"</th>"),r.append("</tr>"),$b=!$b,Zb++}}r.append("</tbody></table>")}}r.append("<div class='div_table_clear_bottom'></div>"),A&&r.append("<div class='increase-btn'><i class='increase-icon'></i><span>继续填写</span></div>"),Y.innerHTML=r.toString("")},h.createTableRadio(!0)),(y||n)&&(jb=$ce("div","",W),jb.style.margin="0 0 8px 24px"),b||(y&&(kb=$ce("span","",jb),h.set_jump_ins=function(){var b,c,d,a="*"+jump_info;kb.style.display=this.dataNode._hasjump?"":"none",this.dataNode._hasjump&&(this.dataNode._anytimejumpto<1||("1"==this.dataNode._anytimejumpto?a+="<span style='color:#ff6600;'>(结束作答)</span>":(b=this.dataNode._anytimejumpto,WjxActivity._use_self_topic&&(c=getjumpNode(this.dataNode._anytimejumpto),c&&(d=c._title.match(/^\s*\d+[、\.\-\_\(\/]?\d*\)?/),d&&(b=d))),a+="<span style='color:#ff6600;'>(跳转到第"+b+"题)</span>"))),kb.innerHTML=a+"&nbsp;&nbsp;&nbsp;&nbsp;",kb.onmouseover=function(){if(h.dataNode._anytimejumpto&&h.dataNode._anytimejumpto-1>0){var a=getDataNodeByTopic(h.dataNode._anytimejumpto);a&&(html="填写此题后无条件跳转到<span style='color:#0066ff;'>"+getDisplayTitle(a)+"</span>",toolTipLayerMenu.style.width="330px",toolTipLayerMenu.innerHTML=html,sb_setmenunav(toolTipLayerMenu,!0,this))}},kb.onmouseout=function(){sb_setmenunav(toolTipLayerMenu,!1)}},h.set_jump_ins()),(y||n)&&(lb=$ce("span","",jb),h.openRelationWindow=function(){var c,a="/wjx/design/setrelation.aspx",b=this.dataNode._topic;return n&&(b="0"),"1"!=b||this.dataNode._relation?(a+="?ct="+b,c=this.dataNode._relation,c&&(a+="&rt="+c),currentRelation=c||"",PDF_launch(a,600,562,mb,"题目关联"),!1):(show_status_tip("第1题不能设置关联逻辑",5e3),!1)},h.openRelationByOption=function(){var a,b,c,d,e,f;if(!window.vipUser)return alertNew('提示：此功能只对企业版用户开放，请<a href="/register/upgradevip.aspx?upgradeReason=44" target="_blank">升级</a>'),void 0;if(this._referDivQ)return show_status_tip("提示：选项关联和选项引用只能用一种！",5e3),void 0;if(a=this.dataNode._select,b=!1,a)for(c=a.length,d=1;c>d;d++)a[d]._item_radio&&(b=!0);return b?(show_status_tip("提示：设置了选项默认值不能再设置选项关联！",5e3),void 0):(e="/wjx/design/setrelationByOption.aspx",f=this.dataNode._topic,"1"!=f||this.dataNode._relation?(e+="?ct="+f,PDF_launch(e,600,562,nb,"选项关联"),!1):(show_status_tip("第1题不能设置关联逻辑",5e3),!1))},lb.style.display=a._relation?"":"none",ob=getRelationStr(a._relation),ob&&(lb.innerHTML=ob[0],lb.dtitle=ob[1],lb.onmouseover=function(){toolTipLayerMenu.style.width="350px",toolTipLayerMenu.innerHTML=this.dtitle,sb_setmenunav(toolTipLayerMenu,!0,this)},lb.onmouseout=function(){sb_setmenunav(toolTipLayerMenu,!1,this)},jb.style.marginBottom="8px"),h.RelationIns=lb),pb=$ce("div","",i),pb.className="oparea",pb.onclick=function(a){stopPropa(a)},qb=$ce("div","",pb),qb.style.height="40px",qb.className="spanLeft","0"==a._relation&&(h.style.display="none"),rb=document.createElement("div"),rb.className="div_ins_question spanLeft",rb.innerHTML="<a href='javascript:;' onclick='insertQ(curover,this);return false;' class='link-normal' style='text-decoration:underline;'>在此题后插入新题</a>",rb.style.clear="none",rb.style.visibility="hidden",pb.appendChild(rb),h.divInsertOp=rb,sb=document.createElement("div"),sb.className="spanRight",sb.style.clear="none",pb.appendChild(sb),h.divTableOperation=sb,(a._hasjump||a._relation)&&(h.divTableOperation.style.visibility=""),$ce("div","",i).style.clear="both",(m||n)&&($ce("div","",i).style.clear="both"),cancelInputClick(h)),h}function toolTipPlay(a){var b=a.getElementsByTagName("i")[0].innerHTML;toolTipLayerMenu.style.width="350px",toolTipLayerMenu.innerHTML=b,sb_setmenunav(toolTipLayerMenu,!0,a)}function toolTipHide(a){sb_setmenunav(toolTipLayerMenu,!1,a)}function getRelationStr(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u;if(a){for(c="",c=-1!=a.indexOf("|")?"|":"$",d=a.split(c),e="依赖于",f="",g="",h=0;h<d.length;h++)if(i=d[h],i&&(j=i.split(","),!(j.length<2)&&("依赖于"!=e&&(e+="，"),k=getDataNodeByTopic(j[0])))){for(WjxActivity._use_self_topic?(l=k._title.match(/^\s*\d+[、\.\-\_\(\/]?\d*\)?/),!l&&k._title.length>3&&(l=k._title.substring(0,3)),l&&(e+="第<b>"+l+"</b>题的第"+j[1].replace(/-/g,"").replace(/;/g,"、").replace(/\./g,"、")+"个选项")):e+="第<b>"+j[0]+"</b>题的第"+j[1].replace(/-/g,"").replace(/;/g,"、").replace(/\./g,"、")+"个选项",m="",m=-1!=j[1].indexOf(".")?".":";",n=j[1].split(m),o="选择",p="",n.length>1&&(p="."==m?"中的全部选项":"中的其中一个选项"),f="",q=0;q<n.length;q++){if(r=n[q],0>r-0&&(r=-1*r,o="没有选择"),!k._select||!k._select[r])return;f&&(f+="、"),f+="["+k._select[r]._item_title+"]"}s=k._topic+".",WjxActivity._use_self_topic&&(s=""),""!=g&&d.length>2&&(g+="|"==c?"<b style='color:red;'>并且</b>":"<b style='color:red;'>或者</b>"),g+="当题目<b style='color:#333333;'>"+s+k._title+"</b>"+o+"<b style='color:#333333;'>"+f+"</b>"+p+"时，"}return t="题",b&&(t="选项"),g+="<b style='color:#333333;'>此"+t+"才显示</b>",u=new Array,u.push(e),u.push(g),u}}function cancelInputClick(a){var d,b=a.div_question_preview,c=$$("input",b);for(d=0;d<c.length;d++)c[d].onclick=function(){return this.checked?(this.checked=!1,!1):void 0},c[d].onkeydown=function(){return this.value="",!1}}function Calculatedscore(){var a,b;2==newQType&&(showtotalques.style.display="",showtotalscore.style.display="",a=Calculated(),b=a.split(";"),b.length<2||("null"==b[1]?(totalquestions.innerHTML="<a title='您目前随机抽取的题目数量不一致，导致界面总分不一致，请检查' href='javascript:void(0);' onclick='alert(this.title);return false;' style='color:#fff;'><b>(?)</b></a>",showtotalscore.style.display="none"):totalquestions.innerHTML=b[1],"null"==b[0]?(divscore.innerHTML="<a title='您目前随机抽取的题目分数不一致，导致界面总分不一致，请检查' href='javascript:void(0);' onclick='alert(this.title);return false;' style='color:#fff;'><b>(?)</b></a>",showtotalques.style.display="none"):divscore.innerHTML=b[0]))}function Calculated(){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,D,E,F,G,H,I,J,K,M,N,O,P,a=0;if(totalceshiscore=0,b=0,"4"==WjxActivity._random_mode||"1"==WjxActivity._random_mode){for(c=WjxActivity._partset,d=c.split(","),e=new Object,f=0;f<d.length;f++)if(g=d[f].split(";"),h=parseInt(g[1])-parseInt(g[0])+1,i=g[2]?parseInt(g[2]):h,j=parseInt(g[0]),k=parseInt(g[1]),l=getDataNodeByTopic(j),m=titilescore(l),i!=h){for(n=j;k>=n;n++)if(e[n]=1,o=getDataNodeByTopic(n),m!=titilescore(o))return a="null",a+";"+b;a=addscore(a,m*i),b+=i}else for(n=j;k>=n;n++)e[n]=1,o=getDataNodeByTopic(n),a=addscore(a,titilescore(o)),b++;for(f=0;f<questionHolder.length;f++)p=questionHolder[f].dataNode,p._isCeShi&&(q=parseInt(p._topic),e[q]||(a=addscore(a,titilescore(p)),b++));return totalceshiscore=a,a+";"+b}if("2"==WjxActivity._random_mode&&WjxActivity._random_begin&&WjxActivity._random_end&&WjxActivity._display_part_num){for(r=new Object,s=1,t=parseInt(WjxActivity._random_begin),u=parseInt(WjxActivity._random_end),v="",w=0,x=0,e=new Object,f=0;f<questionHolder.length;f++)y=questionHolder[f].dataNode,"page"==y._type&&u>=s?(r[s]=v,s++,v=""):y._isCeShi&&(""==v?v=f.toString():v+=";"+f.toString(),f==questionHolder.length-1&&(r[s]=v));for(n=t;u>=n;n++)if(v=r[n],z=v.split(";"),A=parseInt(z[0]),B=parseInt(z[z.length-1]),D=0,n==t)for(x=z.length,E=A;B>=E;E++)w+=parseFloat(titilescore(questionHolder[E].dataNode)),e[questionHolder[E].dataNode._topic]=1;else{if(z.length!=x)return b="null",a+";"+b;for(E=A;B>=E;E++)D+=parseFloat(titilescore(questionHolder[E].dataNode)),e[questionHolder[E].dataNode._topic]=1;if(D!=w)return a="null",a+";"+b}for(a+=D*parseInt(WjxActivity._display_part_num),b+=x*parseInt(WjxActivity._display_part_num),f=0;f<questionHolder.length;f++)p=questionHolder[f].dataNode,p._isCeShi&&(q=parseInt(p._topic),e[q]||(a=addscore(a,titilescore(p)),b++));return totalceshiscore=a,a+";"+b}if("5"==WjxActivity._random_mode&&WjxActivity._partsetnew){for(F={},f=0;f<questionHolder.length;f++)if(y=questionHolder[f].dataNode,y._isCeShi&&(G=y._type,G&&"page"!=G&&"cut"!=G&&(H=getTypeName(y)))){if(I=titilescore(y),F[H]){if(I==F[H])continue;return a="null",a+";"+b}F[H]=I}for(J=WjxActivity._partsetnew,K=J.split(","),M=0;M<K.length;M++)N=K[M].split(";"),H=N[0],O=parseInt(N[1]),O>0&&(P=F[H]||0,a=addscore(a,parseFloat(P)*parseFloat(O)),b+=O);return totalceshiscore=a,a+";"+b}for(f=0;f<questionHolder.length;f++)p=questionHolder[f].dataNode,p._isCeShi&&(a=addscore(a,titilescore(p)),b++);return totalceshiscore=a,a+";"+b}function titilescore(a){var b,c,d,e;if(null==a)return 0;if("cut"==a._type||"page"==a._type)return 0;if("gapfill"==a._type)if(b=a._rowVerify,c=0,0==b.length)c=1;else for(d=0;d<b.length;d++)e=b[d]._ceshiValue||1,c=addscore(c,e);else c=a._ceshiValue;return c}function addscore(a,b){return"null"!=a?a+=parseInt(b)==b?parseInt(b):parseFloat(b):a="null",a}function windowGotoUrl(a){needCheckLeave=!1,window.location.href=a}function chkAutoSave_Click(){}function processError(){if(!havereturn){havereturn=!0,errorTimes++;var a="网络异常，可能是您电脑上的防火墙拦截了保存的问卷数据，请关闭防火墙试试！";saveClient(),show_status_tip(a,0)}timeoutTimer&&clearTimeout(timeoutTimer)}function saveClient(){var b,c;try{window.localStorage&&sendStr&&window.localStorage.setItem("lastsavedata"+activityID,sendStr)}catch(a){}b="https://1465656869192293.cn-shanghai.fc.aliyuncs.com/2016-08-15/proxy/weblog/logactivitysave/?activity="+activityID,c=getXmlHttp();try{c.open("post",b),c.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),c.send("data="+encodeURIComponent(sendStr))}catch(a){}}function removeClient(){try{window.localStorage&&window.localStorage.removeItem("lastsavedata"+activityID)}catch(a){}}function setUserPwdIndex(a,b,c,d){userIndex=a,pwdIndex=b,deptIndex=c,extIndex=d}function setUseChuange(a){isChuangGuan=a}function replaceTitleImg(a){var b,c;return hasErrorImg?(b="http://pubimageqiniu.paperol.cn",c="//pubnewfr.paperol.cn",a=a.replace(/\/\/pubalifr.sojump.com/g,c).replace(/\/\/pubali.sojump.com/g,c).replace(/\/\/pubssl.sojump.com/g,b).replace(/\/\/http:\/\/pubimage.sojump.com/g,b)):a}function biaozhuDivQ(a){a.style.border="1px solid red",a.scrollIntoView(!1)}function addNewPage(a){return curinsert?(lastAddNewQTime=(new Date).getTime(),createFreQ("page"),a.parentNode&&(a.parentNode.innerHTML="添加成功，请重新勾选闯关模式！"),!1):void 0}function checkCanChuangGuan(){var b,c,d,a=!1;for(b=0;b<questionHolder.length;b++)if(c=questionHolder[b].dataNode,d=c._type,"cut"!=d)if("page"!=d){if(c._isCeShi){if("radio"!=c._type)return biaozhuDivQ(questionHolder[b]),"提示：题型只能为考试单选题或者考试判断题，不能设置闯关模式";if(!a&&"1"!=c._topic&&questionHolder[b-1]&&"page"!=questionHolder[b-1].dataNode._type)return curinsert=questionHolder[b-1],"提示：第一个考试题前面必须有分页栏，不能设置闯关模式，<a href='javascript:' onclick='window.parent.addNewPage(this);'>添加分页栏</a>";a=!0}else if(a)return biaozhuDivQ(questionHolder[b]),"提示：非考试题型必须在考试题型的前面，不能设置闯关模式"}else if(a)return biaozhuDivQ(questionHolder[b]),"提示：考试题后面不能再有分页栏，不能设置闯关模式"}function checkRandomType(){var c,d,e,a="",b={};for(c=0;c<questionHolder.length;c++)if(d=questionHolder[c].dataNode,e=getTypeName(d),a!=e&&(a=e,""!=e)){if(b[e])return!1;b[e]=!0}return!0}function sortQuestionByType(a){lconfirm("提示：确认调整题型顺序吗？",function(){var e,g,h,i,j,k,l,m,n,b=new Array,c=new Array,d={};for(e=0;e<questionHolder.length;e++)getTypeName(questionHolder[e].dataNode)&&b.push(questionHolder[e]);for(g=0,h="",e=0;e<questionHolder.length;e++)if(i=getTypeName(questionHolder[e].dataNode),""!=i){if(!d[i])for(d[i]=1,j=0;j<b.length;j++)k=b[j].dataNode,h=getTypeName(k),h==i&&c.splice(++g,0,b[j])}else c.splice(++g,0,questionHolder[e]);for(DataArray[0]=firstPage.dataNode,firstPage=null,totalHideQcount=0,l=1,m=2,e=0;e<c.length;e++)n=c[e].dataNode,"page"!=n._type&&"cut"!=n._type?(n._topic=l,l++):"page"==n._type&&(n._topic=m,m++),DataArray[e+1]=n;questions.innerHTML="",set_dataNode_to_Design(),initAttrHandler(),initEventHandler(),a&&(a.parentNode.innerHTML="提示：成功调整，请重新选择按题型随机！")})}function getTypeName(a){var b,c,d,e;if(!a._isCeShi)return"";switch(b=a._type,c=a._answer,d=a._ispanduan,e="",b){case"radio":e=d?"判断题":"单选题";break;case"check":e="多选题";break;case"question":e="简答题无答案"==c?"简答题":"单项填空题";break;case"fileupload":e="简答题";break;case"gapfill":e="多项填空题"}return e}function preivewMQ(a){var c,d,e,b=save_paper("preview",!0,!0);return b?(c=getIEVersion(),d="/wjx/design/previewmobile.aspx?activity="+activityID,c&&8>=c&&(d="/pq/"+activityID+".aspx?wg=1&t="+(new Date).getTime()),(e=navigator.userAgent.indexOf("DingTalk")>-1)?(d="/pm/"+activityID+".aspx?wg=1&par=1&t="+(new Date).getTime(),PDF_launch(d,660,350),!1):(a.href=d,a.target="_blank",!0)):void 0}function openSetPasswordPage(){PDF_close(),PDF_launch("/wjx/design/newsetpasswordlist.aspx?designnew=1&activity="+activityID,600,650,function(){PDF_launch("/wjx/design/settime.aspx?activity="+activityID,660,470)})}function save_paper(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb,mb,nb,ob,pb,qb,rb,sb,tb,ub,vb,xb;if("init"!=a){if(0==questionHolder.length)return show_status_tip("提示：您还未添加题目！",3e3),!1;if(5==newQType&&1==questionHolder.length)return show_status_tip("提示：您还未添加测评的题目！",3e3),!1}if(8==newQType&&("pub"==a||"pub2"==a)&&0==window.userIndex)return show_status_tip("请设置用户名与密码字段！",5e3),PDF_launch("/wjx/design/setuseractivity.aspx?activity="+activityID,560,320),!1;if(2==newQType&&window.isChuangGuan&&("pub"==a||"pub2"==a)&&(d=checkCanChuangGuan()))return show_status_tip(d,5e3),PDF_launch("/wjx/design/settime.aspx?activity="+activityID+"&ncg=1",660,350),!1;if(2==newQType&&"5"==WjxActivity._random_mode&&("pub"==a||"pub2"==a||"preview"==a)&&!checkRandomType())return show_status_tip("提示：您使用了按题型随机功能，各个题型必须连续在一起。请先调整题型顺序！",5e3),setTikuRandom(),!1;if(show_status_tip("正在保存，请耐心等候...",0),"init"!=a&&!save_paper_validate(b))return!1;if(e=document.getElementById("paper_attr_title"),f=document.getElementById("paper_attr_desc"),g=new Array,g[0]=new Object,g[0]._title=e.value,g[0]._tag=f.value,g[0]._display_part=!1,g[0]._display_part_num=0,g[0]._partset="",g[0]._random_mode=WjxActivity._random_mode,"3"==g[0]._random_mode){for(g[0]._partset=WjxActivity._partset,h=WjxActivity._partset.split(","),i="",j=!0,k=0;k<h.length;k++)l=h[k].split(";"),m=parseInt(l[0]),n=parseInt(l[1]),o=getPageQCount()[m],p=o+":"+n,i?i!=p&&(j=!1):i=p;h.length<2&&(j=!1),j&&(g[0]._partset+="|true")}else"4"==g[0]._random_mode?g[0]._partset=WjxActivity._partset:"5"==g[0]._random_mode&&(g[0]._partset=WjxActivity._partsetnew);for(g[0]._display_part=WjxActivity._display_part,g[0]._display_part_num=WjxActivity._display_part_num,g[0]._random_begin=WjxActivity._random_begin,g[0]._random_end=WjxActivity._random_end,g[1]=firstPage.dataNode,q=!1,r=!1,s=!1,t=1,u=2,k=0;k<questionHolder.length;k++){if(questionHolder[k].checkValid&&0==questionHolder[k].checkValid()&&(g[k+2]=questionHolder[k].validate()),g[k+2]=questionHolder[k].dataNode,v=g[k+2]._type,"page"==v?(g[k+2]._topic!=u&&(g[k+2]._topic=u),u++):"cut"!=v&&(g[k+2]._topic!=t&&(g[k+2]._topic=t),t++),g[k+2]._hasjump&&(r=!0),w=g[k+2]._relation,w&&"0"!=w){if(x=w.split(","),y=!0,s=!0,z=x[0],A=x[1].split(";"),B=getDataNodeByTopic(z),C=!1,"cut"==v&&B?(D=getDivIndex(z),k>D&&(C=!0)):C=B&&g[k+2]._topic-z>0,C)if(E=B._select,v=B._type,"radio"==v||"radio_down"==v||"check"==v)for(F=0;F<A.length;F++)G=A[F],(0==G||G>=E.length)&&(y=!1);else y=!1;else y=!1;y||(g[k+2]._relation="")}if(g[k+2]._referTopic="",g[k+2]._referedTopics="",questionHolder[k]._referDivQ&&(g[k+2]._referTopic=questionHolder[k]._referDivQ.dataNode._topic,q=!0),questionHolder[k]._referedArray)for(g[k+2]._referedTopics="",H=0;H<questionHolder[k]._referedArray.length;H++)H>0&&(g[k+2]._referedTopics+=","),g[k+2]._referedTopics+=questionHolder[k]._referedArray[H].dataNode._topic}if("0"!=g[0]._random_mode&&(I="",J=!1,r?(I="跳题逻辑",J=!0):q?(I="引用逻辑",J=!0):s&&(I="关联逻辑",J=!0),J&&(K="此问卷包含"+I+"，设置随机逻辑可能会导致"+I+"失效，请确认没问题后再尝新操作！",!hasLogicNotify&&"init"!=a)))return alert(K),hasLogicNotify=!0,show_status_tip("",100),!1;for(L=0,k=1;k<g.length;k++)"page"==g[k]._type&&L++;for(g[0]._total_page=L,M=new StringBuilder,N=new StringBuilder,O=!1,P=!1,Q=!1,R=!1,S=!1,T=g[0]._title+"§"+g[0]._tag+"§"+g[0]._random_begin+"§"+g[0]._random_end+"§"+g[0]._random_mode+"§"+WjxActivity._use_self_topic,T+="1"!=g[0]._random_mode&&"2"!=g[0]._random_mode||!g[0]._display_part?"3"==g[0]._random_mode||"4"==g[0]._random_mode||"5"==g[0]._random_mode?"§"+g[0]._partset+"§":"§§":"§"+g[0]._display_part+"§"+g[0]._display_part_num,T+="§"+designversion,U=0,k=1;k<g.length;k++){switch(V="",W=g[k]._title.match(/\[q(\d+)\]/),W&&isInt(W[1])&&(V="〒"+W[1]),"init"!=a&&(g[k]._title=replaceTitleImg(g[k]._title)),g[k]._type){case"question":w=g[k]._relation||"",X=g[k]._needOnly,g[k]._needsms&&(X+="〒"+g[k]._needsms),M.append("¤"+g[k]._type+"§"+g[k]._topic+"§"+g[k]._title+"〒"+g[k]._keyword+"〒"+w+V+"§"+g[k]._tag+"§"+g[k]._height+"§"+g[k]._maxword+"§"+g[k]._requir+"§"+g[k]._norepeat+"§"+g[k]._default+"§"+g[k]._ins+"§"+g[k]._hasjump+"§"+g[k]._anytimejumpto+"§"+g[k]._verify+"§"+X+"§"+g[k]._hasList+"§"+g[k]._listId+"§"+g[k]._width+"§"+g[k]._underline+"§"+g[k]._minword),g[k]._isCeShi?(M.append("§"+g[k]._ceshiValue+"〒"+g[k]._answer+"〒"+g[k]._ceshiDesc+"〒"+g[k]._include),R=!0):"多级下拉"==g[k]._verify&&M.append("§"+(g[k]._levelData||"")),U++;break;case"gapfill":if(w=g[k]._relation||"",Y=getGapFillCount(g[k]._title),Z=g[k]._useTextBox?"true":"",M.append("¤"+g[k]._type+"§"+g[k]._topic+"§"+g[k]._title+"〒"+g[k]._keyword+"〒"+w+V+"§"+g[k]._tag+"§"+g[k]._requir+"§"+Y+"§"+g[k]._ins+"§"+g[k]._hasjump+"§"+g[k]._anytimejumpto),M.append("§"),g[k]._rowVerify)for($=0;Y>$;$++)$>0&&M.append("〒"),g[k]._rowVerify[$]&&(_=g[k]._rowVerify[$],M.append(_._verify||""),"指定选项"==_._verify?(M.append("¦"),M.append(_._choice||""),g[k]._requir&&0==_._isRequir&&(M.append("¦"),M.append("false"))):g[k]._isCloze||(M.append(","),M.append(_._minword||""),M.append(","),M.append(_._maxword||"")),g[k]._isCeShi?(ab=g[k]._isCloze?"¦":",",M.append(ab),M.append(_._ceshiValue||"1"),M.append(ab),bb=_._answer||"",bb=g[k]._isCloze?bb:bb.replace(/,/g,"，"),M.append(bb),M.append(ab),cb=_._ceshiDesc||"",cb=g[k]._isCloze?cb:cb.replace(/,/g,"，"),M.append(cb),g[k]._isCloze||(M.append(ab),M.append(_._include))):"指定选项"!=_._verify&&(M.append(","),g[k]._requir&&0==_._isRequir&&M.append("false"),M.append(","),_._needOnly&&M.append("true")));M.append("§"),M.append(Z),g[k]._isCeShi&&(M.append("§1"),M.append("〒"+(g[k]._ceshiDesc||"")),R=!0,g[k]._isCloze&&M.append("§1")),U++;break;case"slider":w=g[k]._relation||"",M.append("¤"+g[k]._type+"§"+g[k]._topic+"§"+g[k]._title+"〒"+g[k]._keyword+"〒"+w+V+"§"+g[k]._tag+"§"+g[k]._requir+"§"+g[k]._minvalue+"§"+g[k]._maxvalue+"§"+g[k]._minvaluetext+"§"+g[k]._maxvaluetext+"§"+g[k]._ins+"§"+g[k]._hasjump+"§"+g[k]._anytimejumpto),U++;break;case"fileupload":w=g[k]._relation||"",db="",g[k]._isCeShi&&(db="§"+(g[k]._ceshiValue||5)+"〒"+(g[k]._ceshiDesc||""),R=!0,g[k]._isvoice&&(db+="§true")),M.append("¤"+g[k]._type+"§"+g[k]._topic+"§"+g[k]._title+"〒"+g[k]._keyword+"〒"+w+V+"§"+g[k]._tag+"§"+g[k]._requir+"§"+g[k]._width+"§"+g[k]._ext+"§"+g[k]._maxsize+"〒"+g[k]._uploadlimit+"§"+g[k]._ins+"§"+g[k]._hasjump+"§"+g[k]._anytimejumpto+db),U++;break;case"sum":w=g[k]._relation||"",eb=g[k]._rowtitle||"外观\n性能",M.append("¤"+g[k]._type+"§"+g[k]._topic+"§"+g[k]._title+"〒"+g[k]._keyword+"〒"+w+V+"§"+g[k]._tag+"§"+g[k]._requir+"§"+g[k]._total+"§"+eb+"§"+g[k]._rowwidth+"§"+"0"+"§"+g[k]._ins+"§"+g[k]._hasjump+"§"+g[k]._anytimejumpto),M.append("§"+g[k]._referTopic+"§"+g[k]._referedTopics),U++;break;case"cut":w=g[k]._relation||"",M.append("¤"+g[k]._type+"§"+g[k]._title+"§"+(g[k]._video||"")+"§"+w+V);break;case"page":M.append("¤"+g[k]._type+"§"+g[k]._topic+"§"+g[k]._title+"§"+g[k]._tag),fb=g[k]._iszhenbie?"true":"",fb=g[k]._istimer?"time":fb,M.append("§"+fb),M.append("§"+g[k]._mintime),g[k]._mintime&&(O=!0),M.append("§"+g[k]._maxtime),g[k]._maxtime&&(P=!0);break;case"check":case"radio_down":case"radio":case"matrix":if(w=g[k]._relation||"",g[k]._tag=isNaN(g[k]._tag)?0:g[k]._tag,gb=g[k]._mainWidth||"",hb=g[k]._hasitemrelation?"true":"false",M.append("¤"+g[k]._type+"§"+g[k]._topic+"§"+g[k]._title+"〒"+g[k]._keyword+"〒"+w+"〒"+gb+"〒"+hb+V+"§"+g[k]._tag+"§"),"matrix"==g[k]._type?(g[k]._referTopic&&(g[k]._rowtitle2=""),eb=g[k]._reverseScoringRowtitle||g[k]._rowtitle||"外观\n性能",M.append(eb+"〒"+g[k]._rowtitle2+"〒"+g[k]._columntitle)):M.append(g[k]._numperrow+"〒"+g[k]._randomChoice),M.append("§"+g[k]._hasvalue+"§"+g[k]._hasjump+"§"+g[k]._anytimejumpto+"§"+g[k]._requir),"check"==g[k]._type||"matrix"==g[k]._type&&"102"==g[k]._tag?g[k]._isShop?(M.append(",shop"),S=!0):g[k]._partScore?M.append(",part"):M.append(","+g[k]._lowLimit+","+g[k]._upLimit):"radio"==g[k]._type&&g[k]._isQingJing?M.append(",1"):"radio"==g[k]._type&&g[k]._ispanduan&&3==g[k]._select.length&&M.append(",2"),"matrix"==g[k]._type){if(ib=g[k]._rowwidth,g[k]._randomRow&&(ib+=",true"),M.append("§"+ib+"〒"+g[k]._rowwidth2),"202"==g[k]._tag||"301"==g[k]._tag)M.append("〒"+g[k]._minvalue+"〒"+g[k]._maxvalue),"301"==g[k]._tag&&1==g[k]._digitType&&M.append(",1"),"301"==g[k]._tag&&g[k]._noslider&&M.append("〒true");else if("102"==g[k]._tag||"103"==g[k]._tag)jb=g[k]._daoZhi||"",M.append("〒"+jb);else if("201"==g[k]._tag||"302"==g[k]._tag){if(g[k]._rowVerify)for(M.append("〒"),kb=trim(g[k]._rowtitle).split("\n"),"302"==g[k]._tag&&(kb=trim(g[k]._columntitle).split("\n")),lb=0,$=0;$<kb.length;$++)("201"!=g[k]._tag||"【标签】"!=kb[$].substring(0,4))&&(g[k]._rowVerify[lb]&&(_=g[k]._rowVerify[lb],"指定选项"==_._verify?(M.append(lb+"¦"),M.append(_._verify+"¦"),M.append(_._choice||""),g[k]._requir&&0==_._isRequir&&(M.append("¦"),M.append("false"))):(M.append(lb+","),M.append(_._verify||""),M.append(","),M.append(_._minword||""),M.append(","),M.append(_._maxword||""),M.append(","),M.append(_._width||""),M.append(","),g[k]._requir&&0==_._isRequir&&M.append("false"),M.append(","),_._needOnly&&M.append("true")),M.append(";")),lb++);else"302"==g[k]._tag&&M.append("〒");"302"==g[k]._tag&&0!=g[k]._minvalue&&M.append("〒"+g[k]._minvalue+"〒"+g[k]._maxvalue)}}else g[k]._isTouPiao?(mb=g[k]._displayDescTxt||"",M.append("§"+g[k]._isTouPiao+"〒"+g[k]._touPiaoWidth+"〒"+g[k]._displayDesc+"〒"+g[k]._displayNum+"〒"+g[k]._displayPercent+"〒"+g[k]._displayThumb+"〒"+mb),Q=!0):g[k]._isCeShi?(mb=g[k]._displayDescTxt||"",M.append("§ceshi〒"+g[k]._ceshiValue+"〒"+replaceTitleImg(g[k]._ceshiDesc)+"〒"+g[k]._displayDesc+"〒"+mb),R=!0):g[k]._isCePing?(mb=g[k]._displayDescTxt||"",M.append("§ceping〒"+g[k]._displayDesc+"〒"+mb)):g[k]._displayDesc?(mb=g[k]._displayDescTxt||"",M.append("§desc〒"+mb)):M.append("§");for(nb=g[k]._verify,"matrix"==g[k]._type&&g[k]._nocolumn&&(nb+=",true"),M.append("§"+g[k]._ins+"§"+nb),M.append("§"+g[k]._referTopic+"§"+g[k]._referedTopics),ob=1;ob<g[k]._select.length;ob++)pb="",g[k]._select[ob]._item_huchi&&(pb="〒true"),qb=g[k]._select[ob]._item_value,""==g[k]._select[ob]._item_value&&(qb=NoValueData),g[k]._select[ob]._item_relation&&"undefined"!=g[k]._select[ob]._item_relation&&(qb+="_"+g[k]._select[ob]._item_relation),"init"!=a&&(g[k]._select[ob]._item_img=replaceTitleImg(g[k]._select[ob]._item_img)),"init"!=a&&(g[k]._select[ob]._item_desc=replaceTitleImg(g[k]._select[ob]._item_desc)),rb=g[k]._select[ob]._item_img,"matrix"==g[k]._type&&(rb=g[k]._select[ob]._item_max),M.append("§"+g[k]._select[ob]._item_title+"〒"+g[k]._select[ob]._item_radio+"〒"+qb+"〒"+g[k]._select[ob]._item_jump+"〒"+g[k]._select[ob]._item_tb+"〒"+g[k]._select[ob]._item_tbr+"〒"+rb+"〒"+g[k]._select[ob]._item_imgtext+"〒"+g[k]._select[ob]._item_desc+"〒"+g[k]._select[ob]._item_label+pb);U++}g[k]._categoryid&&"-1"!=g[k]._categoryid&&(-1!=g[k]._categoryid.indexOf("|")?N.append("〒"+g[k]._categoryid):N.append("〒"+g[k]._topic+"|"+g[k]._categoryid))}if("init"!=a&&(hasErrorImg=!1),clearInterval(interval_time),sb=getXmlHttp(),c=c||!1,tb="curID="+activityID,window.isTiKu&&(tb="tid="+tikuId),ub="/Handler/designQHandler.ashx?submitType=redesign&"+tb+"&userguid="+userGuid+"&validate_text=ys&t="+(new Date).valueOf()+"&sstate="+encodeURIComponent(a),ub+="&totalq="+U,ub+="&initqc="+initQCount,ub+="&eod="+editOldQ,"pub"==a&&(ub+="&pub=1"),"pub2"==a&&(ub+="&pub=2"),c?sb.open("post",ub,!1):sb.open("post",ub),sb.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),c||(sb.onreadystatechange=function(){4==sb.readyState&&(timeoutTimer&&clearTimeout(timeoutTimer),200==sb.status?afterSave(unescape(sb.responseText),a):(clearInterval(interval_time),show_status_tip("很抱歉，由于网络异常您的保存没有成功，请再试一次！",6e3),interval_time=setInterval(autoSave,9e4),saveClient()))}),T+="§"+q+"§"+O+"§"+P+"§"+Q+"§"+R+"§"+S,window.categoreDate&&window.categoreDate.indexOf("〒")>-1&&N.toString().indexOf("〒")<=-1&&N.append("〒false"),T+=N.toString(),totalceshiscore&&(T+="§"+totalceshiscore),sendStr=T+M.toString(""),window.filterKeyword&&filterKeyword.indexOf("|")>-1&&(vb=new RegExp("("+filterKeyword+")","ig"),sendStr=sendStr.replace(vb,"**")),M.clear(),"init"==a)return prevSaveData=sendStr,show_status_tip("成功加载",1e3),divSurvey.scrollTop=0,!0;if(havereturn=!1,sendStr==prevSaveData&&"pub2"!=a){if("pub"==a&&b)try{finishEditing()}catch(wb){}saveSuc(a)}else if(c||(timeoutTimer=setTimeout(function(){processError()},2e4),0==errorTimes?sb.send("surveydata="+encodeURIComponent(sendStr)):postWithIframe(ub)),c&&(sb.send("surveydata="+encodeURIComponent(sendStr)),xb=afterSave(unescape(sb.responseText),a),0==xb))return!1;return!0}function postWithIframe(a){var c,b=document.createElement("div");b.style.display="none",b.innerHTML="<iframe id='mainframe' name='mainframe' style='display:none;' > </iframe><form target='mainframe' id='frameform' action='' method='post' enctype='application/x-www-form-urlencoded'><input  value='' id='surveydata' name='surveydata' type='hidden'><input type='submit' value='提交' ></form>",document.body.appendChild(b),$("surveydata").value=sendStr,c=$("frameform"),c.action=a+"&iframe=1",c.submit()}function tiyanReg(){show_status_tip("保存问卷成功，请注册或者登录以便管理此问卷！",5e3),needCheckLeave=!1,PDF_launch("/register/registers.aspx",640,640,function(){var a=!0;isTiyan&&window.confirm("如果您不注册或者登录，您将无法再管理此问卷。\r\n点击“确定”返回继续操作，点击“取消”离开编辑问卷界面")&&(a=!1),a&&goBack()},"注册问卷星")}function finishEditing(a){var b,c,d;hasexit||(hasexit=!0,b=getXmlHttp(),c="curID="+activityID,window.isTiKu&&(c="tid="+tikuId),d="/Handler/designqfinish.ashx?"+c,b.open("post",d,!1),b.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),b.send("edit=true"),a&&a())}function afterSave(a,b){var c,d,e,f;if(havereturn=!0,c=!1,"error"==a)windowGotoUrl("/Error/Error.aspx?source=designQHandler");else if("timeout"==a)show_status_tip("您的登录信息超时，请重新登录，谢谢！",1e4),PDF_launch("/loginsmall.aspx?err=1",480,522,null,"登录问卷星");else if("timeout2"==a)show_status_tip("提示：您登录的用户名与问卷的实际发布者不一致，请确认并重新登录，谢谢！",1e4),PDF_launch("/loginsmall.aspx?err=2",480,522,"登录问卷星");else if("badcontent"==a)alert("很抱歉，问卷内容未通过审核，可能是因为您的问卷包含不当信息。\r\n如果您确认您的问卷内容没有任何问题，请与我们电话联系！"),window.location="/html/contactus.aspx";else if("shiming"==a)sendStr&&(prevSaveData=sendStr),removeClient(),saveSuc(b,!0),c=!0;else{if("large"==a)saveClient(),d="您的问卷包含的数据过多，请适当精简，谢谢！",alert(d),show_status_tip(d,3e3);else if("large1"==a)saveClient(),d="您的问卷名称超过100个字符，无法保存！",alert(d),show_status_tip(d,3e3);else if("large2"==a)saveClient(),d="您的问卷说明超过10000个字符，无法保存！",alert(d),show_status_tip(d,3e3);else if("empty"==a)errorTimes=1,saveClient(),alert("您提交到服务器的内容为空，可能是因为防火墙拦截的原因。请重新再试一次，如果还是有错误，请更换浏览器或者联系我们，谢谢！");else switch(clearInterval(interval_time),e=a.split("&"),f=e[0]){case"true":sendStr&&(prevSaveData=sendStr),removeClient(),saveSuc(b),c=!0;break;case"false":alert("您输入的验证码有误，请重新输入！");break;case"version":alert("很抱歉，由于问卷星系统版本升级，您本次操作未能成功执行，请您刷新页面或者重启浏览器后再次尝试！\n请注意：页面上的信息可能没有保存，请您先保存重要的数据后再刷新或重启浏览器！");break;case"mode":d="很抱歉，此问卷已有答卷，必须使用合并答卷模式编辑，请退出此页面重新进行编辑！",alert(d),show_status_tip(d);break;case"partdata":alert("很抱歉，您上传到服务器的数据不完整，请点击“预览问卷”重新保存，并检查保存的问卷是否正确！"),show_status_tip("您的问卷总题目数为："+e[1]+"，保存到服务器的题目数为"+e[2]+"题，请点击“预览问卷”重新保存！"),prevSaveData="";break;case"pubcheck":alert(e[1]),show_status_tip(e[1]);break;default:saveClient(),errorTimes++,alert("服务器返回错误，请刷新页面或者重新再试一次！如果还是有错误，请单击返回“我的问卷”选择放弃更改并返回。返回码："+a)}interval_time=setInterval(autoSave,6e4)}return c}function goBack(){var a="/wjx/design/designstart.aspx?activity="+activityID;window.isTiKu&&(a="/wjx/manage/finishtiku.aspx?tid="+tikuId),windowGotoUrl(a)}function saveSuc(a,b){if(show_status_tip("保存问卷成功！",3e3),"pub"==a||"pub2"==a)if(isTiyan)tiyanReg(!0);else if("pub"==a)goBack();else{var c="/wjx/design/designstart.aspx?activity="+activityID;b&&(c="/wjx/design/designstart.aspx?activity="+activityID+"&shiming=1"),windowGotoUrl(c)}else"old"==a?windowGotoUrl("design.aspx?openType=redesign&curid="+activityID):"upgrade"==a&&windowGotoUrl("/register/usertype.aspx")}function doSaveValidate(a){a.createAttr&&(a.hasCreatedAttr||(a.createOp(),a.createAttr(),a.setDataNodeToDesign(),a.tabAttr.style.display="none"),a.validate())}function isJumpToValid(a,b){return""!=a&&0!=a&&1!=a&&-1!=a&&(toInt(a)<=b.dataNode._topic||toInt(a)>total_question)?!1:!0}function elagerImg(a,b){var c,d;a=a||window.event,a.stopPropagation&&a.stopPropagation(),c=b.parentNode.getAttribute("pimg"),c||(c=b.parentNode.getElementsByTagName("img")[0].src),c&&(d=document.createElement("img"),d.onload=function(){var b,d,e,f,g,h,i,a=document.getElementById("divImgPop");a||(a=document.createElement("div"),a.id="divImgPop",document.body.appendChild(a)),a.style.overflow="auto",b=this.width,d=this.height,e=(document.documentElement.clientWidth||document.body.clientWidth)-60,f=(document.documentElement.clientHeight||document.body.clientHeight)-40,i=.9,d>f*i?(h=f*i,g+=17,g>e*i&&(g=e*i+17)):b>e*i?(g=e*i,h=g/b*d):(g=b,h=d),a.innerHTML="<img src="+c+" alt=''/>",PDF_launch("divImgPop",g+20,h+20)
},d.src=c)}function save_paper_validate(a){var c,d,e,f,g,h,i,j,k,l,m,n,p,q,r,s,t,u,v,w,y,x,b=document.getElementById("paper_attr_title");if(""==trim(b.value))return alertNew("请填写问卷标题"),show("tab3_div"),b.value="请输入您的问卷的标题",b.select(),!1;for(c=!0,e=0;e<questionHolder.length;e++){if(f=questionHolder[e],f.checkValid&&0==f.checkValid())doSaveValidate(f),0==questionHolder[e].checkValid()&&(c=!1,d||(d=questionHolder[e]));else if(f.dataNode._hasjump)if(f.dataNode._anytimejumpto&&"0"!=f.dataNode._anytimejumpto)j=f.dataNode._anytimejumpto,isJumpToValid(j,f)||(doSaveValidate(f),c=!1,d||(d=questionHolder[e]));else{if(g=f.dataNode._select,!g)continue;for(h=g.length,i=1;h>i;i++)if(j=trim(g[i]._item_jump),!isJumpToValid(j,f)){doSaveValidate(f),c=!1,d||(d=questionHolder[e]);break}}else if(f.dataNode._isCeShi){if(g=f.dataNode._select,!g)continue;for(h=g.length,k=!1,i=1;h>i;i++)g[i]._item_radio&&(k=!0);k||(doSaveValidate(f),c=!1,d||(d=questionHolder[e]))}if(l=f.dataNode,l._relation)for(m="",m=-1!=l._relation.indexOf("|")?"|":"$",n=l._relation.split(m),i=0;i<n.length;i++)if(p=n[i].split(","),q=parseInt(p[0]),q-l._topic>=0)return-1==f.className.indexOf("div_question_error")&&(f.className+=" div_question_error"),l._relation="",show_status_tip("提示：关联逻辑必须设置为依赖于本题之前的题目，此题关联逻辑已被清除！",6e3),!1;if(5==newQType&&"matrix"==l._type&&!l._referTopic)return-1==f.className.indexOf("div_question_error")&&(f.className+=" div_question_error"),l._anytimejumpto="",l._hasjump=!1,l._referTopic="1",setReferDiv(f),show_status_tip("提示：360度评估的题目必须引用被测评人！",6e3),!1;if(l._hasjump){if(l._anytimejumpto&&l._anytimejumpto-1>0&&l._anytimejumpto-l._topic<=0)return-1==f.className.indexOf("div_question_error")&&(f.className+=" div_question_error"),l._anytimejumpto="",l._hasjump=!1,show_status_tip("提示：跳题逻辑必须设置为跳到本题后面的题目，此题跳题逻辑已被清除！",6e3),!1;if(l._select){for(r=!1,s=1;s<l._select.length;s++)t=l._select[s]._item_jump,t&&t-1>0&&t-l._topic<=0&&(l._select[s]._item_jump="0",-1==f.className.indexOf("div_question_error")&&(f.className+=" div_question_error"),r=!0);if(r){for(u=!1,s=1;s<l._select.length;s++)t=l._select[s]._item_jump,t&&"0"!=t&&(u=!0);return u||(l._hasjump=!1),show_status_tip("提示：跳题逻辑必须设置为跳到本题后面的题目，此选项跳题逻辑已被清除！",6e3),!1}}}if(l._partScore&&"check"==l._type){for(v=l._ceshiValue,w=0,x=1;y=l._select[x++];)y._item_radio&&(w+=parseFloat(y._item_value));if(w>v)return f.isEditing||qonclick.call(f),f.scrollIntoView(!1),show_status_tip("此题正确选项分值超过题目分值！请重新设置",6e3),!1}}return c?(c=!0,d=null,!0):(a?(d.isEditing||qonclick.call(d),d.scrollIntoView(!1),show_status_tip("此题没有通过验证，保存失败！请按错误提示信息修改。",6e3)):show_status_tip("第"+d.dataNode._topic+"题没有通过验证，自动保存失败！请按错误提示信息修改。",6e3),!1)}function checkAnswerTextOnlyOne(a,b,c){var d,e;return htOnlyOjb[a]?(c(),alertNew("很抱歉，此题要求每个用户输入的答案都唯一，但答卷存在相同的答案！"),void 0):(d=getXmlHttp(),e="/Handler/CheckOnlyAnswerText.ashx?activityID="+activityID+"&q="+a,d.open("get",e),d.send(null),d.onreadystatechange=function(){4==d.readyState&&(200==d.status?"true"===d.responseText?b():(c(),htOnlyOjb[a]="1",alertNew("很抱歉，此题要求每个用户输入的答案都唯一，但答卷存在相同的答案！")):c())},void 0)}function getcategoryinf(){var b,a=getXmlHttp();a.onreadystatechange=function(){var b,c,d,e,f,g;if(4==a.readyState&&200==a.status&&(b=a.responseText,"0"!=b)){for(CategoryIdtoname=new Object,c=b.split("§"),d=0;d<c.length;d++)e=c[d].split("|"),2==e.length&&(CategoryIdtoname[e[0]]=e[1]);for(d=0;d<questionHolder.length;d++)f=questionHolder[d].dataNode._type,"page"!=f&&"cut"!=f&&(g=questionHolder[d].dataNode._tag,questionHolder[d].dataNode._categoryid,!g||300>=g?"6"==window.newQType&&"matrix"==f?questionHolder[d].createTableRadio():questionHolder[d].updateSpancategory():questionHolder[d].createTableRadio())}},b="/handler/getcategoryidtoname.ashx?activity="+activityID,a.open("get",b,!1),a.send(null)}var prevSaveData,hasCeShiQ,totalHideQcount,initQCount,hasErrorImg,totalceshiscore,EndGapReq,batAddQTimes,prevQType,GapFillStr,GapWidth,GapFillReplace,EditorIndex,EditToolBarItems,EditToolBarItemsPageCut,defaultFileExt,status_tip,topnav,divSurvey,divMenu,questions,firstPage,questionHolder,cur,curover,curinsert,langVer,WjxActivity,DataArray,total_page,total_question,select_item_num,isMergeAnswer,isCompleteLoad,referRelHT,designversion,hasInsPromoteJump,lastAddNewQTime,prevcurmove,useShortCutAddNewQ,CategoryIdtoname,QuesidtoCategoryId,QIndentity,interval_time,status_tip_timeout,titleEditorCreated,curEnlargeControl,txtEnlarge,lineObj,lineObjOffsetTop,txtCurCity,needCheckLeave,hasexit,havereturn,timeoutTimer,errorTimes,sendStr,hasLogicNotify,htOnlyOjb;$$=function(a,b){if(b){var c=b.getElementsByTagName(a);return c&&0!=c.length?c:(c=new Array,getbyTagName(b,a,c),c)}return document.getElementsByTagName(a)},prevSaveData="",hasCeShiQ=!1,totalHideQcount=0,initQCount=0,hasErrorImg=!1,totalceshiscore=0,$ce=function(a,b,c){var d=document.createElement(a);return b&&(d.innerHTML=b),c.appendChild(d),d},StringBuilder.prototype.append=function(a){this._stringArray.push(a)},StringBuilder.prototype.toString=function(a){return a=a||"",this._stringArray.join(a)},StringBuilder.prototype.clear=function(){this._stringArray.length=0},document.onkeydown=forbidBackSpace,EndGapReq=!0,batAddQTimes=0,prevQType=null,GapFillStr="___",GapWidth=21,GapFillReplace="<input style='width:"+GapWidth+"px;' />",EditorIndex=1,EditToolBarItems=["fontname","fontsize","textcolor","bgcolor","bold","italic","underline","subscript","superscript","justifyleft","justifycenter","justifyright","emoticons","|","link","|","image","|","flash"],EditToolBarItemsPageCut=["fontname","fontsize","textcolor","bgcolor","bold","italic","underline","strikethrough","subscript","superscript","justifyleft","justifycenter","justifyright","indent","outdent","emoticons","hr","|","link","|","image","|","flash"],defaultFileExt=".gif|.png|.jpg|.jpeg|.bmp|.doc|.docx|.pdf|.xls|.xlsx|.ppt|.pptx|.txt|.rar|.zip|.gzip|.mp4|.m3u8|.flv|.f4v|.webm|.mov|.m4v|.3gp|.avi|.wmv|.mp3|.wma|.wav|.amr",status_tip=$("status_tip"),topnav=$("topnav"),divSurvey=$("sur"),divMenu=$("divMenu"),questions=$("question"),firstPage=null,questionHolder=new Array,cur=null,curover=null,curinsert=null,langVer=0,WjxActivity=new Object,DataArray=new Array,total_page=0,total_question=0,select_item_num=1,isMergeAnswer=!1,isCompleteLoad=!1,referRelHT=new Object,designversion="7",hasInsPromoteJump=!1,lastAddNewQTime=null,prevcurmove=null,useShortCutAddNewQ=!1,CategoryIdtoname=new Object,QuesidtoCategoryId=new Object,QIndentity=1,init_page(),status_tip_timeout=null,titleEditorCreated=!1,curEnlargeControl=null,txtEnlarge=$("txtEnlarge"),lineObj=$("lineObj"),txtEnlarge&&(txtEnlarge.onkeydown=txtEnlarge.onfocus=function(){createTextAreaWithLines(this),positionLineObj(lineObj,this)},txtEnlarge.onmousedown=txtEnlarge.onscroll=txtEnlarge.onblur=txtEnlarge.onmouseover=function(){positionLineObj(lineObj,this)}),lineObjOffsetTop=4,txtCurCity=null,needCheckLeave=!0,window.onbeforeunload=function(){return needCheckLeave?"系统可能不会保存您所做的更改。":void 0},hasexit=!1,window.onunload=function(){finishEditing()},havereturn=!1,timeoutTimer=null,errorTimes=0,sendStr="",hasLogicNotify=!1,htOnlyOjb=new Object;