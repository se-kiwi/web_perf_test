Array.prototype.contains=function(b){var a=this.length;while(a--){if(this[a]===b){return true;}}return false;};var HighChart={ChartDataFormate:{FormateNOGroupData:function(d){var b=[];var a=[];for(var c=0;c<d.length;c++){b.push(d[c].name||"");a.push([d[c].name,d[c].value||0]);}return{category:b,data:a};},FormatGroupData:function(e){var l=new Array();var b=new Array();var f=new Array();for(var g=0;g<e.length;g++){if(!l.contains(e[g].name)){l.push(e[g].name);}if(!b.contains(e[g].group)){b.push(e[g].group);}}for(var g=0;g<b.length;g++){var a={};var h=new Array();for(var d=0;d<e.length;d++){for(var c=0;c<l.length;c++){if(b[g]==e[d].group&&e[d].name==l[c]){h.push(e[d].value);}}}a={name:b[g],data:h,dataLabels:{enabled:true}};f.push(a);}return{category:l,series:f};}},ChartOptionTemplates:{Pie:function(e,h,g){var f=HighChart.ChartDataFormate.FormateNOGroupData(e);var d=false;for(var b=0;b<f.category.length;b++){if(f.category[b].length>10){d=true;}}var a="";if(g){a="50%";}var c={chart:{plotBackgroundColor:null,plotBorderWidth:null,plotShadow:false},credits:{enabled:false},exporting:{enabled:false},colors:["#54C7FC","#FFB54D","#FF7466","#44DB5E","#4D9FFF","#FFD300","#22b5c3","#a3be57","#ff9c9c","#48cfef","#25bf6e","#ea5f35","#7e85e0","#f2bd7c","#bbbbba","#7257a2"],title:{text:""},tooltip:{formatter:function(){var i=this.y;if(h){i=this.y+"%";}return"<b>"+this.point.name+"</b>："+i;},useHTML:true,percentageDecimals:1,style:{fontFamily:"Microsoft YaHei"}},legend:{itemStyle:{fontWeight:"normal",fontFamily:"Microsoft YaHei"}},plotOptions:{pie:{allowPointSelect:true,cursor:"pointer",dataLabels:{enabled:true,style:{fontSize:"13px",fontWeight:"normal","font-family":"Microsoft YaHei"},formatter:function(){var j=this.y;if(h){j=this.y+"%";}if(d){return j;}var i=this.point.name;if(i.length>10){i=i.substr(0,10)+"... ";}return i+": "+j;}},showInLegend:d}},series:[{type:"pie",name:"",data:f.data,innerSize:a}]};return c;},Bars:function(e,i,b){var j="column";var c=false;if(i==3){j="line";}else{if(i==4){j="bar";}else{if(i==5){c=true;j="line";}}}var a=["#33a3dc","#76c0ec","#95dc7c","#d8de00","#fff500","#fca000","#22b5c3","#a3be57","#ff9c9c","#48cfef","#25bf6e","#ea5f35","#7e85e0","#f2bd7c","#bbbbba","#7257a2"];var k=HighChart.ChartDataFormate.FormatGroupData(e,b);var d=k.series.length>1;var h="";if(d&&k.category.length>4){if(b){h="percent";}else{h="normal";}var g=k.series.length;if(g<a.length){a=a.slice(0,g);a=a.reverse();}if(g==2){a=["#fca000","#33a3dc"];}}var f={chart:{polar:c,type:j},legend:{enabled:d,itemStyle:{fontWeight:"normal",fontFamily:"Microsoft YaHei"},labelFormatter:function(){if(this.name.length>12){return this.name.substr(0,12)+"...";}else{return this.name;}}},title:{text:""},credits:{enabled:false},exporting:{enabled:false},colors:a,xAxis:{categories:k.category},yAxis:{lineWidth:1,gridLineWidth:0,title:{text:""}},tooltip:{formatter:function(){var m=this.y;if(b){m=this.y+"%";}if(d){return"<b>"+this.series.name+"</b>："+m;}else{return"<b>"+this.x+"</b>："+m;}},useHTML:true,percentageDecimals:1,style:{fontFamily:"Microsoft YaHei"}},plotOptions:{column:{pointPadding:0.2,borderWidth:0,stacking:h,dataLabels:{style:{fontSize:"13px",fontWeight:"normal","font-family":"Microsoft YaHei"},formatter:function(){var m=this.y;if(m==0&&h){return"";}if(b){m=this.y+"%";}return m;}}},bar:{pointPadding:0.2,borderWidth:0,stacking:h,dataLabels:{style:{fontSize:"13px",fontWeight:"normal","font-family":"Microsoft YaHei"},formatter:function(){var m=this.y;if(m==0&&h){return"";}if(b){m=this.y+"%";}return m;}}},line:{dataLabels:{enabled:true,style:{fontSize:"13px",fontWeight:"normal","font-family":"Microsoft YaHei"},formatter:function(){var m=this.y;if(b){m=Highcharts.numberFormat(this.y,0)+"%";}return m;}}}},series:k.series};if(i==5){var l={pane:{size:"80%"},xAxis:{categories:k.category,tickmarkPlacement:"on",lineWidth:0},yAxis:{gridLineInterpolation:"polygon",lineWidth:0,min:0}};return $.extend({},f,l);}return f;}},RenderChart:function(b,a){a.highcharts(b);}};function renderChart(e,r,m,c){var h=$(c).attr("index");if(r.lastObj){$(r.lastObj).removeClass("liSelect");}r.lastObj=c;$(r.lastObj).addClass("liSelect");var n=new Array();var p=e.rows;var v=p.length;var a=true;if(window.imgtype==2){a=false;for(var u=1;u<v;u++){var f=p[u].cells;var w=$(f[0]).text();var d=2;var g=["填写人数","访问人数"];var l=$(f[1]).text();var o=l.split("/");for(var t=0;t<d;t++){var l=parseInt(o[t]);var k=g[t];var x=parseFloat(l);n.push({name:w,group:k,value:x});}}}else{for(var u=1;u<v;u++){var f=p[u].cells;var w=$.trim($(f[0]).text());var l=$(f[1]).text();var s=$(f[2]).text().replace("%","");var x=parseFloat(l);if(a){x=parseFloat(s);}n.push({name:w,group:"group",value:x});}}var b=null;if(h=="1"){b=HighChart.ChartOptionTemplates.Pie(n,a);}else{if(h=="6"){b=HighChart.ChartOptionTemplates.Pie(n,a,true);}else{if(h=="2"){b=HighChart.ChartOptionTemplates.Bars(n,2,a);}else{if(h=="3"){b=HighChart.ChartOptionTemplates.Bars(n,3,a);}else{if(h=="4"){b=HighChart.ChartOptionTemplates.Bars(n,4,a);}else{if(h=="5"){b=HighChart.ChartOptionTemplates.Bars(n,5,a);}}}}}}m.show();var q=m.next();q.show();m.opt=b;HighChart.RenderChart(b,m);}function enlargeChart(){openwindow("/wjx/activitystat/ViewHighChart.aspx",840,520);}function saveChart(){var b=$("#chartDiv1");var a=b.highcharts();var e=b.width();var d="image/png";var c=$.browser.msie&&($.browser.version=="6.0"||$.browser.version=="7.0"||$.browser.version=="8.0"||$.browser.version=="9.0");if($.browser.safari||$.browser.opera){c=true;}if(c){a.exportChart({type:d,scale:1});return;}a.exportChartLocal({type:d,scale:1});}function printChart(){var b=$("#chartDiv1");var a=b.highcharts();a.print();}$(function(){var a=$("#chartDiv1");var b=divResultCss.find("li");b.click(function(){renderChart(tableData,divResultCss,a,this);});$(b[0]).trigger("click");});function openwindow(a,b,c){PDF_launch(a,b,c);}