function closeAlert(){var a=document.getElementById("alert_box");a.style.display="none",a.callback&&a.callback()}function alertNew(a,b){var c=document.getElementById("alert_box");c?document.getElementById("pop_box_msg").innerHTML=a:(c=document.createElement("div"),c.id="alert_box",alertHtml="<div style='position:fixed;*position: absolute;width:100%;height:100%;opacity:0.5;filter:alpha(opacity=50);background-color:black;z-index:99998;top:0px;left:0px;'></div><div style='min-height: 160px;width:320px;margin-left:-160px;margin-top: -80px;position:fixed;*position: absolute;z-index:99999;top:50%;left:50%;background-color:white;border-radius:4px;'><div style='font-size:18px;color:#000;font-weight:600;padding: 26px 0px 10px;width:100%;text-align:center;border-radius:8px 8px 0 0;vertical-align: middle;z-index: 1;'><div>系统提示</div></div><div style='width: 100%;border-radius: 0 0 8px 8px; z-index: 1;'><div style='min-height: 50px;padding:6px 10px 10px;font-size: 15px;line-height: 22px;text-align: center;' id='pop_box_msg'>"+a+"</div>"+"<div style='width:100%;height: 50px;text-align:center;border-top:1px solid #D2D3D5;'><button style='display:inline-block;width:100%;font-size:18px;height:50px;box-sizing:border-box;line-height:50px;color:#3296FA;text-align: center;text-decoration: none;border: none;background: none;outline:none;cursor:pointer;' onclick='closeAlert();'>确定</button></div>"+"</div></div>",c.innerHTML=alertHtml,document.body.appendChild(c)),c.style.display="",c.callback=b||""}function setCookie(a,b,c,d,e,f){document.cookie=a+"="+escape(b)+(c?"; expires="+c:"")+(d?"; path="+d:"")+(e?"; domain="+e:"")+(f?"; secure":"")}function change(){lapIndex==endLap?ok():endLap>lapIndex&&(changeColor(),clearTimeout(joinawardtimer),joinawardtimer=setTimeout(change,timeInterval))}function changeColor(){curIndex>0&&(tdImg[curIndex-1].className=""),curIndex==tdLen&&(curIndex=0),tdImg[curIndex].className="Naward_active",lastTd=tdImg[curIndex],curIndex++,timeInterval+=timeAdd,lapIndex++}function endAward(){lapIndex>=endLap?finishAward():(changeColor(),clearTimeout(joinawardtimer),joinawardtimer=setTimeout(endAward,timeInterval))}function getaward(){return"-1"==joinactivity?(alertNew("此为预览状态不能抽奖！"),void 0):(addtolog(2),clearTimeout(joinawardtimer),awardTd.innerHTML="<div><img src='/images/WJX/award/loading_flower.gif' alt=''/></div>",joinawardtimer=setTimeout(change,timeInterval),void 0)}function init(){var c,d,e,f,g,h,i,j,k,a=document.getElementById("tbAward");if(a){if(a.rows.length,c=a.getElementsByTagName("td"),d=tdLen/2,e=window.awardData.split("§"),e.length!=d)return alertNew("此问卷抽奖活动未启动，请稍等"),void 0;for(f=[0,1,2,3],window.isRandShowAward&&1==window.isRandShowAward&&(f=shuffle(f)),g=0;tdLen>g;g++)h=new Object,0==g%2?(i=f[g/2],3==i&&(awardendindex=g),j=e[i].split("〒"),h.name=j[0],k=j[1].split(","),h.value=parseInt(k[0]),j[2]&&(h.isBaoXian=!0,h.Link=j[2],iwbx=!0,k[1]&&parseInt(k[1])==k[1]&&(awd=parseInt(k[1])))):(h.name="感谢您的参与",h.image="",h.value=0),awardObjs.push(h);for(g=0;g<c.length;g++)g!=d||(awardTd=c[g]);for(tdImg.push(c[0]),tdImg.push(c[1]),tdImg.push(c[2]),tdImg.push(c[5]),tdImg.push(c[8]),tdImg.push(c[7]),tdImg.push(c[6]),tdImg.push(c[3]),tdLen=tdImg.length,g=0;g<tdImg.length;g++)tdImg[g].innerHTML=getHtml(g)}}function ok(){var b,a=getXmlHttp();a.onreadystatechange=function(){if(4==a.readyState){if(200!=a.status)awardNum=1;else{var b=a.responseText;clearTimeout(joinawardtimer),b||(awardNum=1),awardNum=parseInt(b),awardNum==b&&tdImg[awardNum]||(awardNum=1)}6==awardNum&&(awardNum=awardendindex),endLap=awardNum,3>endLap&&(endLap+=tdLen),lapIndex=0,4>endLap?(timeAdd=400,timeInterval=400):6>endLap?(timeAdd=200,timeInterval=300):8>endLap?(timeAdd=150,timeInterval=200):(timeAdd=100,timeInterval=200),joinawardtimer=setTimeout(endAward,timeInterval)}},b="/joinnew/joinawardactivitymobo.ashx?t="+(new Date).valueOf()+"&activity="+activity+"&joinactivity="+joinactivity+"&ispc=1",iwbx&&(b+="&iwbx=1"),awd&&(b+="&awd="+awd),window.sa&&(b+="&sa="+encodeURIComponent(sa)),window.ea&&(b+="&ea="+encodeURIComponent(ea)),window.gender&&(b+="&ge="+encodeURIComponent(gender)),window.marriage&&(b+="&marr="+encodeURIComponent(marriage)),window.education&&(b+="&educ="+encodeURIComponent(education)),window.jpmatch&&(b+="&jpm="+encodeURIComponent(jpmatch)),window.jpmatch&&awd&&window._czc&&_czc.push(["_trackEvent","jpm"+window.jpmatch,awd]),a.open("get",b),a.send(null)}function shuffle(a){var b,c,d=a.length;if(d)for(d--;d>=0;)c=Math.floor(Math.random()*(d+1)),b=a[c],a[c]=a[d],a[d]=b,d--;return a}function finishAward(){var a,b;if(clearTimeout(joinawardtimer),awardTd.style.lineHeight="22px",lastTd&&(lastTd.className="Naward_active",lastTd.style.border="none"),setCookie("award_"+activity,"1",null,"/","",null),awardObjs[awardNum].value){if(awardTd.innerHTML="<a class='fastA' href='javascript:;'>恭喜中奖</a>",!awardObjs[awardNum].isBaoXian)return alertNew("感谢您的参与，祝您下次好运！"),awardTd.innerHTML="<a class='fastA' href='javascript:;'>感谢参与</a>",void 0;awardTd.innerHTML="<div style='text-align:center;'><a href='"+awardObjs[awardNum].Link+"' style='color:#fff;font-size:16px;' target='_blank'><span>立即去领取</span></a></div>",a="",a=window.ToolTipText?window.ToolTipText:divAward.getAttribute("TipText"),b=a,window.notDisplayName||(b="恭喜您获得"+awardObjs[awardNum].name+"\n"+b),alertNew(b,function(){addtolog(3),setTimeout(function(){var a=awardObjs[awardNum].Link;window.location.replace(a)},1e3)})}else awardTd.innerHTML="<a class='fastA' href='javascript:;'>感谢参与</a>"}function GetRnd(a,b){return parseInt(Math.random()*(b-a+1))}function getHtml(a){var b,c,d,e,f,g,h;return awardObjs[a].value?(b="<div style='color:#ff4801;margin-top:10px;' onclick='if(this.title)alertNew(this.title);'>",c=awardObjs[a].name,d=/^(\d+(\.\d+)?)/,e=c.match(d),e&&e.length>=2&&(f=e[1].length,g=c[f],h=c.substr(f+1),c="<span style='font-size:20px;'>"+e[1]+"</span>"+g+"<br/>"+h),b+=c,b+="</div>"):"<span style='color:#888888;font-size:14px;'>感谢参与</span>"}function getXmlHttp(){var a;try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(b){try{a=new XMLHttpRequest}catch(b){try{a=new ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}}return a}var joinawardtimer,fstImgHtml,awardObjs=new Array,awardTd=null,tdImg=new Array,tdLen=8,curIndex=0,lapIndex=0,endLap=49,timeInterval=30,timeAdd=1,lastTd=null,backColor="#ffe297",iwbx=!1,awd=0,awardendindex=6,awardNum=1;init();