define("mycenter-sidenav/modules/collections/main",["require","exports","module","common/widgets/mycenter-recommend/main","common/widgets/plat/poster","common/widgets/send-resume/main","dep/artTemplate/dist/template","common/widgets/plat/exposure","common/widgets/plat/addIcon"],function(require){function a(a){var c=a.parents("li").attr("data-id"),g=0,h=$("#resubmitToken").val();g=a.hasClass("collected")?0:1,$.lgAjax({url:ctx+"/mycenter/collectPositoin.json",type:"POST",async:!1,data:{positionId:c,type:g,resubmitToken:h},dataType:"json"}).done(function(c){null!=c.resubmitToken&&""!=c.resubmitToken&&$("#resubmitToken").val(c.resubmitToken),c.success?1==c.content.showStts?(a.removeClass("collected").html("收藏<span>已取消收藏</span>"),a.children("span").fadeIn(200).delay(500).fadeOut(200)):(a.addClass("collected").html("取消收藏<span>已成功收藏该职位</span>"),a.children("span").fadeIn(200).delay(500).fadeOut(200)):alert(c.msg),$(".collectionCancel").on("click")})}function c(){$.lgAjax({url:ctx+"/mycenter/showQRCode",type:"GET"}).done(function(a){a.success&&($(".saoma .drop_l img").attr("src",a.content),$("#deliverResumesSuccess .weixinQR .qr img").attr("src",a.content),$("#deliverResumesSuccess .weixinQR").removeClass("dn"))})}function g(){var a=$("#jobid").val(),c=window.location.href,re=/(http(s)?\:\/\/)?(www\.)?(\w+\:\d+)?(\/\w+)+\.(html)/gi,g=c.match(re),h=ctx+g+"?source=weixin",v=ctx+"/share/qrcode_share.png?code="+a+"&qrSource=weixin&flag=jobs&urlEncode="+encodeURIComponent(h);$("<img class='weixin_img'/>").appendTo(".jd_share_success"),$(".weixin_img").attr("src",v),$(".weixin_img").css({width:"131",height:"131"})}function h(t,a,c){var g=a.find("li"),h=a.children("dl"),v=[],w=[];if(g.length&&!(g.length<1)){if(g.each(function(){var a=$(this).attr(c);void 0!=a&&v.push(a)}),h.each(function(){var a=$(this).attr(c);w.push(a)}),""==v)var _=w.join(",");else var _=v.join(",");var j=_,k={t:t,dl:y,jids:j,z:C};b(k)}}function v(a){for(var c=[],g={},i=0;i<a.length;i++){var h=a[i],v=typeof h+h;1!==g[v]&&(c.push(h),g[v]=1)}return c}require("common/widgets/mycenter-recommend/main"),require("common/widgets/plat/poster"),require("common/widgets/send-resume/main");require("dep/artTemplate/dist/template");$(document).ajaxStart(function(){$(".collectionCancel").off("click")}),$("#collectionsForm").on("click","li .collectionCancel",function(e){if(e.preventDefault(),e.target==this){var c=$(this);a(c)}});var w=$("#similar_current").find(".guess_like_list_item").find("a");w.hover(function(){var a=$(this);a.next(".company_info").removeClass("dn")},function(){var a=$(this);a.next(".company_info").addClass("dn")}),$("body").on("click","#colorbox #cboxClose",function(){("deliverResumesSuccess"==$(this).siblings("#cboxLoadedContent").children("div").attr("id")||"uploadFileSuccess"==$(this).siblings("#cboxLoadedContent").children("div").attr("id")||"uploadFileSuccessOneKey"==$(this).siblings("#cboxLoadedContent").children("div").attr("id")||"deliverResumesSuccessOneKey"==$(this).siblings("#cboxLoadedContent").children("div").attr("id"))&&top.location.reload()}),g(),global.showQRCode&&c(),$(".Pagination").pager({currPage:global.currPage,pageNOName:"pageNo",form:"collectionsForm",pageCount:global.pageCount,pageSize:5});var b=require("common/widgets/plat/exposure").postoA,y=encodeURIComponent(document.URL),C=Math.random(),_=$(".my_collections"),j="data-id",t="collection";h(t,_,j);for(var k=[],T=$(".my_collections li"),i=0;i<T.length;i++)k.push(T.eq(i).data("company"));k=v(k);var R=k.join(","),S=require("common/widgets/plat/addIcon").loadIconInfo;S({companyIds:R,markLocation:"PPF"},R)});